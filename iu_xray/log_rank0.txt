[2023-09-26 01:29:07 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 32, 'dataset_name': 'iu_xray', 'label_path': '', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'logs_folder': 'tensorboard_logs', 'data_dir': 'data', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'resnet101', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'mse_w': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 01:29:07 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 01:29:49 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'data', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 32, 'dataset_name': 'iu_xray', 'label_path': '', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'resnet101', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'mse_w': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 01:29:49 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 01:31:39 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'data', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 32, 'dataset_name': 'iu_xray', 'label_path': '', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'resnet101', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'mse_w': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 01:31:39 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 01:32:13 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'data', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 32, 'dataset_name': 'iu_xray', 'label_path': '', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'resnet101', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'mse_w': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 01:32:13 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 01:32:42 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 32, 'dataset_name': 'iu_xray', 'label_path': '', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'resnet101', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'mse_w': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 01:32:42 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 01:48:03 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 32, 'dataset_name': 'iu_xray', 'label_path': '', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'resnet101', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'mse_w': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 01:48:03 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 01:49:46 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 32, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'resnet101', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'mse_w': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 01:49:46 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 02:01:09 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 32, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'mse_w': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 02:01:09 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 12:40:01 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 32, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'mse_w': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 12:40:01 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 12:43:33 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'mse_w': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 12:43:33 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 12:43:59 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'mse_w': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 12:43:59 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 12:44:25 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'mse_w': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 12:44:25 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 12:46:18 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 12:46:18 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 12:47:38 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 12:47:38 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 12:48:35 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 12:48:35 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 12:49:17 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 12:49:17 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 12:50:22 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 12:50:22 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 12:50:42 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 12:50:42 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 12:54:23 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 12:54:23 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 12:54:45 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 12:54:45 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 12:55:30 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 12:55:30 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 12:56:18 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 12:56:18 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 12:56:19 iu_test] (main.py 102): INFO number of params: 53799225
[2023-09-26 13:00:15 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 13:00:15 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 13:00:16 iu_test] (main.py 102): INFO number of params: 53799225
[2023-09-26 13:01:24 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 13:01:24 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 13:01:25 iu_test] (main.py 102): INFO number of params: 53799225
[2023-09-26 13:05:40 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 13:05:40 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 13:05:41 iu_test] (main.py 104): INFO number of params: 53799225
[2023-09-26 13:08:03 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 13:08:03 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 13:08:04 iu_test] (main.py 104): INFO number of params: 53799225
[2023-09-26 13:09:07 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 13:09:07 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 13:09:08 iu_test] (main.py 104): INFO number of params: 53799225
[2023-09-26 13:09:31 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 13:09:31 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 13:09:32 iu_test] (main.py 104): INFO number of params: 53799225
[2023-09-26 13:09:50 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 13:09:50 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 13:09:50 iu_test] (main.py 104): INFO number of params: 53799225
[2023-09-26 13:10:39 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 13:10:39 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 13:10:40 iu_test] (main.py 104): INFO number of params: 53799225
[2023-09-26 13:11:12 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU-4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 13:11:12 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 13:11:12 iu_test] (main.py 104): INFO number of params: 53799225
[2023-09-26 13:12:40 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU-4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 13:12:40 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 13:12:41 iu_test] (main.py 104): INFO number of params: 53799225
[2023-09-26 13:12:57 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU-4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 13:12:57 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 13:12:58 iu_test] (main.py 104): INFO number of params: 53799225
[2023-09-26 13:13:20 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU-4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 13:13:20 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 13:13:21 iu_test] (main.py 104): INFO number of params: 53799225
[2023-09-26 13:13:39 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU-4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 13:13:39 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 13:13:40 iu_test] (main.py 104): INFO number of params: 53799225
[2023-09-26 13:14:54 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU-4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 13:14:54 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 13:14:54 iu_test] (main.py 104): INFO number of params: 53799225
[2023-09-26 13:15:27 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU-4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 13:15:27 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 13:15:28 iu_test] (main.py 104): INFO number of params: 53799225
[2023-09-26 13:16:14 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU-4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 13:16:14 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 13:16:15 iu_test] (main.py 104): INFO number of params: 53799225
[2023-09-26 13:17:38 iu_test] (trainer.py 139): INFO 	epoch          : 1
[2023-09-26 13:17:38 iu_test] (trainer.py 139): INFO 	val_BLEU_1     : 0.3278609812259674
[2023-09-26 13:17:38 iu_test] (trainer.py 139): INFO 	val_BLEU_2     : 0.2207871675491333
[2023-09-26 13:17:38 iu_test] (trainer.py 139): INFO 	val_BLEU_3     : 0.15150371193885803
[2023-09-26 13:17:38 iu_test] (trainer.py 139): INFO 	val_BLEU_4     : 0.10345226526260376
[2023-09-26 13:17:38 iu_test] (trainer.py 139): INFO 	val_METEOR     : 0.139390230178833
[2023-09-26 13:17:38 iu_test] (trainer.py 139): INFO 	val_ROUGE_L    : 0.2899516522884369
[2023-09-26 13:17:38 iu_test] (trainer.py 139): INFO 	val_Cider      : 0.20435777306556702
[2023-09-26 13:17:38 iu_test] (trainer.py 139): INFO 	val_ce_loss    : 2.5319900512695312
[2023-09-26 13:17:38 iu_test] (trainer.py 139): INFO 	test_BLEU_1    : 0.35418257117271423
[2023-09-26 13:17:38 iu_test] (trainer.py 139): INFO 	test_BLEU_2    : 0.2338332235813141
[2023-09-26 13:17:38 iu_test] (trainer.py 139): INFO 	test_BLEU_3    : 0.15990786254405975
[2023-09-26 13:17:38 iu_test] (trainer.py 139): INFO 	test_BLEU_4    : 0.10894737392663956
[2023-09-26 13:17:38 iu_test] (trainer.py 139): INFO 	test_METEOR    : 0.1458413302898407
[2023-09-26 13:17:38 iu_test] (trainer.py 139): INFO 	test_ROUGE_L   : 0.29456406831741333
[2023-09-26 13:17:38 iu_test] (trainer.py 139): INFO 	test_Cider     : 0.22898602485656738
[2023-09-26 13:17:38 iu_test] (trainer.py 167): INFO current best model in: 1
[2023-09-26 13:17:39 iu_test] (trainer.py 173): INFO EPOCH 1 training takes 0:01:23
[2023-09-26 13:18:25 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU-4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 13:18:25 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 13:18:26 iu_test] (main.py 104): INFO number of params: 53799225
[2023-09-26 13:19:42 iu_test] (trainer.py 139): INFO 	epoch          : 1
[2023-09-26 13:19:42 iu_test] (trainer.py 139): INFO 	val_BLEU_1     : 0.3278609812259674
[2023-09-26 13:19:42 iu_test] (trainer.py 139): INFO 	val_BLEU_2     : 0.2207871675491333
[2023-09-26 13:19:42 iu_test] (trainer.py 139): INFO 	val_BLEU_3     : 0.15150371193885803
[2023-09-26 13:19:42 iu_test] (trainer.py 139): INFO 	val_BLEU_4     : 0.10345226526260376
[2023-09-26 13:19:42 iu_test] (trainer.py 139): INFO 	val_METEOR     : 0.139390230178833
[2023-09-26 13:19:42 iu_test] (trainer.py 139): INFO 	val_ROUGE_L    : 0.2899516522884369
[2023-09-26 13:19:42 iu_test] (trainer.py 139): INFO 	val_Cider      : 0.20435777306556702
[2023-09-26 13:19:42 iu_test] (trainer.py 139): INFO 	val_ce_loss    : 2.5319900512695312
[2023-09-26 13:19:42 iu_test] (trainer.py 139): INFO 	test_BLEU_1    : 0.35418257117271423
[2023-09-26 13:19:42 iu_test] (trainer.py 139): INFO 	test_BLEU_2    : 0.2338332235813141
[2023-09-26 13:19:42 iu_test] (trainer.py 139): INFO 	test_BLEU_3    : 0.15990786254405975
[2023-09-26 13:19:42 iu_test] (trainer.py 139): INFO 	test_BLEU_4    : 0.10894737392663956
[2023-09-26 13:19:42 iu_test] (trainer.py 139): INFO 	test_METEOR    : 0.1458413302898407
[2023-09-26 13:19:42 iu_test] (trainer.py 139): INFO 	test_ROUGE_L   : 0.29456406831741333
[2023-09-26 13:19:42 iu_test] (trainer.py 139): INFO 	test_Cider     : 0.22898602485656738
[2023-09-26 13:19:42 iu_test] (trainer.py 167): INFO current best model in: 1
[2023-09-26 13:19:45 iu_test] (trainer.py 173): INFO EPOCH 1 training takes 0:01:18
[2023-09-26 13:20:59 iu_test] (trainer.py 139): INFO 	epoch          : 2
[2023-09-26 13:20:59 iu_test] (trainer.py 139): INFO 	val_BLEU_1     : 0.2867506444454193
[2023-09-26 13:20:59 iu_test] (trainer.py 139): INFO 	val_BLEU_2     : 0.19865943491458893
[2023-09-26 13:20:59 iu_test] (trainer.py 139): INFO 	val_BLEU_3     : 0.141768217086792
[2023-09-26 13:20:59 iu_test] (trainer.py 139): INFO 	val_BLEU_4     : 0.102495476603508
[2023-09-26 13:20:59 iu_test] (trainer.py 139): INFO 	val_METEOR     : 0.13122059404850006
[2023-09-26 13:20:59 iu_test] (trainer.py 139): INFO 	val_ROUGE_L    : 0.2650350034236908
[2023-09-26 13:20:59 iu_test] (trainer.py 139): INFO 	val_Cider      : 0.15933457016944885
[2023-09-26 13:20:59 iu_test] (trainer.py 139): INFO 	val_ce_loss    : 2.3462889194488525
[2023-09-26 13:20:59 iu_test] (trainer.py 139): INFO 	test_BLEU_1    : 0.310310035943985
[2023-09-26 13:20:59 iu_test] (trainer.py 139): INFO 	test_BLEU_2    : 0.21578975021839142
[2023-09-26 13:20:59 iu_test] (trainer.py 139): INFO 	test_BLEU_3    : 0.155801922082901
[2023-09-26 13:20:59 iu_test] (trainer.py 139): INFO 	test_BLEU_4    : 0.11403228342533112
[2023-09-26 13:20:59 iu_test] (trainer.py 139): INFO 	test_METEOR    : 0.14236734807491302
[2023-09-26 13:20:59 iu_test] (trainer.py 139): INFO 	test_ROUGE_L   : 0.2735450863838196
[2023-09-26 13:20:59 iu_test] (trainer.py 139): INFO 	test_Cider     : 0.18490350246429443
[2023-09-26 13:23:53 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU-4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 13:23:53 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 13:24:45 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU-4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 13:24:45 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 13:25:10 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU-4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 13:25:10 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 13:25:10 iu_test] (main.py 104): INFO number of params: 56954169
[2023-09-26 13:26:39 iu_test] (trainer.py 140): INFO 	epoch          : 1
[2023-09-26 13:26:39 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.3652917742729187
[2023-09-26 13:26:39 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2314574420452118
[2023-09-26 13:26:39 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.1614489108324051
[2023-09-26 13:26:39 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.12159974873065948
[2023-09-26 13:26:39 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.15699075162410736
[2023-09-26 13:26:39 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3605773150920868
[2023-09-26 13:26:39 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3848572373390198
[2023-09-26 13:26:39 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.229506731033325
[2023-09-26 13:26:39 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4145543873310089
[2023-09-26 13:26:39 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2672971785068512
[2023-09-26 13:26:39 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.18989935517311096
[2023-09-26 13:26:39 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.14305034279823303
[2023-09-26 13:26:39 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.17576231062412262
[2023-09-26 13:26:39 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3779493570327759
[2023-09-26 13:26:39 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.43138861656188965
[2023-09-26 13:26:39 iu_test] (trainer.py 168): INFO current best model in: 1
[2023-09-26 13:26:41 iu_test] (trainer.py 174): INFO EPOCH 1 training takes 0:01:30
[2023-09-26 13:28:07 iu_test] (trainer.py 140): INFO 	epoch          : 2
[2023-09-26 13:28:07 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.25766560435295105
[2023-09-26 13:28:07 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.1547277271747589
[2023-09-26 13:28:07 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.10037155449390411
[2023-09-26 13:28:07 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.07207874953746796
[2023-09-26 13:28:07 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.13083286583423615
[2023-09-26 13:28:07 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.2938172221183777
[2023-09-26 13:28:07 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.14966003596782684
[2023-09-26 13:28:07 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.8424137830734253
[2023-09-26 13:28:07 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.28939908742904663
[2023-09-26 13:28:07 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.1734844446182251
[2023-09-26 13:28:07 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.11330908536911011
[2023-09-26 13:28:07 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.08112026751041412
[2023-09-26 13:28:07 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.142132967710495
[2023-09-26 13:28:07 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.30886611342430115
[2023-09-26 13:28:07 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.25883719325065613
[2023-09-26 13:28:07 iu_test] (trainer.py 165): INFO Validation performance didn't improve for 50 epochs. Training stops.
[2023-09-26 13:29:32 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU-4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 13:29:32 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 13:29:32 iu_test] (main.py 104): INFO number of params: 56954169
[2023-09-26 13:30:58 iu_test] (trainer.py 140): INFO 	epoch          : 1
[2023-09-26 13:30:58 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.3652917742729187
[2023-09-26 13:30:58 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2314574420452118
[2023-09-26 13:30:58 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.1614489108324051
[2023-09-26 13:30:58 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.12159974873065948
[2023-09-26 13:30:58 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.15699075162410736
[2023-09-26 13:30:58 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3605773150920868
[2023-09-26 13:30:58 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3848572373390198
[2023-09-26 13:30:58 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.229506731033325
[2023-09-26 13:30:58 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4145543873310089
[2023-09-26 13:30:58 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2672971785068512
[2023-09-26 13:30:58 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.18989935517311096
[2023-09-26 13:30:58 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.14305034279823303
[2023-09-26 13:30:58 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.17576231062412262
[2023-09-26 13:30:58 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3779493570327759
[2023-09-26 13:30:58 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.43138861656188965
[2023-09-26 13:30:58 iu_test] (trainer.py 168): INFO current best model in: 1
[2023-09-26 13:31:01 iu_test] (trainer.py 174): INFO EPOCH 1 training takes 0:01:28
[2023-09-26 13:32:27 iu_test] (trainer.py 140): INFO 	epoch          : 2
[2023-09-26 13:32:27 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.25766560435295105
[2023-09-26 13:32:27 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.1547277271747589
[2023-09-26 13:32:27 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.10037155449390411
[2023-09-26 13:32:27 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.07207874953746796
[2023-09-26 13:32:27 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.13083286583423615
[2023-09-26 13:32:27 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.2938172221183777
[2023-09-26 13:32:27 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.14966003596782684
[2023-09-26 13:32:27 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.8424137830734253
[2023-09-26 13:32:27 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.28939908742904663
[2023-09-26 13:32:27 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.1734844446182251
[2023-09-26 13:32:27 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.11330908536911011
[2023-09-26 13:32:27 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.08112026751041412
[2023-09-26 13:32:27 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.142132967710495
[2023-09-26 13:32:27 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.30886611342430115
[2023-09-26 13:32:27 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.25883719325065613
[2023-09-26 13:32:27 iu_test] (trainer.py 165): INFO Validation performance didn't improve for 50 epochs. Training stops.
[2023-09-26 13:52:33 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU-4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 13:52:33 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 13:52:33 iu_test] (main.py 104): INFO number of params: 56954169
[2023-09-26 13:54:01 iu_test] (trainer.py 140): INFO 	epoch          : 1
[2023-09-26 13:54:01 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.3652917742729187
[2023-09-26 13:54:01 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2314574420452118
[2023-09-26 13:54:01 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.1614489108324051
[2023-09-26 13:54:01 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.12159974873065948
[2023-09-26 13:54:01 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.15699075162410736
[2023-09-26 13:54:01 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3605773150920868
[2023-09-26 13:54:01 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3848572373390198
[2023-09-26 13:54:01 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.229506731033325
[2023-09-26 13:54:01 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4145543873310089
[2023-09-26 13:54:01 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2672971785068512
[2023-09-26 13:54:01 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.18989935517311096
[2023-09-26 13:54:01 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.14305034279823303
[2023-09-26 13:54:01 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.17576231062412262
[2023-09-26 13:54:01 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3779493570327759
[2023-09-26 13:54:01 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.43138861656188965
[2023-09-26 13:54:01 iu_test] (trainer.py 168): INFO current best model in: 1
[2023-09-26 13:54:03 iu_test] (trainer.py 174): INFO EPOCH 1 training takes 0:01:29
[2023-09-26 13:55:28 iu_test] (trainer.py 140): INFO 	epoch          : 2
[2023-09-26 13:55:28 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.25766560435295105
[2023-09-26 13:55:28 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.1547277271747589
[2023-09-26 13:55:28 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.10037155449390411
[2023-09-26 13:55:28 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.07207874953746796
[2023-09-26 13:55:28 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.13083286583423615
[2023-09-26 13:55:28 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.2938172221183777
[2023-09-26 13:55:28 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.14966003596782684
[2023-09-26 13:55:28 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.8424137830734253
[2023-09-26 13:55:28 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.28939908742904663
[2023-09-26 13:55:28 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.1734844446182251
[2023-09-26 13:55:28 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.11330908536911011
[2023-09-26 13:55:28 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.08112026751041412
[2023-09-26 13:55:28 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.142132967710495
[2023-09-26 13:55:28 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.30886611342430115
[2023-09-26 13:55:28 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.25883719325065613
[2023-09-26 13:55:28 iu_test] (trainer.py 165): INFO Validation performance didn't improve for 50 epochs. Training stops.
[2023-09-26 15:37:24 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU-4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 15:37:24 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 15:37:24 iu_test] (main.py 104): INFO number of params: 56954169
[2023-09-26 15:38:50 iu_test] (trainer.py 140): INFO 	epoch          : 1
[2023-09-26 15:38:50 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.3652917742729187
[2023-09-26 15:38:50 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2314574420452118
[2023-09-26 15:38:50 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.1614489108324051
[2023-09-26 15:38:50 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.12159974873065948
[2023-09-26 15:38:50 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.15699075162410736
[2023-09-26 15:38:50 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3605773150920868
[2023-09-26 15:38:50 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3848572373390198
[2023-09-26 15:38:50 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.229506731033325
[2023-09-26 15:38:50 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4145543873310089
[2023-09-26 15:38:50 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2672971785068512
[2023-09-26 15:38:50 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.18989935517311096
[2023-09-26 15:38:50 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.14305034279823303
[2023-09-26 15:38:50 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.17576231062412262
[2023-09-26 15:38:50 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3779493570327759
[2023-09-26 15:38:50 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.43138861656188965
[2023-09-26 15:38:50 iu_test] (trainer.py 168): INFO current best model in: 1
[2023-09-26 15:38:53 iu_test] (trainer.py 174): INFO EPOCH 1 training takes 0:01:28
[2023-09-26 15:40:18 iu_test] (trainer.py 140): INFO 	epoch          : 2
[2023-09-26 15:40:18 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.25766560435295105
[2023-09-26 15:40:18 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.1547277271747589
[2023-09-26 15:40:18 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.10037155449390411
[2023-09-26 15:40:18 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.07207874953746796
[2023-09-26 15:40:18 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.13083286583423615
[2023-09-26 15:40:18 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.2938172221183777
[2023-09-26 15:40:18 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.14966003596782684
[2023-09-26 15:40:18 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.8424137830734253
[2023-09-26 15:40:18 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.28939908742904663
[2023-09-26 15:40:18 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.1734844446182251
[2023-09-26 15:40:18 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.11330908536911011
[2023-09-26 15:40:18 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.08112026751041412
[2023-09-26 15:40:18 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.142132967710495
[2023-09-26 15:40:18 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.30886611342430115
[2023-09-26 15:40:18 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.25883719325065613
[2023-09-26 15:40:18 iu_test] (trainer.py 165): INFO Validation performance didn't improve for 50 epochs. Training stops.
[2023-09-26 15:47:35 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 15:47:35 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 15:47:36 iu_test] (main.py 104): INFO number of params: 56954169
[2023-09-26 15:49:04 iu_test] (trainer.py 140): INFO 	epoch          : 1
[2023-09-26 15:49:04 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.3652917742729187
[2023-09-26 15:49:04 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2314574420452118
[2023-09-26 15:49:04 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.1614489108324051
[2023-09-26 15:49:04 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.12159974873065948
[2023-09-26 15:49:04 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.15699075162410736
[2023-09-26 15:49:04 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3605773150920868
[2023-09-26 15:49:04 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3848572373390198
[2023-09-26 15:49:04 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.229506731033325
[2023-09-26 15:49:04 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4145543873310089
[2023-09-26 15:49:04 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2672971785068512
[2023-09-26 15:49:04 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.18989935517311096
[2023-09-26 15:49:04 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.14305034279823303
[2023-09-26 15:49:04 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.17576231062412262
[2023-09-26 15:49:04 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3779493570327759
[2023-09-26 15:49:04 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.43138861656188965
[2023-09-26 15:49:04 iu_test] (trainer.py 168): INFO current best model in: 1
[2023-09-26 15:49:06 iu_test] (trainer.py 174): INFO EPOCH 1 training takes 0:01:29
[2023-09-26 15:50:34 iu_test] (trainer.py 140): INFO 	epoch          : 2
[2023-09-26 15:50:34 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.25766560435295105
[2023-09-26 15:50:34 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.1547277271747589
[2023-09-26 15:50:34 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.10037155449390411
[2023-09-26 15:50:34 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.07207874953746796
[2023-09-26 15:50:34 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.13083286583423615
[2023-09-26 15:50:34 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.2938172221183777
[2023-09-26 15:50:34 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.14966003596782684
[2023-09-26 15:50:34 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.8424137830734253
[2023-09-26 15:50:34 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.28939908742904663
[2023-09-26 15:50:34 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.1734844446182251
[2023-09-26 15:50:34 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.11330908536911011
[2023-09-26 15:50:34 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.08112026751041412
[2023-09-26 15:50:34 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.142132967710495
[2023-09-26 15:50:34 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.30886611342430115
[2023-09-26 15:50:34 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.25883719325065613
[2023-09-26 15:50:34 iu_test] (trainer.py 165): INFO Validation performance didn't improve for 50 epochs. Training stops.
[2023-09-26 16:01:18 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 16:01:18 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 16:01:19 iu_test] (main.py 104): INFO number of params: 56954169
[2023-09-26 16:02:45 iu_test] (trainer.py 140): INFO 	epoch          : 1
[2023-09-26 16:02:45 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.3652917742729187
[2023-09-26 16:02:45 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2314574420452118
[2023-09-26 16:02:45 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.1614489108324051
[2023-09-26 16:02:45 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.12159974873065948
[2023-09-26 16:02:45 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.15699075162410736
[2023-09-26 16:02:45 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3605773150920868
[2023-09-26 16:02:45 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3848572373390198
[2023-09-26 16:02:45 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.229506731033325
[2023-09-26 16:02:45 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4145543873310089
[2023-09-26 16:02:45 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2672971785068512
[2023-09-26 16:02:45 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.18989935517311096
[2023-09-26 16:02:45 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.14305034279823303
[2023-09-26 16:02:45 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.17576231062412262
[2023-09-26 16:02:45 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3779493570327759
[2023-09-26 16:02:45 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.43138861656188965
[2023-09-26 16:02:45 iu_test] (trainer.py 168): INFO current best model in: 1
[2023-09-26 16:02:47 iu_test] (trainer.py 174): INFO EPOCH 1 training takes 0:01:28
[2023-09-26 16:04:13 iu_test] (trainer.py 140): INFO 	epoch          : 2
[2023-09-26 16:04:13 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.25766560435295105
[2023-09-26 16:04:13 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.1547277271747589
[2023-09-26 16:04:13 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.10037155449390411
[2023-09-26 16:04:13 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.07207874953746796
[2023-09-26 16:04:13 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.13083286583423615
[2023-09-26 16:04:13 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.2938172221183777
[2023-09-26 16:04:13 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.14966003596782684
[2023-09-26 16:04:13 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.8424137830734253
[2023-09-26 16:04:13 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.28939908742904663
[2023-09-26 16:04:13 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.1734844446182251
[2023-09-26 16:04:13 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.11330908536911011
[2023-09-26 16:04:13 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.08112026751041412
[2023-09-26 16:04:13 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.142132967710495
[2023-09-26 16:04:13 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.30886611342430115
[2023-09-26 16:04:13 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.25883719325065613
[2023-09-26 16:04:13 iu_test] (trainer.py 168): INFO current best model in: 1
[2023-09-26 16:04:14 iu_test] (trainer.py 174): INFO EPOCH 2 training takes 0:01:26
[2023-09-26 16:05:38 iu_test] (trainer.py 140): INFO 	epoch          : 3
[2023-09-26 16:05:38 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.2737051546573639
[2023-09-26 16:05:38 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.16420018672943115
[2023-09-26 16:05:38 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.10324333608150482
[2023-09-26 16:05:38 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.07269097864627838
[2023-09-26 16:05:38 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.13928775489330292
[2023-09-26 16:05:38 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.29999256134033203
[2023-09-26 16:05:38 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.11715175956487656
[2023-09-26 16:05:38 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.8275068998336792
[2023-09-26 16:05:38 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.30307334661483765
[2023-09-26 16:05:38 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.18111303448677063
[2023-09-26 16:05:38 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.11329979449510574
[2023-09-26 16:05:38 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.07833016663789749
[2023-09-26 16:05:38 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.15047188103199005
[2023-09-26 16:05:38 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.30716487765312195
[2023-09-26 16:05:38 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.18757766485214233
[2023-09-26 16:05:38 iu_test] (trainer.py 168): INFO current best model in: 1
[2023-09-26 16:05:39 iu_test] (trainer.py 174): INFO EPOCH 3 training takes 0:01:25
[2023-09-26 16:07:04 iu_test] (trainer.py 140): INFO 	epoch          : 4
[2023-09-26 16:07:04 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.39719095826148987
[2023-09-26 16:07:04 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2127290964126587
[2023-09-26 16:07:04 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.13003404438495636
[2023-09-26 16:07:04 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.08532863110303879
[2023-09-26 16:07:04 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.14963315427303314
[2023-09-26 16:07:04 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.299957275390625
[2023-09-26 16:07:04 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.2685759663581848
[2023-09-26 16:07:04 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.892806053161621
[2023-09-26 16:07:04 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.44226476550102234
[2023-09-26 16:07:04 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.26329711079597473
[2023-09-26 16:07:04 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.18274430930614471
[2023-09-26 16:07:04 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.13687433302402496
[2023-09-26 16:07:04 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.17495520412921906
[2023-09-26 16:07:04 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.33387938141822815
[2023-09-26 16:07:04 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.5128667950630188
[2023-09-26 16:07:04 iu_test] (trainer.py 168): INFO current best model in: 1
[2023-09-26 16:07:05 iu_test] (trainer.py 174): INFO EPOCH 4 training takes 0:01:25
[2023-09-26 16:08:31 iu_test] (trainer.py 140): INFO 	epoch          : 5
[2023-09-26 16:08:31 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.08953672647476196
[2023-09-26 16:08:31 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.05766071751713753
[2023-09-26 16:08:31 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.037552230060100555
[2023-09-26 16:08:31 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.026231251657009125
[2023-09-26 16:08:31 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.10970751941204071
[2023-09-26 16:08:31 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.2917737662792206
[2023-09-26 16:08:31 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.08454379439353943
[2023-09-26 16:08:31 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.0556318759918213
[2023-09-26 16:08:31 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.11407505720853806
[2023-09-26 16:08:31 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.07336217910051346
[2023-09-26 16:08:31 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.04837791621685028
[2023-09-26 16:08:31 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.034301429986953735
[2023-09-26 16:08:31 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.11868909746408463
[2023-09-26 16:08:31 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.30279341340065
[2023-09-26 16:08:31 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.11721359193325043
[2023-09-26 16:08:31 iu_test] (trainer.py 168): INFO current best model in: 1
[2023-09-26 16:08:32 iu_test] (trainer.py 174): INFO EPOCH 5 training takes 0:01:26
[2023-09-26 16:09:58 iu_test] (trainer.py 140): INFO 	epoch          : 6
[2023-09-26 16:09:58 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.3822014331817627
[2023-09-26 16:09:58 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2371903657913208
[2023-09-26 16:09:58 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.1579170823097229
[2023-09-26 16:09:58 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.11186700314283371
[2023-09-26 16:09:58 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.17386232316493988
[2023-09-26 16:09:58 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.33645355701446533
[2023-09-26 16:09:58 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.2639176845550537
[2023-09-26 16:09:58 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.031662940979004
[2023-09-26 16:09:58 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4245772659778595
[2023-09-26 16:09:58 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2646695375442505
[2023-09-26 16:09:58 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.17817865312099457
[2023-09-26 16:09:58 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.1280546486377716
[2023-09-26 16:09:58 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.18860740959644318
[2023-09-26 16:09:58 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3540332019329071
[2023-09-26 16:09:58 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.37710005044937134
[2023-09-26 16:09:58 iu_test] (trainer.py 168): INFO current best model in: 1
[2023-09-26 16:09:59 iu_test] (trainer.py 174): INFO EPOCH 6 training takes 0:01:26
[2023-09-26 16:11:25 iu_test] (trainer.py 140): INFO 	epoch          : 7
[2023-09-26 16:11:25 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.4606974124908447
[2023-09-26 16:11:25 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.29572558403015137
[2023-09-26 16:11:25 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.20133322477340698
[2023-09-26 16:11:25 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.14416491985321045
[2023-09-26 16:11:25 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.189470112323761
[2023-09-26 16:11:25 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.35602909326553345
[2023-09-26 16:11:25 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3209154009819031
[2023-09-26 16:11:25 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.021099805831909
[2023-09-26 16:11:25 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4978034496307373
[2023-09-26 16:11:25 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.3203229010105133
[2023-09-26 16:11:25 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.22158323228359222
[2023-09-26 16:11:25 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.1626170426607132
[2023-09-26 16:11:25 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.20604465901851654
[2023-09-26 16:11:25 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.37250852584838867
[2023-09-26 16:11:25 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.42571893334388733
[2023-09-26 16:11:25 iu_test] (trainer.py 168): INFO current best model in: 7
[2023-09-26 16:11:27 iu_test] (trainer.py 174): INFO EPOCH 7 training takes 0:01:28
[2023-09-26 16:12:53 iu_test] (trainer.py 140): INFO 	epoch          : 8
[2023-09-26 16:12:53 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.39702969789505005
[2023-09-26 16:12:53 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.24046672880649567
[2023-09-26 16:12:53 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.1575053632259369
[2023-09-26 16:12:53 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.10991067439317703
[2023-09-26 16:12:53 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.170911967754364
[2023-09-26 16:12:53 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3296579420566559
[2023-09-26 16:12:53 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.29299089312553406
[2023-09-26 16:12:53 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.9595227241516113
[2023-09-26 16:12:53 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.43438658118247986
[2023-09-26 16:12:53 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2646391689777374
[2023-09-26 16:12:53 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.1744345873594284
[2023-09-26 16:12:53 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.12285510450601578
[2023-09-26 16:12:53 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.18411099910736084
[2023-09-26 16:12:53 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3443346321582794
[2023-09-26 16:12:53 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.3473462164402008
[2023-09-26 16:12:53 iu_test] (trainer.py 168): INFO current best model in: 7
[2023-09-26 16:12:54 iu_test] (trainer.py 174): INFO EPOCH 8 training takes 0:01:27
[2023-09-26 16:14:20 iu_test] (trainer.py 140): INFO 	epoch          : 9
[2023-09-26 16:14:20 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.34636881947517395
[2023-09-26 16:14:20 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.22775495052337646
[2023-09-26 16:14:20 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.15654867887496948
[2023-09-26 16:14:20 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.11294415593147278
[2023-09-26 16:14:20 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.16781431436538696
[2023-09-26 16:14:20 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3385104238986969
[2023-09-26 16:14:20 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.2795391380786896
[2023-09-26 16:14:20 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.9734281301498413
[2023-09-26 16:14:20 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.3893284201622009
[2023-09-26 16:14:20 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.25259923934936523
[2023-09-26 16:14:20 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.17447765171527863
[2023-09-26 16:14:20 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.12775221467018127
[2023-09-26 16:14:20 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.18259209394454956
[2023-09-26 16:14:20 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.35277020931243896
[2023-09-26 16:14:20 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.3723601698875427
[2023-09-26 16:14:20 iu_test] (trainer.py 168): INFO current best model in: 7
[2023-09-26 16:14:21 iu_test] (trainer.py 174): INFO EPOCH 9 training takes 0:01:26
[2023-09-26 16:15:46 iu_test] (trainer.py 140): INFO 	epoch          : 10
[2023-09-26 16:15:46 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.19916962087154388
[2023-09-26 16:15:46 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.1183643564581871
[2023-09-26 16:15:46 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.08370459079742432
[2023-09-26 16:15:46 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.06409242749214172
[2023-09-26 16:15:46 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.10363446921110153
[2023-09-26 16:15:46 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.2951515316963196
[2023-09-26 16:15:46 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.33345460891723633
[2023-09-26 16:15:46 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.9434380531311035
[2023-09-26 16:15:46 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.24130094051361084
[2023-09-26 16:15:46 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.1463904231786728
[2023-09-26 16:15:46 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.10511388629674911
[2023-09-26 16:15:46 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.0805356353521347
[2023-09-26 16:15:46 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.1194005236029625
[2023-09-26 16:15:46 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.31190016865730286
[2023-09-26 16:15:46 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.34347590804100037
[2023-09-26 16:15:46 iu_test] (trainer.py 168): INFO current best model in: 7
[2023-09-26 16:15:47 iu_test] (trainer.py 174): INFO EPOCH 10 training takes 0:01:25
[2023-09-26 16:17:11 iu_test] (trainer.py 140): INFO 	epoch          : 11
[2023-09-26 16:17:11 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.3379570245742798
[2023-09-26 16:17:11 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2083444446325302
[2023-09-26 16:17:11 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.1392347365617752
[2023-09-26 16:17:11 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.0976717546582222
[2023-09-26 16:17:11 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.14895306527614594
[2023-09-26 16:17:11 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3003298044204712
[2023-09-26 16:17:11 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.1872812807559967
[2023-09-26 16:17:11 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.8727470636367798
[2023-09-26 16:17:11 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.3777974843978882
[2023-09-26 16:17:11 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2365889996290207
[2023-09-26 16:17:11 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.1627441793680191
[2023-09-26 16:17:11 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.11897263675928116
[2023-09-26 16:17:11 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16245390474796295
[2023-09-26 16:17:11 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3115623891353607
[2023-09-26 16:17:11 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.29159417748451233
[2023-09-26 16:17:11 iu_test] (trainer.py 168): INFO current best model in: 7
[2023-09-26 16:17:12 iu_test] (trainer.py 174): INFO EPOCH 11 training takes 0:01:25
[2023-09-26 16:24:50 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 5e-05, 'lr_ed': 0.0001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 16:24:50 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 16:24:51 iu_test] (main.py 104): INFO number of params: 56954169
[2023-09-26 16:25:04 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 16:25:04 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 16:25:04 iu_test] (main.py 104): INFO number of params: 56954169
[2023-09-26 16:26:30 iu_test] (trainer.py 140): INFO 	epoch          : 1
[2023-09-26 16:26:30 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.1117500513792038
[2023-09-26 16:26:30 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.0633891373872757
[2023-09-26 16:26:30 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.04417426511645317
[2023-09-26 16:26:30 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.03296046331524849
[2023-09-26 16:26:30 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.05517017841339111
[2023-09-26 16:26:30 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.2565532922744751
[2023-09-26 16:26:30 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.08183019608259201
[2023-09-26 16:26:30 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 3.750555992126465
[2023-09-26 16:26:30 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.14047162234783173
[2023-09-26 16:26:30 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.0814814418554306
[2023-09-26 16:26:30 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.0574202723801136
[2023-09-26 16:26:30 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.04254942387342453
[2023-09-26 16:26:30 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.0643947571516037
[2023-09-26 16:26:30 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.2792569398880005
[2023-09-26 16:26:30 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.08975525200366974
[2023-09-26 16:26:30 iu_test] (trainer.py 168): INFO current best model in: 1
[2023-09-26 16:26:32 iu_test] (trainer.py 174): INFO EPOCH 1 training takes 0:01:28
[2023-09-26 16:27:57 iu_test] (trainer.py 140): INFO 	epoch          : 2
[2023-09-26 16:27:57 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.32543206214904785
[2023-09-26 16:27:57 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.21341681480407715
[2023-09-26 16:27:57 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.1513892114162445
[2023-09-26 16:27:57 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.11405528336763382
[2023-09-26 16:27:57 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.14950904250144958
[2023-09-26 16:27:57 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.35689741373062134
[2023-09-26 16:27:57 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.32177090644836426
[2023-09-26 16:27:57 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.5536506175994873
[2023-09-26 16:27:57 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.3773341178894043
[2023-09-26 16:27:57 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.24799713492393494
[2023-09-26 16:27:57 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.1762082874774933
[2023-09-26 16:27:57 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.13262219727039337
[2023-09-26 16:27:57 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.1661050021648407
[2023-09-26 16:27:57 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3715931177139282
[2023-09-26 16:27:57 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.3690197765827179
[2023-09-26 16:27:57 iu_test] (trainer.py 168): INFO current best model in: 2
[2023-09-26 16:27:59 iu_test] (trainer.py 174): INFO EPOCH 2 training takes 0:01:26
[2023-09-26 16:29:23 iu_test] (trainer.py 140): INFO 	epoch          : 3
[2023-09-26 16:29:23 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.34384167194366455
[2023-09-26 16:29:23 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.23994603753089905
[2023-09-26 16:29:23 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.17346860468387604
[2023-09-26 16:29:23 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.1308828890323639
[2023-09-26 16:29:23 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.16827285289764404
[2023-09-26 16:29:23 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.36971965432167053
[2023-09-26 16:29:23 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.2756890058517456
[2023-09-26 16:29:23 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.1119384765625
[2023-09-26 16:29:23 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.3929656445980072
[2023-09-26 16:29:23 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2766995131969452
[2023-09-26 16:29:23 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.20280222594738007
[2023-09-26 16:29:23 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.15486489236354828
[2023-09-26 16:29:23 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.18785005807876587
[2023-09-26 16:29:23 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.39211198687553406
[2023-09-26 16:29:23 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.38621073961257935
[2023-09-26 16:29:23 iu_test] (trainer.py 168): INFO current best model in: 3
[2023-09-26 16:29:25 iu_test] (trainer.py 174): INFO EPOCH 3 training takes 0:01:26
[2023-09-26 16:30:51 iu_test] (trainer.py 140): INFO 	epoch          : 4
[2023-09-26 16:30:51 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.4769466519355774
[2023-09-26 16:30:51 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.3070942759513855
[2023-09-26 16:30:51 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.20815469324588776
[2023-09-26 16:30:51 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.14881886541843414
[2023-09-26 16:30:51 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.19328153133392334
[2023-09-26 16:30:51 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3641507923603058
[2023-09-26 16:30:51 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3219425082206726
[2023-09-26 16:30:51 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.863125205039978
[2023-09-26 16:30:51 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4989164173603058
[2023-09-26 16:30:51 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.322539359331131
[2023-09-26 16:30:51 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.22207339107990265
[2023-09-26 16:30:51 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.16252896189689636
[2023-09-26 16:30:51 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.21090374886989594
[2023-09-26 16:30:51 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.38119348883628845
[2023-09-26 16:30:51 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.40977567434310913
[2023-09-26 16:30:51 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 16:30:53 iu_test] (trainer.py 174): INFO EPOCH 4 training takes 0:01:27
[2023-09-26 16:32:18 iu_test] (trainer.py 140): INFO 	epoch          : 5
[2023-09-26 16:32:18 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.2733844518661499
[2023-09-26 16:32:18 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.14193563163280487
[2023-09-26 16:32:18 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.08301908522844315
[2023-09-26 16:32:18 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.05339279770851135
[2023-09-26 16:32:18 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.11873957514762878
[2023-09-26 16:32:18 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.297804594039917
[2023-09-26 16:32:18 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.2023402601480484
[2023-09-26 16:32:18 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.7173007726669312
[2023-09-26 16:32:18 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.31685468554496765
[2023-09-26 16:32:18 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.17386473715305328
[2023-09-26 16:32:18 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.10947026312351227
[2023-09-26 16:32:18 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.07594650238752365
[2023-09-26 16:32:18 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.13473306596279144
[2023-09-26 16:32:18 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3210718631744385
[2023-09-26 16:32:18 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.35282883048057556
[2023-09-26 16:32:18 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 16:32:19 iu_test] (trainer.py 174): INFO EPOCH 5 training takes 0:01:26
[2023-09-26 16:33:44 iu_test] (trainer.py 140): INFO 	epoch          : 6
[2023-09-26 16:33:44 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.21237145364284515
[2023-09-26 16:33:44 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.13221581280231476
[2023-09-26 16:33:44 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.09414531290531158
[2023-09-26 16:33:44 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.07144026458263397
[2023-09-26 16:33:44 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.11728615313768387
[2023-09-26 16:33:44 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.31272414326667786
[2023-09-26 16:33:44 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3168726861476898
[2023-09-26 16:33:44 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.6336877346038818
[2023-09-26 16:33:44 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.25605374574661255
[2023-09-26 16:33:44 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.16014322638511658
[2023-09-26 16:33:44 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.1134776771068573
[2023-09-26 16:33:44 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.08507604151964188
[2023-09-26 16:33:44 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.13172301650047302
[2023-09-26 16:33:44 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.322723388671875
[2023-09-26 16:33:44 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.24640415608882904
[2023-09-26 16:33:44 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 16:33:45 iu_test] (trainer.py 174): INFO EPOCH 6 training takes 0:01:25
[2023-09-26 16:35:09 iu_test] (trainer.py 140): INFO 	epoch          : 7
[2023-09-26 16:35:09 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-26 16:35:09 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-26 16:35:09 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-26 16:35:09 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-26 16:35:09 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-26 16:35:09 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-26 16:35:09 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.33345460891723633
[2023-09-26 16:35:09 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.5908787250518799
[2023-09-26 16:35:09 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-26 16:35:09 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-26 16:35:09 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-26 16:35:09 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-26 16:35:09 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.11945840716362
[2023-09-26 16:35:09 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-26 16:35:09 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.34414803981781006
[2023-09-26 16:35:09 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 16:35:10 iu_test] (trainer.py 174): INFO EPOCH 7 training takes 0:01:25
[2023-09-26 16:36:36 iu_test] (trainer.py 140): INFO 	epoch          : 8
[2023-09-26 16:36:36 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-26 16:36:36 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-26 16:36:36 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-26 16:36:36 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-26 16:36:36 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-26 16:36:36 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-26 16:36:36 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.33345460891723633
[2023-09-26 16:36:36 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.546852707862854
[2023-09-26 16:36:36 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-26 16:36:36 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-26 16:36:36 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-26 16:36:36 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-26 16:36:36 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.11945840716362
[2023-09-26 16:36:36 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-26 16:36:36 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.34414803981781006
[2023-09-26 16:36:36 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 16:36:37 iu_test] (trainer.py 174): INFO EPOCH 8 training takes 0:01:26
[2023-09-26 16:38:02 iu_test] (trainer.py 140): INFO 	epoch          : 9
[2023-09-26 16:38:02 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.20140621066093445
[2023-09-26 16:38:02 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.11879293620586395
[2023-09-26 16:38:02 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.08352222293615341
[2023-09-26 16:38:02 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.06349898129701614
[2023-09-26 16:38:02 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.10349228233098984
[2023-09-26 16:38:02 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.2940300703048706
[2023-09-26 16:38:02 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3334653079509735
[2023-09-26 16:38:02 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.5307658910751343
[2023-09-26 16:38:02 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.24456869065761566
[2023-09-26 16:38:02 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.1480168253183365
[2023-09-26 16:38:02 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.1062462329864502
[2023-09-26 16:38:02 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.08143340051174164
[2023-09-26 16:38:02 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.12013988196849823
[2023-09-26 16:38:02 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.31182989478111267
[2023-09-26 16:38:02 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.34499266743659973
[2023-09-26 16:38:02 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 16:38:03 iu_test] (trainer.py 174): INFO EPOCH 9 training takes 0:01:26
[2023-09-26 16:39:29 iu_test] (trainer.py 140): INFO 	epoch          : 10
[2023-09-26 16:39:29 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.3605298697948456
[2023-09-26 16:39:29 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.21876119077205658
[2023-09-26 16:39:29 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.15076236426830292
[2023-09-26 16:39:29 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.11172409355640411
[2023-09-26 16:39:29 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.14500130712985992
[2023-09-26 16:39:29 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.31924429535865784
[2023-09-26 16:39:29 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.4070349931716919
[2023-09-26 16:39:29 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.5127283334732056
[2023-09-26 16:39:29 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.39684468507766724
[2023-09-26 16:39:29 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.24966779351234436
[2023-09-26 16:39:29 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.180384561419487
[2023-09-26 16:39:29 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.13916225731372833
[2023-09-26 16:39:29 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16161267459392548
[2023-09-26 16:39:29 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.341631144285202
[2023-09-26 16:39:29 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.49768438935279846
[2023-09-26 16:39:29 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 16:39:30 iu_test] (trainer.py 174): INFO EPOCH 10 training takes 0:01:26
[2023-09-26 16:40:55 iu_test] (trainer.py 140): INFO 	epoch          : 11
[2023-09-26 16:40:55 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.21818415820598602
[2023-09-26 16:40:55 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.12943416833877563
[2023-09-26 16:40:55 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.09058059751987457
[2023-09-26 16:40:55 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.06856940686702728
[2023-09-26 16:40:55 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.10720691084861755
[2023-09-26 16:40:55 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.29453983902931213
[2023-09-26 16:40:55 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3335328698158264
[2023-09-26 16:40:55 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.5212626457214355
[2023-09-26 16:40:55 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.25811851024627686
[2023-09-26 16:40:55 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.15814770758152008
[2023-09-26 16:40:55 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.11361921578645706
[2023-09-26 16:40:55 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.08725664019584656
[2023-09-26 16:40:55 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.1235540360212326
[2023-09-26 16:40:55 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3146172761917114
[2023-09-26 16:40:55 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.37696555256843567
[2023-09-26 16:40:55 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 16:40:57 iu_test] (trainer.py 174): INFO EPOCH 11 training takes 0:01:26
[2023-09-26 16:42:23 iu_test] (trainer.py 140): INFO 	epoch          : 12
[2023-09-26 16:42:23 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.42875245213508606
[2023-09-26 16:42:23 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2685283124446869
[2023-09-26 16:42:23 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.1852114498615265
[2023-09-26 16:42:23 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.1366615742444992
[2023-09-26 16:42:23 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.17445692420005798
[2023-09-26 16:42:23 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3426089286804199
[2023-09-26 16:42:23 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.30852997303009033
[2023-09-26 16:42:23 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.5152842998504639
[2023-09-26 16:42:23 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4745989441871643
[2023-09-26 16:42:23 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.30667561292648315
[2023-09-26 16:42:23 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.22057263553142548
[2023-09-26 16:42:23 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.1698349416255951
[2023-09-26 16:42:23 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.19408196210861206
[2023-09-26 16:42:23 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.37080612778663635
[2023-09-26 16:42:23 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.5919452905654907
[2023-09-26 16:42:23 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 16:42:24 iu_test] (trainer.py 174): INFO EPOCH 12 training takes 0:01:27
[2023-09-26 16:43:48 iu_test] (trainer.py 140): INFO 	epoch          : 13
[2023-09-26 16:43:48 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.37193480134010315
[2023-09-26 16:43:48 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.22747668623924255
[2023-09-26 16:43:48 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.15321916341781616
[2023-09-26 16:43:48 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.1087557002902031
[2023-09-26 16:43:48 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.150712788105011
[2023-09-26 16:43:48 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.32338812947273254
[2023-09-26 16:43:48 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.34161797165870667
[2023-09-26 16:43:48 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.526273488998413
[2023-09-26 16:43:48 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.40089091658592224
[2023-09-26 16:43:48 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.24878081679344177
[2023-09-26 16:43:48 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.17517419159412384
[2023-09-26 16:43:48 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.13103535771369934
[2023-09-26 16:43:48 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16183723509311676
[2023-09-26 16:43:48 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3358815312385559
[2023-09-26 16:43:48 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.42097774147987366
[2023-09-26 16:43:48 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 16:43:50 iu_test] (trainer.py 174): INFO EPOCH 13 training takes 0:01:25
[2023-09-26 16:45:16 iu_test] (trainer.py 140): INFO 	epoch          : 14
[2023-09-26 16:45:16 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.39669284224510193
[2023-09-26 16:45:16 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.21733778715133667
[2023-09-26 16:45:16 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.1388777792453766
[2023-09-26 16:45:16 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.09702173620462418
[2023-09-26 16:45:16 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.14773046970367432
[2023-09-26 16:45:16 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3110206723213196
[2023-09-26 16:45:16 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3070557117462158
[2023-09-26 16:45:16 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.5399562120437622
[2023-09-26 16:45:16 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.44359222054481506
[2023-09-26 16:45:16 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2658458352088928
[2023-09-26 16:45:16 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.18747642636299133
[2023-09-26 16:45:16 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.14251208305358887
[2023-09-26 16:45:16 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.17150074243545532
[2023-09-26 16:45:16 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.34668055176734924
[2023-09-26 16:45:16 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.5771384239196777
[2023-09-26 16:45:16 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 16:45:17 iu_test] (trainer.py 174): INFO EPOCH 14 training takes 0:01:27
[2023-09-26 16:46:42 iu_test] (trainer.py 140): INFO 	epoch          : 15
[2023-09-26 16:46:42 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.3809863328933716
[2023-09-26 16:46:42 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.22103166580200195
[2023-09-26 16:46:42 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.14497289061546326
[2023-09-26 16:46:42 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.10284078866243362
[2023-09-26 16:46:42 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.15088385343551636
[2023-09-26 16:46:42 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3223758339881897
[2023-09-26 16:46:42 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.34788569808006287
[2023-09-26 16:46:42 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.5639599561691284
[2023-09-26 16:46:42 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4128875136375427
[2023-09-26 16:46:42 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2547922134399414
[2023-09-26 16:46:42 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.17886564135551453
[2023-09-26 16:46:42 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.13466250896453857
[2023-09-26 16:46:42 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16685034334659576
[2023-09-26 16:46:42 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.341562956571579
[2023-09-26 16:46:42 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.47250956296920776
[2023-09-26 16:46:42 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 16:46:44 iu_test] (trainer.py 174): INFO EPOCH 15 training takes 0:01:26
[2023-09-26 16:48:08 iu_test] (trainer.py 140): INFO 	epoch          : 16
[2023-09-26 16:48:08 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.4137328565120697
[2023-09-26 16:48:08 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2466045320034027
[2023-09-26 16:48:08 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.16279961168766022
[2023-09-26 16:48:08 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.11507909744977951
[2023-09-26 16:48:08 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.15951037406921387
[2023-09-26 16:48:08 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3295036554336548
[2023-09-26 16:48:08 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3122981786727905
[2023-09-26 16:48:08 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.5989024639129639
[2023-09-26 16:48:08 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.45128846168518066
[2023-09-26 16:48:08 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2779206931591034
[2023-09-26 16:48:08 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.195085346698761
[2023-09-26 16:48:08 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.14715002477169037
[2023-09-26 16:48:08 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.17839975655078888
[2023-09-26 16:48:08 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3510417640209198
[2023-09-26 16:48:08 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.5355973243713379
[2023-09-26 16:48:08 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 16:48:09 iu_test] (trainer.py 174): INFO EPOCH 16 training takes 0:01:25
[2023-09-26 16:49:36 iu_test] (trainer.py 140): INFO 	epoch          : 17
[2023-09-26 16:49:36 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.41751977801322937
[2023-09-26 16:49:36 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.267551988363266
[2023-09-26 16:49:36 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.18391139805316925
[2023-09-26 16:49:36 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.13415071368217468
[2023-09-26 16:49:36 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.16901244223117828
[2023-09-26 16:49:36 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.33649179339408875
[2023-09-26 16:49:36 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3291199207305908
[2023-09-26 16:49:36 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.623171091079712
[2023-09-26 16:49:36 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4496305584907532
[2023-09-26 16:49:36 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.29087328910827637
[2023-09-26 16:49:36 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.20739661157131195
[2023-09-26 16:49:36 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.1578860878944397
[2023-09-26 16:49:36 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.1829409897327423
[2023-09-26 16:49:36 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.35702234506607056
[2023-09-26 16:49:36 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.4634106755256653
[2023-09-26 16:49:36 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 16:49:37 iu_test] (trainer.py 174): INFO EPOCH 17 training takes 0:01:27
[2023-09-26 16:51:02 iu_test] (trainer.py 140): INFO 	epoch          : 18
[2023-09-26 16:51:02 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.40391281247138977
[2023-09-26 16:51:02 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.24035300314426422
[2023-09-26 16:51:02 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.1628500074148178
[2023-09-26 16:51:02 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.11901013553142548
[2023-09-26 16:51:02 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.15729805827140808
[2023-09-26 16:51:02 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3268231749534607
[2023-09-26 16:51:02 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3094100058078766
[2023-09-26 16:51:02 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.646095633506775
[2023-09-26 16:51:02 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4410800039768219
[2023-09-26 16:51:02 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2744106948375702
[2023-09-26 16:51:02 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.19808410108089447
[2023-09-26 16:51:02 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.1537783145904541
[2023-09-26 16:51:02 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.1741102784872055
[2023-09-26 16:51:02 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.347502201795578
[2023-09-26 16:51:02 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.5262185335159302
[2023-09-26 16:51:02 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 16:51:03 iu_test] (trainer.py 174): INFO EPOCH 18 training takes 0:01:26
[2023-09-26 16:52:28 iu_test] (trainer.py 140): INFO 	epoch          : 19
[2023-09-26 16:52:28 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.3934248089790344
[2023-09-26 16:52:28 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2364649772644043
[2023-09-26 16:52:28 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.15937837958335876
[2023-09-26 16:52:28 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.11524935811758041
[2023-09-26 16:52:28 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.15745778381824493
[2023-09-26 16:52:28 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.33437731862068176
[2023-09-26 16:52:28 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3774060606956482
[2023-09-26 16:52:28 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.6596077680587769
[2023-09-26 16:52:28 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.43257835507392883
[2023-09-26 16:52:28 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2661791443824768
[2023-09-26 16:52:28 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.18442724645137787
[2023-09-26 16:52:28 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.1376354843378067
[2023-09-26 16:52:28 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.17566688358783722
[2023-09-26 16:52:28 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3494843542575836
[2023-09-26 16:52:28 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.44221487641334534
[2023-09-26 16:52:28 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 16:52:30 iu_test] (trainer.py 174): INFO EPOCH 19 training takes 0:01:26
[2023-09-26 16:53:55 iu_test] (trainer.py 140): INFO 	epoch          : 20
[2023-09-26 16:53:55 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.4048662483692169
[2023-09-26 16:53:55 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.24889305233955383
[2023-09-26 16:53:55 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.17226901650428772
[2023-09-26 16:53:55 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.1291128695011139
[2023-09-26 16:53:55 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.16207274794578552
[2023-09-26 16:53:55 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3324277400970459
[2023-09-26 16:53:55 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.36256974935531616
[2023-09-26 16:53:55 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.7110297679901123
[2023-09-26 16:53:55 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4489191472530365
[2023-09-26 16:53:55 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2872539758682251
[2023-09-26 16:53:55 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.20895959436893463
[2023-09-26 16:53:55 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.16403304040431976
[2023-09-26 16:53:55 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.1845928579568863
[2023-09-26 16:53:55 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.35965198278427124
[2023-09-26 16:53:55 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.6062034368515015
[2023-09-26 16:53:55 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 16:53:56 iu_test] (trainer.py 174): INFO EPOCH 20 training takes 0:01:26
[2023-09-26 16:55:20 iu_test] (trainer.py 140): INFO 	epoch          : 21
[2023-09-26 16:55:20 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.4183681607246399
[2023-09-26 16:55:20 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2592158019542694
[2023-09-26 16:55:20 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.17729665338993073
[2023-09-26 16:55:20 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.12963071465492249
[2023-09-26 16:55:20 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.16099612414836884
[2023-09-26 16:55:20 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.32828184962272644
[2023-09-26 16:55:20 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.26955947279930115
[2023-09-26 16:55:20 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.7055201530456543
[2023-09-26 16:55:20 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.447099894285202
[2023-09-26 16:55:20 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2895644009113312
[2023-09-26 16:55:20 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.20856957137584686
[2023-09-26 16:55:20 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.1618129462003708
[2023-09-26 16:55:20 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.1779463142156601
[2023-09-26 16:55:20 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3530231714248657
[2023-09-26 16:55:20 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.5000063180923462
[2023-09-26 16:55:20 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 16:55:22 iu_test] (trainer.py 174): INFO EPOCH 21 training takes 0:01:25
[2023-09-26 16:56:47 iu_test] (trainer.py 140): INFO 	epoch          : 22
[2023-09-26 16:56:47 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.4334229826927185
[2023-09-26 16:56:47 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2713163495063782
[2023-09-26 16:56:47 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.18796901404857635
[2023-09-26 16:56:47 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.1395246982574463
[2023-09-26 16:56:47 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.16793790459632874
[2023-09-26 16:56:47 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.33622992038726807
[2023-09-26 16:56:47 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.38677480816841125
[2023-09-26 16:56:47 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.7318066358566284
[2023-09-26 16:56:47 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.45587626099586487
[2023-09-26 16:56:47 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2922757565975189
[2023-09-26 16:56:47 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.21043053269386292
[2023-09-26 16:56:47 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.16205927729606628
[2023-09-26 16:56:47 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.18615680932998657
[2023-09-26 16:56:47 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.35766980051994324
[2023-09-26 16:56:47 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.5331266522407532
[2023-09-26 16:56:47 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 16:56:48 iu_test] (trainer.py 174): INFO EPOCH 22 training takes 0:01:26
[2023-09-26 16:58:14 iu_test] (trainer.py 140): INFO 	epoch          : 23
[2023-09-26 16:58:14 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.3980932831764221
[2023-09-26 16:58:14 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.24850334227085114
[2023-09-26 16:58:14 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.17325080931186676
[2023-09-26 16:58:14 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.1301555037498474
[2023-09-26 16:58:14 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.16198469698429108
[2023-09-26 16:58:14 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3332260251045227
[2023-09-26 16:58:14 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.4046032428741455
[2023-09-26 16:58:14 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.7806118726730347
[2023-09-26 16:58:14 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4464629292488098
[2023-09-26 16:58:14 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2903274595737457
[2023-09-26 16:58:14 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.21055848896503448
[2023-09-26 16:58:14 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.16380639374256134
[2023-09-26 16:58:14 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.1847122311592102
[2023-09-26 16:58:14 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3638351559638977
[2023-09-26 16:58:14 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.5552654266357422
[2023-09-26 16:58:14 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 16:58:15 iu_test] (trainer.py 174): INFO EPOCH 23 training takes 0:01:27
[2023-09-26 16:59:41 iu_test] (trainer.py 140): INFO 	epoch          : 24
[2023-09-26 16:59:41 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.40136486291885376
[2023-09-26 16:59:41 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2455349713563919
[2023-09-26 16:59:41 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.16836680471897125
[2023-09-26 16:59:41 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.12503042817115784
[2023-09-26 16:59:41 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.15729722380638123
[2023-09-26 16:59:41 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3283252716064453
[2023-09-26 16:59:41 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.312728613615036
[2023-09-26 16:59:41 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.7942962646484375
[2023-09-26 16:59:41 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4283753037452698
[2023-09-26 16:59:41 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.26834002137184143
[2023-09-26 16:59:41 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.1884085088968277
[2023-09-26 16:59:41 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.14241334795951843
[2023-09-26 16:59:41 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.1724431961774826
[2023-09-26 16:59:41 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3428440988063812
[2023-09-26 16:59:41 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.4238825738430023
[2023-09-26 16:59:41 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 16:59:42 iu_test] (trainer.py 174): INFO EPOCH 24 training takes 0:01:26
[2023-09-26 17:01:07 iu_test] (trainer.py 140): INFO 	epoch          : 25
[2023-09-26 17:01:07 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.406715989112854
[2023-09-26 17:01:07 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.24752873182296753
[2023-09-26 17:01:07 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.1652488112449646
[2023-09-26 17:01:07 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.11867605149745941
[2023-09-26 17:01:07 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.16062018275260925
[2023-09-26 17:01:07 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3280348777770996
[2023-09-26 17:01:07 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3437735438346863
[2023-09-26 17:01:07 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.8217658996582031
[2023-09-26 17:01:07 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.41892868280410767
[2023-09-26 17:01:07 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2620093524456024
[2023-09-26 17:01:07 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.18427743017673492
[2023-09-26 17:01:07 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.13908669352531433
[2023-09-26 17:01:07 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16954554617404938
[2023-09-26 17:01:07 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3414818346500397
[2023-09-26 17:01:07 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.5113668441772461
[2023-09-26 17:01:07 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 17:01:09 iu_test] (trainer.py 174): INFO EPOCH 25 training takes 0:01:26
[2023-09-26 17:02:33 iu_test] (trainer.py 140): INFO 	epoch          : 26
[2023-09-26 17:02:33 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.395693838596344
[2023-09-26 17:02:33 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2358970046043396
[2023-09-26 17:02:33 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.157955139875412
[2023-09-26 17:02:33 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.11315517127513885
[2023-09-26 17:02:33 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.15485677123069763
[2023-09-26 17:02:33 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.32209888100624084
[2023-09-26 17:02:33 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.348421573638916
[2023-09-26 17:02:33 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.8415800333023071
[2023-09-26 17:02:33 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4246586859226227
[2023-09-26 17:02:33 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2697049379348755
[2023-09-26 17:02:33 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.1931684911251068
[2023-09-26 17:02:33 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.14840088784694672
[2023-09-26 17:02:33 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.17322880029678345
[2023-09-26 17:02:33 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3501427173614502
[2023-09-26 17:02:33 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.49642249941825867
[2023-09-26 17:02:33 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 17:02:35 iu_test] (trainer.py 174): INFO EPOCH 26 training takes 0:01:25
[2023-09-26 17:03:59 iu_test] (trainer.py 140): INFO 	epoch          : 27
[2023-09-26 17:03:59 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.40222397446632385
[2023-09-26 17:03:59 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.24742421507835388
[2023-09-26 17:03:59 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.1655930131673813
[2023-09-26 17:03:59 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.11892838776111603
[2023-09-26 17:03:59 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.15591830015182495
[2023-09-26 17:03:59 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.31607961654663086
[2023-09-26 17:03:59 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.27918314933776855
[2023-09-26 17:03:59 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.8595174551010132
[2023-09-26 17:03:59 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4249365031719208
[2023-09-26 17:03:59 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2683037221431732
[2023-09-26 17:03:59 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.18784958124160767
[2023-09-26 17:03:59 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.1411401480436325
[2023-09-26 17:03:59 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16926419734954834
[2023-09-26 17:03:59 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.34003275632858276
[2023-09-26 17:03:59 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.41440486907958984
[2023-09-26 17:03:59 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 17:04:00 iu_test] (trainer.py 174): INFO EPOCH 27 training takes 0:01:25
[2023-09-26 17:05:26 iu_test] (trainer.py 140): INFO 	epoch          : 28
[2023-09-26 17:05:26 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.38600045442581177
[2023-09-26 17:05:26 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.24319733679294586
[2023-09-26 17:05:26 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.16765262186527252
[2023-09-26 17:05:26 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.12404104322195053
[2023-09-26 17:05:26 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.15632857382297516
[2023-09-26 17:05:26 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3293883800506592
[2023-09-26 17:05:26 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3191637396812439
[2023-09-26 17:05:26 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.8954881429672241
[2023-09-26 17:05:26 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.3985178470611572
[2023-09-26 17:05:26 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2430698424577713
[2023-09-26 17:05:26 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.16531197726726532
[2023-09-26 17:05:26 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.1202852800488472
[2023-09-26 17:05:26 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.1627236008644104
[2023-09-26 17:05:26 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3355986475944519
[2023-09-26 17:05:26 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.42156311869621277
[2023-09-26 17:05:26 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 17:05:28 iu_test] (trainer.py 174): INFO EPOCH 28 training takes 0:01:27
[2023-09-26 17:06:52 iu_test] (trainer.py 140): INFO 	epoch          : 29
[2023-09-26 17:06:52 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.4095478057861328
[2023-09-26 17:06:52 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.24880768358707428
[2023-09-26 17:06:52 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.16582642495632172
[2023-09-26 17:06:52 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.11868418008089066
[2023-09-26 17:06:52 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.16079086065292358
[2023-09-26 17:06:52 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.32287144660949707
[2023-09-26 17:06:52 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.25613486766815186
[2023-09-26 17:06:52 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.894716739654541
[2023-09-26 17:06:52 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4296041429042816
[2023-09-26 17:06:52 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2630200684070587
[2023-09-26 17:06:52 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.17984749376773834
[2023-09-26 17:06:52 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.13150689005851746
[2023-09-26 17:06:52 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16854047775268555
[2023-09-26 17:06:52 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3346841633319855
[2023-09-26 17:06:52 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.3720521330833435
[2023-09-26 17:06:52 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 17:06:54 iu_test] (trainer.py 174): INFO EPOCH 29 training takes 0:01:26
[2023-09-26 17:08:18 iu_test] (trainer.py 140): INFO 	epoch          : 30
[2023-09-26 17:08:18 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.368630975484848
[2023-09-26 17:08:18 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.22486838698387146
[2023-09-26 17:08:18 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.15302793681621552
[2023-09-26 17:08:18 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.11301127821207047
[2023-09-26 17:08:18 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.15093936026096344
[2023-09-26 17:08:18 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.31123659014701843
[2023-09-26 17:08:18 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3239603340625763
[2023-09-26 17:08:18 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.9307608604431152
[2023-09-26 17:08:18 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.39900556206703186
[2023-09-26 17:08:18 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2482748180627823
[2023-09-26 17:08:18 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.17466044425964355
[2023-09-26 17:08:18 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.13174933195114136
[2023-09-26 17:08:18 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16293013095855713
[2023-09-26 17:08:18 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.33714422583580017
[2023-09-26 17:08:18 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.4189044237136841
[2023-09-26 17:08:18 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 17:08:20 iu_test] (trainer.py 174): INFO EPOCH 30 training takes 0:01:25
[2023-09-26 17:09:44 iu_test] (trainer.py 140): INFO 	epoch          : 31
[2023-09-26 17:09:44 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.39761850237846375
[2023-09-26 17:09:44 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.24492980539798737
[2023-09-26 17:09:44 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.16582314670085907
[2023-09-26 17:09:44 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.11934825032949448
[2023-09-26 17:09:44 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.15767541527748108
[2023-09-26 17:09:44 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3207907974720001
[2023-09-26 17:09:44 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.31912654638290405
[2023-09-26 17:09:44 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.9399688243865967
[2023-09-26 17:09:44 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.41336992383003235
[2023-09-26 17:09:44 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2507026195526123
[2023-09-26 17:09:44 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.1700122356414795
[2023-09-26 17:09:44 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.12333257496356964
[2023-09-26 17:09:44 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.1646512746810913
[2023-09-26 17:09:44 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.32564303278923035
[2023-09-26 17:09:44 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.33906668424606323
[2023-09-26 17:09:44 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 17:09:46 iu_test] (trainer.py 174): INFO EPOCH 31 training takes 0:01:26
[2023-09-26 17:11:10 iu_test] (trainer.py 140): INFO 	epoch          : 32
[2023-09-26 17:11:10 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.373952716588974
[2023-09-26 17:11:10 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.22545142471790314
[2023-09-26 17:11:10 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.15119056403636932
[2023-09-26 17:11:10 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.1087607815861702
[2023-09-26 17:11:10 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.15078285336494446
[2023-09-26 17:11:10 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3128933310508728
[2023-09-26 17:11:10 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.2949990928173065
[2023-09-26 17:11:10 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.9697197675704956
[2023-09-26 17:11:10 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.412624716758728
[2023-09-26 17:11:10 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.25112244486808777
[2023-09-26 17:11:10 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.16833075881004333
[2023-09-26 17:11:10 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.11997716873884201
[2023-09-26 17:11:10 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16602352261543274
[2023-09-26 17:11:10 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.33306655287742615
[2023-09-26 17:11:10 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.3714842200279236
[2023-09-26 17:11:10 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 17:11:11 iu_test] (trainer.py 174): INFO EPOCH 32 training takes 0:01:25
[2023-09-26 17:12:36 iu_test] (trainer.py 140): INFO 	epoch          : 33
[2023-09-26 17:12:36 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.3879457712173462
[2023-09-26 17:12:36 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2343723326921463
[2023-09-26 17:12:36 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.15257644653320312
[2023-09-26 17:12:36 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.106151282787323
[2023-09-26 17:12:36 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.1552346795797348
[2023-09-26 17:12:36 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3096766471862793
[2023-09-26 17:12:36 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.27543485164642334
[2023-09-26 17:12:36 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.0138189792633057
[2023-09-26 17:12:36 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4060833156108856
[2023-09-26 17:12:36 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2465611696243286
[2023-09-26 17:12:36 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.166918084025383
[2023-09-26 17:12:36 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.11980820447206497
[2023-09-26 17:12:36 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16547133028507233
[2023-09-26 17:12:36 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3266752362251282
[2023-09-26 17:12:36 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.3693501651287079
[2023-09-26 17:12:36 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 17:12:38 iu_test] (trainer.py 174): INFO EPOCH 33 training takes 0:01:26
[2023-09-26 17:14:03 iu_test] (trainer.py 140): INFO 	epoch          : 34
[2023-09-26 17:14:03 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.380596399307251
[2023-09-26 17:14:03 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2258923351764679
[2023-09-26 17:14:03 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.14792966842651367
[2023-09-26 17:14:03 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.10180303454399109
[2023-09-26 17:14:03 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.1543114334344864
[2023-09-26 17:14:03 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.30829596519470215
[2023-09-26 17:14:03 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.2610291540622711
[2023-09-26 17:14:03 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.0277764797210693
[2023-09-26 17:14:03 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.3989201486110687
[2023-09-26 17:14:03 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.24478495121002197
[2023-09-26 17:14:03 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.16693264245986938
[2023-09-26 17:14:03 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.12113326787948608
[2023-09-26 17:14:03 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16154025495052338
[2023-09-26 17:14:03 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3202531039714813
[2023-09-26 17:14:03 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.34777477383613586
[2023-09-26 17:14:03 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 17:14:04 iu_test] (trainer.py 174): INFO EPOCH 34 training takes 0:01:26
[2023-09-26 17:15:28 iu_test] (trainer.py 140): INFO 	epoch          : 35
[2023-09-26 17:15:28 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.4011203348636627
[2023-09-26 17:15:28 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.24402423202991486
[2023-09-26 17:15:28 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.16452211141586304
[2023-09-26 17:15:28 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.11799602955579758
[2023-09-26 17:15:28 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.1611119508743286
[2023-09-26 17:15:28 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3168119192123413
[2023-09-26 17:15:28 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.2523973882198334
[2023-09-26 17:15:28 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.06276798248291
[2023-09-26 17:15:28 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4184393584728241
[2023-09-26 17:15:28 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2576891779899597
[2023-09-26 17:15:28 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.17442378401756287
[2023-09-26 17:15:28 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.12478571385145187
[2023-09-26 17:15:28 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.17008890211582184
[2023-09-26 17:15:28 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3267729580402374
[2023-09-26 17:15:28 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.323762446641922
[2023-09-26 17:15:28 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 17:15:29 iu_test] (trainer.py 174): INFO EPOCH 35 training takes 0:01:25
[2023-09-26 17:16:53 iu_test] (trainer.py 140): INFO 	epoch          : 36
[2023-09-26 17:16:53 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.395123690366745
[2023-09-26 17:16:53 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.23516853153705597
[2023-09-26 17:16:53 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.154469296336174
[2023-09-26 17:16:53 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.1090671494603157
[2023-09-26 17:16:53 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.15823547542095184
[2023-09-26 17:16:53 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3093355894088745
[2023-09-26 17:16:53 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.25691288709640503
[2023-09-26 17:16:53 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.087069272994995
[2023-09-26 17:16:53 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.422788143157959
[2023-09-26 17:16:53 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.259989857673645
[2023-09-26 17:16:53 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.17714090645313263
[2023-09-26 17:16:53 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.12848533689975739
[2023-09-26 17:16:53 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16986088454723358
[2023-09-26 17:16:53 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3329031467437744
[2023-09-26 17:16:53 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.3652949631214142
[2023-09-26 17:16:53 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 17:16:55 iu_test] (trainer.py 174): INFO EPOCH 36 training takes 0:01:25
[2023-09-26 17:18:20 iu_test] (trainer.py 140): INFO 	epoch          : 37
[2023-09-26 17:18:20 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.39890989661216736
[2023-09-26 17:18:20 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.23912854492664337
[2023-09-26 17:18:20 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.15896950662136078
[2023-09-26 17:18:20 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.11333102732896805
[2023-09-26 17:18:20 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.15882089734077454
[2023-09-26 17:18:20 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3099287152290344
[2023-09-26 17:18:20 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.2422371208667755
[2023-09-26 17:18:20 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.121488332748413
[2023-09-26 17:18:20 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4019370973110199
[2023-09-26 17:18:20 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2457219958305359
[2023-09-26 17:18:20 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.1675674319267273
[2023-09-26 17:18:20 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.12286949157714844
[2023-09-26 17:18:20 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16191764175891876
[2023-09-26 17:18:20 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3176054358482361
[2023-09-26 17:18:20 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.3564283549785614
[2023-09-26 17:18:20 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 17:18:22 iu_test] (trainer.py 174): INFO EPOCH 37 training takes 0:01:27
[2023-09-26 17:19:47 iu_test] (trainer.py 140): INFO 	epoch          : 38
[2023-09-26 17:19:47 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.3766437768936157
[2023-09-26 17:19:47 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2188219428062439
[2023-09-26 17:19:47 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.138456329703331
[2023-09-26 17:19:47 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.09225817024707794
[2023-09-26 17:19:47 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.15228791534900665
[2023-09-26 17:19:47 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.30468568205833435
[2023-09-26 17:19:47 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.21456272900104523
[2023-09-26 17:19:47 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.1544277667999268
[2023-09-26 17:19:47 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.3981810510158539
[2023-09-26 17:19:47 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.23800991475582123
[2023-09-26 17:19:47 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.15751980245113373
[2023-09-26 17:19:47 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.11022033542394638
[2023-09-26 17:19:47 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.1600116342306137
[2023-09-26 17:19:47 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.31930622458457947
[2023-09-26 17:19:47 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.3199343979358673
[2023-09-26 17:19:47 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 17:19:48 iu_test] (trainer.py 174): INFO EPOCH 38 training takes 0:01:26
[2023-09-26 17:21:14 iu_test] (trainer.py 140): INFO 	epoch          : 39
[2023-09-26 17:21:14 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.3998129665851593
[2023-09-26 17:21:14 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.23656615614891052
[2023-09-26 17:21:14 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.15147671103477478
[2023-09-26 17:21:14 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.10370001196861267
[2023-09-26 17:21:14 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.15913082659244537
[2023-09-26 17:21:14 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3104453980922699
[2023-09-26 17:21:14 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.2050773650407791
[2023-09-26 17:21:14 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.151993989944458
[2023-09-26 17:21:14 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.42597508430480957
[2023-09-26 17:21:14 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.26109904050827026
[2023-09-26 17:21:14 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.1781996637582779
[2023-09-26 17:21:14 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.1308264285326004
[2023-09-26 17:21:14 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.1691683679819107
[2023-09-26 17:21:14 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3287821412086487
[2023-09-26 17:21:14 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.345650315284729
[2023-09-26 17:21:14 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 17:21:15 iu_test] (trainer.py 174): INFO EPOCH 39 training takes 0:01:27
[2023-09-26 17:22:40 iu_test] (trainer.py 140): INFO 	epoch          : 40
[2023-09-26 17:22:40 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.40372440218925476
[2023-09-26 17:22:40 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.24625560641288757
[2023-09-26 17:22:40 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.16218994557857513
[2023-09-26 17:22:40 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.11350882798433304
[2023-09-26 17:22:40 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.1615210324525833
[2023-09-26 17:22:40 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.31683939695358276
[2023-09-26 17:22:40 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.282412588596344
[2023-09-26 17:22:40 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.2007241249084473
[2023-09-26 17:22:40 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4170655906200409
[2023-09-26 17:22:40 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2558988332748413
[2023-09-26 17:22:40 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.17451229691505432
[2023-09-26 17:22:40 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.12700684368610382
[2023-09-26 17:22:40 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16967304050922394
[2023-09-26 17:22:40 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3251603841781616
[2023-09-26 17:22:40 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.32921305298805237
[2023-09-26 17:22:40 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-26 17:22:41 iu_test] (trainer.py 174): INFO EPOCH 40 training takes 0:01:26
[2023-09-26 23:34:37 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 23:34:37 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 23:34:58 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 23:34:58 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 23:36:01 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 23:36:01 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 23:36:14 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 23:36:14 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 23:36:38 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 23:36:38 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 23:41:19 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 23:41:19 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 23:42:34 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 23:42:34 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 23:43:03 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 23:43:03 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 23:43:04 iu_test] (main.py 105): INFO number of params: 56954169
[2023-09-26 23:43:16 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 23:43:16 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 23:43:16 iu_test] (main.py 105): INFO number of params: 56954169
[2023-09-26 23:44:08 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 23:44:08 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 23:44:09 iu_test] (main.py 105): INFO number of params: 56954169
[2023-09-26 23:45:14 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 23:45:14 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 23:45:15 iu_test] (main.py 105): INFO number of params: 56954169
[2023-09-26 23:45:45 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 23:45:45 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 23:45:46 iu_test] (main.py 105): INFO number of params: 56954169
[2023-09-26 23:46:18 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 23:46:18 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 23:46:19 iu_test] (main.py 105): INFO number of params: 56954169
[2023-09-26 23:47:13 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 23:47:13 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 23:47:14 iu_test] (main.py 105): INFO number of params: 56954169
[2023-09-26 23:47:37 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 23:47:37 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 23:47:37 iu_test] (main.py 105): INFO number of params: 56954169
[2023-09-26 23:49:02 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 23:49:02 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 23:49:02 iu_test] (main.py 105): INFO number of params: 56954169
[2023-09-26 23:50:28 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 23:50:28 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 23:50:29 iu_test] (main.py 105): INFO number of params: 56954169
[2023-09-26 23:51:03 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 23:51:03 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 23:51:03 iu_test] (main.py 105): INFO number of params: 56954169
[2023-09-26 23:51:37 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 23:51:37 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 23:51:37 iu_test] (main.py 105): INFO number of params: 56954169
[2023-09-26 23:53:44 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 23:53:44 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 23:53:45 iu_test] (main.py 105): INFO number of params: 56954169
[2023-09-26 23:54:24 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 23:54:24 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 23:54:25 iu_test] (main.py 105): INFO number of params: 56954169
[2023-09-26 23:55:53 iu_test] (trainer.py 140): INFO 	epoch          : 1
[2023-09-26 23:55:53 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.0998508632183075
[2023-09-26 23:55:53 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.05694315582513809
[2023-09-26 23:55:53 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.039807043969631195
[2023-09-26 23:55:53 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.029769061133265495
[2023-09-26 23:55:53 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.05361174792051315
[2023-09-26 23:55:53 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.2530914843082428
[2023-09-26 23:55:53 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.07959121465682983
[2023-09-26 23:55:53 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 3.7552249431610107
[2023-09-26 23:55:53 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.12747687101364136
[2023-09-26 23:55:53 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.0746111050248146
[2023-09-26 23:55:53 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.05279557406902313
[2023-09-26 23:55:53 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.03923726826906204
[2023-09-26 23:55:53 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.062420476227998734
[2023-09-26 23:55:53 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.27579426765441895
[2023-09-26 23:55:53 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.08763930201530457
[2023-09-26 23:55:53 iu_test] (trainer.py 168): INFO current best model in: 1
[2023-09-26 23:55:55 iu_test] (trainer.py 174): INFO EPOCH 1 training takes 0:01:30
[2023-09-26 23:57:22 iu_test] (trainer.py 140): INFO 	epoch          : 2
[2023-09-26 23:57:22 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.31088483333587646
[2023-09-26 23:57:22 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2048460841178894
[2023-09-26 23:57:22 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.14559568464756012
[2023-09-26 23:57:22 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.1097278967499733
[2023-09-26 23:57:22 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.1463889181613922
[2023-09-26 23:57:22 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.35282212495803833
[2023-09-26 23:57:22 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.32054415345191956
[2023-09-26 23:57:22 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.5559303760528564
[2023-09-26 23:57:22 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.36189624667167664
[2023-09-26 23:57:22 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2398417443037033
[2023-09-26 23:57:22 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.17193067073822021
[2023-09-26 23:57:22 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.13011769950389862
[2023-09-26 23:57:22 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16276387870311737
[2023-09-26 23:57:22 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3700419068336487
[2023-09-26 23:57:22 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.37922096252441406
[2023-09-26 23:57:22 iu_test] (trainer.py 168): INFO current best model in: 2
[2023-09-26 23:57:25 iu_test] (trainer.py 174): INFO EPOCH 2 training takes 0:01:29
[2023-09-26 23:58:52 iu_test] (trainer.py 140): INFO 	epoch          : 3
[2023-09-26 23:58:52 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.3261716663837433
[2023-09-26 23:58:52 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2144891768693924
[2023-09-26 23:58:52 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.15199482440948486
[2023-09-26 23:58:52 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.11429591476917267
[2023-09-26 23:58:52 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.14861665666103363
[2023-09-26 23:58:52 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.35517147183418274
[2023-09-26 23:58:52 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.33445754647254944
[2023-09-26 23:58:52 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.10860538482666
[2023-09-26 23:58:52 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.37519943714141846
[2023-09-26 23:58:52 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.24831092357635498
[2023-09-26 23:58:52 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.17790721356868744
[2023-09-26 23:58:52 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.13445931673049927
[2023-09-26 23:58:52 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16518335044384003
[2023-09-26 23:58:52 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3737305998802185
[2023-09-26 23:58:52 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.39949196577072144
[2023-09-26 23:58:52 iu_test] (trainer.py 168): INFO current best model in: 3
[2023-09-26 23:58:54 iu_test] (trainer.py 174): INFO EPOCH 3 training takes 0:01:29
[2023-09-27 00:00:21 iu_test] (trainer.py 140): INFO 	epoch          : 4
[2023-09-27 00:00:21 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.22847966849803925
[2023-09-27 00:00:21 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.13758036494255066
[2023-09-27 00:00:21 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.09541063010692596
[2023-09-27 00:00:21 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.07166126370429993
[2023-09-27 00:00:21 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.11437591165304184
[2023-09-27 00:00:21 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3014432489871979
[2023-09-27 00:00:21 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3409772515296936
[2023-09-27 00:00:21 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.8619767427444458
[2023-09-27 00:00:21 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.27317723631858826
[2023-09-27 00:00:21 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.16493669152259827
[2023-09-27 00:00:21 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.11611098796129227
[2023-09-27 00:00:21 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.08748423308134079
[2023-09-27 00:00:21 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.12849128246307373
[2023-09-27 00:00:21 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3180129826068878
[2023-09-27 00:00:21 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.35639581084251404
[2023-09-27 00:00:21 iu_test] (trainer.py 168): INFO current best model in: 3
[2023-09-27 00:00:22 iu_test] (trainer.py 174): INFO EPOCH 4 training takes 0:01:27
[2023-09-27 00:01:48 iu_test] (trainer.py 140): INFO 	epoch          : 5
[2023-09-27 00:01:48 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.18907713890075684
[2023-09-27 00:01:48 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.1123068779706955
[2023-09-27 00:01:48 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.07940645515918732
[2023-09-27 00:01:48 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.06079559400677681
[2023-09-27 00:01:48 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.10129893571138382
[2023-09-27 00:01:48 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.29379186034202576
[2023-09-27 00:01:48 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.333942711353302
[2023-09-27 00:01:48 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.7292520999908447
[2023-09-27 00:01:48 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.23163893818855286
[2023-09-27 00:01:48 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.14060145616531372
[2023-09-27 00:01:48 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.10116192698478699
[2023-09-27 00:01:48 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.0777238979935646
[2023-09-27 00:01:48 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.11685232073068619
[2023-09-27 00:01:48 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3112121820449829
[2023-09-27 00:01:48 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.34383901953697205
[2023-09-27 00:01:48 iu_test] (trainer.py 168): INFO current best model in: 3
[2023-09-27 00:01:49 iu_test] (trainer.py 174): INFO EPOCH 5 training takes 0:01:27
[2023-09-27 00:03:15 iu_test] (trainer.py 140): INFO 	epoch          : 6
[2023-09-27 00:03:15 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.2663732171058655
[2023-09-27 00:03:15 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.15566062927246094
[2023-09-27 00:03:15 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.10371039062738419
[2023-09-27 00:03:15 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.07372689247131348
[2023-09-27 00:03:15 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.1185193881392479
[2023-09-27 00:03:15 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.311589777469635
[2023-09-27 00:03:15 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.2513517141342163
[2023-09-27 00:03:15 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.632674217224121
[2023-09-27 00:03:15 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.31167033314704895
[2023-09-27 00:03:15 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.18468809127807617
[2023-09-27 00:03:15 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.12590961158275604
[2023-09-27 00:03:15 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.09308299422264099
[2023-09-27 00:03:15 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.13446646928787231
[2023-09-27 00:03:15 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3265284597873688
[2023-09-27 00:03:15 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.40003257989883423
[2023-09-27 00:03:15 iu_test] (trainer.py 168): INFO current best model in: 3
[2023-09-27 00:03:17 iu_test] (trainer.py 174): INFO EPOCH 6 training takes 0:01:27
[2023-09-27 00:04:43 iu_test] (trainer.py 140): INFO 	epoch          : 7
[2023-09-27 00:04:43 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.20812855660915375
[2023-09-27 00:04:43 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.12480729818344116
[2023-09-27 00:04:43 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.0875176191329956
[2023-09-27 00:04:43 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.066465362906456
[2023-09-27 00:04:43 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.10829721391201019
[2023-09-27 00:04:43 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.2966649830341339
[2023-09-27 00:04:43 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.33682185411453247
[2023-09-27 00:04:43 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.570832371711731
[2023-09-27 00:04:43 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.24553366005420685
[2023-09-27 00:04:43 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.1492687314748764
[2023-09-27 00:04:43 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.10673655569553375
[2023-09-27 00:04:43 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.08148854970932007
[2023-09-27 00:04:43 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.120656818151474
[2023-09-27 00:04:43 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3109962046146393
[2023-09-27 00:04:43 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.34578365087509155
[2023-09-27 00:04:43 iu_test] (trainer.py 168): INFO current best model in: 3
[2023-09-27 00:04:44 iu_test] (trainer.py 174): INFO EPOCH 7 training takes 0:01:27
[2023-09-27 00:06:12 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 00:06:12 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 00:06:13 iu_test] (main.py 105): INFO number of params: 56954169
[2023-09-27 00:07:41 iu_test] (trainer.py 140): INFO 	epoch          : 1
[2023-09-27 00:07:41 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.0998508632183075
[2023-09-27 00:07:41 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.05694315582513809
[2023-09-27 00:07:41 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.039807043969631195
[2023-09-27 00:07:41 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.029769061133265495
[2023-09-27 00:07:41 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.05361174792051315
[2023-09-27 00:07:41 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.2530914843082428
[2023-09-27 00:07:41 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.07959121465682983
[2023-09-27 00:07:41 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 3.7552249431610107
[2023-09-27 00:07:41 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.12747687101364136
[2023-09-27 00:07:41 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.0746111050248146
[2023-09-27 00:07:41 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.05279557406902313
[2023-09-27 00:07:41 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.03923726826906204
[2023-09-27 00:07:41 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.062420476227998734
[2023-09-27 00:07:41 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.27579426765441895
[2023-09-27 00:07:41 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.08763930201530457
[2023-09-27 00:07:41 iu_test] (trainer.py 168): INFO current best model in: 1
[2023-09-27 00:07:43 iu_test] (trainer.py 174): INFO EPOCH 1 training takes 0:01:30
[2023-09-27 00:09:10 iu_test] (trainer.py 140): INFO 	epoch          : 2
[2023-09-27 00:09:10 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.31088483333587646
[2023-09-27 00:09:10 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2048460841178894
[2023-09-27 00:09:10 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.14559568464756012
[2023-09-27 00:09:10 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.1097278967499733
[2023-09-27 00:09:10 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.1463889181613922
[2023-09-27 00:09:10 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.35282212495803833
[2023-09-27 00:09:10 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.32054415345191956
[2023-09-27 00:09:10 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.5559303760528564
[2023-09-27 00:09:10 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.36189624667167664
[2023-09-27 00:09:10 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2398417443037033
[2023-09-27 00:09:10 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.17193067073822021
[2023-09-27 00:09:10 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.13011769950389862
[2023-09-27 00:09:10 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16276387870311737
[2023-09-27 00:09:10 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3700419068336487
[2023-09-27 00:09:10 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.37922096252441406
[2023-09-27 00:09:10 iu_test] (trainer.py 168): INFO current best model in: 2
[2023-09-27 00:09:13 iu_test] (trainer.py 174): INFO EPOCH 2 training takes 0:01:29
[2023-09-27 00:10:38 iu_test] (trainer.py 140): INFO 	epoch          : 3
[2023-09-27 00:10:38 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.3261716663837433
[2023-09-27 00:10:38 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2144891768693924
[2023-09-27 00:10:38 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.15199482440948486
[2023-09-27 00:10:38 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.11429591476917267
[2023-09-27 00:10:38 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.14861665666103363
[2023-09-27 00:10:38 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.35517147183418274
[2023-09-27 00:10:38 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.33445754647254944
[2023-09-27 00:10:38 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.10860538482666
[2023-09-27 00:10:38 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.37519943714141846
[2023-09-27 00:10:38 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.24831092357635498
[2023-09-27 00:10:38 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.17790721356868744
[2023-09-27 00:10:38 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.13445931673049927
[2023-09-27 00:10:38 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16518335044384003
[2023-09-27 00:10:38 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3737305998802185
[2023-09-27 00:10:38 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.39949196577072144
[2023-09-27 00:10:38 iu_test] (trainer.py 168): INFO current best model in: 3
[2023-09-27 00:10:41 iu_test] (trainer.py 174): INFO EPOCH 3 training takes 0:01:28
[2023-09-27 00:12:08 iu_test] (trainer.py 140): INFO 	epoch          : 4
[2023-09-27 00:12:08 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.22847966849803925
[2023-09-27 00:12:08 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.13758036494255066
[2023-09-27 00:12:08 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.09541063010692596
[2023-09-27 00:12:08 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.07166126370429993
[2023-09-27 00:12:08 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.11437591165304184
[2023-09-27 00:12:08 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3014432489871979
[2023-09-27 00:12:08 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3409772515296936
[2023-09-27 00:12:08 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.8619767427444458
[2023-09-27 00:12:08 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.27317723631858826
[2023-09-27 00:12:08 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.16493669152259827
[2023-09-27 00:12:08 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.11611098796129227
[2023-09-27 00:12:08 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.08748423308134079
[2023-09-27 00:12:08 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.12849128246307373
[2023-09-27 00:12:08 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3180129826068878
[2023-09-27 00:12:08 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.35639581084251404
[2023-09-27 00:12:08 iu_test] (trainer.py 168): INFO current best model in: 3
[2023-09-27 00:12:09 iu_test] (trainer.py 174): INFO EPOCH 4 training takes 0:01:28
[2023-09-27 00:13:36 iu_test] (trainer.py 140): INFO 	epoch          : 5
[2023-09-27 00:13:36 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.18907713890075684
[2023-09-27 00:13:36 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.1123068779706955
[2023-09-27 00:13:36 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.07940645515918732
[2023-09-27 00:13:36 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.06079559400677681
[2023-09-27 00:13:36 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.10129893571138382
[2023-09-27 00:13:36 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.29379186034202576
[2023-09-27 00:13:36 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.333942711353302
[2023-09-27 00:13:36 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.7292520999908447
[2023-09-27 00:13:36 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.23163893818855286
[2023-09-27 00:13:36 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.14060145616531372
[2023-09-27 00:13:36 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.10116192698478699
[2023-09-27 00:13:36 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.0777238979935646
[2023-09-27 00:13:36 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.11685232073068619
[2023-09-27 00:13:36 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3112121820449829
[2023-09-27 00:13:36 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.34383901953697205
[2023-09-27 00:13:36 iu_test] (trainer.py 168): INFO current best model in: 3
[2023-09-27 00:13:37 iu_test] (trainer.py 174): INFO EPOCH 5 training takes 0:01:27
[2023-09-27 00:15:02 iu_test] (trainer.py 140): INFO 	epoch          : 6
[2023-09-27 00:15:02 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.2663732171058655
[2023-09-27 00:15:02 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.15566062927246094
[2023-09-27 00:15:02 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.10371039062738419
[2023-09-27 00:15:02 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.07372689247131348
[2023-09-27 00:15:02 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.1185193881392479
[2023-09-27 00:15:02 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.311589777469635
[2023-09-27 00:15:02 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.2513517141342163
[2023-09-27 00:15:02 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.632674217224121
[2023-09-27 00:15:02 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.31167033314704895
[2023-09-27 00:15:02 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.18468809127807617
[2023-09-27 00:15:02 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.12590961158275604
[2023-09-27 00:15:02 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.09308299422264099
[2023-09-27 00:15:02 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.13446646928787231
[2023-09-27 00:15:02 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3265284597873688
[2023-09-27 00:15:02 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.40003257989883423
[2023-09-27 00:15:02 iu_test] (trainer.py 168): INFO current best model in: 3
[2023-09-27 00:15:03 iu_test] (trainer.py 174): INFO EPOCH 6 training takes 0:01:26
[2023-09-27 00:16:30 iu_test] (trainer.py 140): INFO 	epoch          : 7
[2023-09-27 00:16:30 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.20812855660915375
[2023-09-27 00:16:30 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.12480729818344116
[2023-09-27 00:16:30 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.0875176191329956
[2023-09-27 00:16:30 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.066465362906456
[2023-09-27 00:16:30 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.10829721391201019
[2023-09-27 00:16:30 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.2966649830341339
[2023-09-27 00:16:30 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.33682185411453247
[2023-09-27 00:16:30 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.570832371711731
[2023-09-27 00:16:30 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.24553366005420685
[2023-09-27 00:16:30 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.1492687314748764
[2023-09-27 00:16:30 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.10673655569553375
[2023-09-27 00:16:30 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.08148854970932007
[2023-09-27 00:16:30 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.120656818151474
[2023-09-27 00:16:30 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3109962046146393
[2023-09-27 00:16:30 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.34578365087509155
[2023-09-27 00:16:30 iu_test] (trainer.py 168): INFO current best model in: 3
[2023-09-27 00:16:31 iu_test] (trainer.py 174): INFO EPOCH 7 training takes 0:01:27
[2023-09-27 00:17:57 iu_test] (trainer.py 140): INFO 	epoch          : 8
[2023-09-27 00:17:57 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.18907713890075684
[2023-09-27 00:17:57 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.1123068779706955
[2023-09-27 00:17:57 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.07940645515918732
[2023-09-27 00:17:57 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.06079559400677681
[2023-09-27 00:17:57 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.10129893571138382
[2023-09-27 00:17:57 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.29379186034202576
[2023-09-27 00:17:57 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.333942711353302
[2023-09-27 00:17:57 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.5394636392593384
[2023-09-27 00:17:57 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.23163893818855286
[2023-09-27 00:17:57 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.14060145616531372
[2023-09-27 00:17:57 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.10116192698478699
[2023-09-27 00:17:57 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.0777238979935646
[2023-09-27 00:17:57 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.11685232073068619
[2023-09-27 00:17:57 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3112121820449829
[2023-09-27 00:17:57 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.34383901953697205
[2023-09-27 00:17:57 iu_test] (trainer.py 168): INFO current best model in: 3
[2023-09-27 00:17:58 iu_test] (trainer.py 174): INFO EPOCH 8 training takes 0:01:27
[2023-09-27 00:19:25 iu_test] (trainer.py 140): INFO 	epoch          : 9
[2023-09-27 00:19:25 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.21173697710037231
[2023-09-27 00:19:25 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.12449190020561218
[2023-09-27 00:19:25 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.08630826324224472
[2023-09-27 00:19:25 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.06492743641138077
[2023-09-27 00:19:25 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.10528368502855301
[2023-09-27 00:19:25 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.2933959662914276
[2023-09-27 00:19:25 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3003235161304474
[2023-09-27 00:19:25 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.5173976421356201
[2023-09-27 00:19:25 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.2577909231185913
[2023-09-27 00:19:25 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.15954264998435974
[2023-09-27 00:19:25 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.11682841181755066
[2023-09-27 00:19:25 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.09177535772323608
[2023-09-27 00:19:25 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.12425430864095688
[2023-09-27 00:19:25 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3181699514389038
[2023-09-27 00:19:25 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.41138121485710144
[2023-09-27 00:19:25 iu_test] (trainer.py 168): INFO current best model in: 3
[2023-09-27 00:19:26 iu_test] (trainer.py 174): INFO EPOCH 9 training takes 0:01:27
[2023-09-27 00:20:52 iu_test] (trainer.py 140): INFO 	epoch          : 10
[2023-09-27 00:20:52 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.18939125537872314
[2023-09-27 00:20:52 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.11252879351377487
[2023-09-27 00:20:52 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.07954155653715134
[2023-09-27 00:20:52 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.060889214277267456
[2023-09-27 00:20:52 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.10137469321489334
[2023-09-27 00:20:52 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.29384464025497437
[2023-09-27 00:20:52 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.33394303917884827
[2023-09-27 00:20:52 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.516591191291809
[2023-09-27 00:20:52 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.23211286962032318
[2023-09-27 00:20:52 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.14078748226165771
[2023-09-27 00:20:52 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.1012558788061142
[2023-09-27 00:20:52 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.0777955874800682
[2023-09-27 00:20:52 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.1169777661561966
[2023-09-27 00:20:52 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3112120032310486
[2023-09-27 00:20:52 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.34383901953697205
[2023-09-27 00:20:52 iu_test] (trainer.py 168): INFO current best model in: 3
[2023-09-27 00:20:53 iu_test] (trainer.py 174): INFO EPOCH 10 training takes 0:01:26
[2023-09-27 00:22:20 iu_test] (trainer.py 140): INFO 	epoch          : 11
[2023-09-27 00:22:20 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.2662493884563446
[2023-09-27 00:22:20 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.15347006916999817
[2023-09-27 00:22:20 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.10375139117240906
[2023-09-27 00:22:20 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.07604901492595673
[2023-09-27 00:22:20 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.11578090488910675
[2023-09-27 00:22:20 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.29844412207603455
[2023-09-27 00:22:20 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3420603275299072
[2023-09-27 00:22:20 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.5055716037750244
[2023-09-27 00:22:20 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.3047066032886505
[2023-09-27 00:22:20 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.18260535597801208
[2023-09-27 00:22:20 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.1291181892156601
[2023-09-27 00:22:20 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.09752906113862991
[2023-09-27 00:22:20 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.1307034194469452
[2023-09-27 00:22:20 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3186018168926239
[2023-09-27 00:22:20 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.3931882381439209
[2023-09-27 00:22:20 iu_test] (trainer.py 168): INFO current best model in: 3
[2023-09-27 00:22:21 iu_test] (trainer.py 174): INFO EPOCH 11 training takes 0:01:27
[2023-09-27 00:23:47 iu_test] (trainer.py 140): INFO 	epoch          : 12
[2023-09-27 00:23:47 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.27647051215171814
[2023-09-27 00:23:47 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.1596415638923645
[2023-09-27 00:23:47 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.10903320461511612
[2023-09-27 00:23:47 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.08056958019733429
[2023-09-27 00:23:47 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.11795631051063538
[2023-09-27 00:23:47 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.30186691880226135
[2023-09-27 00:23:47 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3494235873222351
[2023-09-27 00:23:47 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.5168554782867432
[2023-09-27 00:23:47 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.3050443232059479
[2023-09-27 00:23:47 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.1826939582824707
[2023-09-27 00:23:47 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.1288377195596695
[2023-09-27 00:23:47 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.09677910059690475
[2023-09-27 00:23:47 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.1285495012998581
[2023-09-27 00:23:47 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.31490352749824524
[2023-09-27 00:23:47 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.3768917918205261
[2023-09-27 00:23:47 iu_test] (trainer.py 168): INFO current best model in: 3
[2023-09-27 00:23:48 iu_test] (trainer.py 174): INFO EPOCH 12 training takes 0:01:27
[2023-09-27 00:25:15 iu_test] (trainer.py 140): INFO 	epoch          : 13
[2023-09-27 00:25:15 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.30817529559135437
[2023-09-27 00:25:15 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.1825781613588333
[2023-09-27 00:25:15 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.12508004903793335
[2023-09-27 00:25:15 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.09185504913330078
[2023-09-27 00:25:15 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.12772345542907715
[2023-09-27 00:25:15 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.30976712703704834
[2023-09-27 00:25:15 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.35744616389274597
[2023-09-27 00:25:15 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.5299592018127441
[2023-09-27 00:25:15 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.33785873651504517
[2023-09-27 00:25:15 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.20809605717658997
[2023-09-27 00:25:15 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.15057094395160675
[2023-09-27 00:25:15 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.11650890111923218
[2023-09-27 00:25:15 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.1405746340751648
[2023-09-27 00:25:15 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.33113598823547363
[2023-09-27 00:25:15 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.4704354703426361
[2023-09-27 00:25:15 iu_test] (trainer.py 168): INFO current best model in: 3
[2023-09-27 00:25:16 iu_test] (trainer.py 174): INFO EPOCH 13 training takes 0:01:27
[2023-09-27 00:29:48 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 00:29:48 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 00:33:03 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 00:33:03 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 00:34:15 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 00:34:15 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 00:34:28 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 00:34:28 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 00:34:57 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 00:34:57 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 00:36:02 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 00:36:02 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 00:36:43 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 00:36:43 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 00:42:59 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 00:42:59 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 00:43:00 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 00:43:10 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 00:43:10 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 00:43:11 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 00:43:36 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 00:43:36 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 00:43:36 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 00:43:56 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 00:43:56 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 00:43:56 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 00:44:11 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 00:44:11 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 00:44:12 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 00:44:26 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 00:44:26 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 00:44:27 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 00:45:28 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 00:45:28 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 00:45:28 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 00:46:57 iu_test] (trainer.py 140): INFO 	epoch          : 1
[2023-09-27 00:46:57 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.0998508632183075
[2023-09-27 00:46:57 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.05694315582513809
[2023-09-27 00:46:57 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.039807043969631195
[2023-09-27 00:46:57 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.029769061133265495
[2023-09-27 00:46:57 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.05361174792051315
[2023-09-27 00:46:57 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.2530914843082428
[2023-09-27 00:46:57 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.07959121465682983
[2023-09-27 00:46:57 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 3.7552249431610107
[2023-09-27 00:46:57 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.12747687101364136
[2023-09-27 00:46:57 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.0746111050248146
[2023-09-27 00:46:57 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.05279557406902313
[2023-09-27 00:46:57 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.03923726826906204
[2023-09-27 00:46:57 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.062420476227998734
[2023-09-27 00:46:57 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.27579426765441895
[2023-09-27 00:46:57 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.08763930201530457
[2023-09-27 00:46:57 iu_test] (trainer.py 168): INFO current best model in: 1
[2023-09-27 00:47:00 iu_test] (trainer.py 174): INFO EPOCH 1 training takes 0:01:31
[2023-09-27 00:48:25 iu_test] (trainer.py 140): INFO 	epoch          : 2
[2023-09-27 00:48:25 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.31088483333587646
[2023-09-27 00:48:25 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2048460841178894
[2023-09-27 00:48:25 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.14559568464756012
[2023-09-27 00:48:25 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.1097278967499733
[2023-09-27 00:48:25 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.1463889181613922
[2023-09-27 00:48:25 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.35282212495803833
[2023-09-27 00:48:25 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.32054415345191956
[2023-09-27 00:48:25 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.5559303760528564
[2023-09-27 00:48:25 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.36189624667167664
[2023-09-27 00:48:25 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2398417443037033
[2023-09-27 00:48:25 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.17193067073822021
[2023-09-27 00:48:25 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.13011769950389862
[2023-09-27 00:48:25 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16276387870311737
[2023-09-27 00:48:25 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3700419068336487
[2023-09-27 00:48:25 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.37922096252441406
[2023-09-27 00:48:25 iu_test] (trainer.py 168): INFO current best model in: 2
[2023-09-27 00:48:27 iu_test] (trainer.py 174): INFO EPOCH 2 training takes 0:01:27
[2023-09-27 00:49:53 iu_test] (trainer.py 140): INFO 	epoch          : 3
[2023-09-27 00:49:53 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.3261716663837433
[2023-09-27 00:49:53 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2144891768693924
[2023-09-27 00:49:53 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.15199482440948486
[2023-09-27 00:49:53 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.11429591476917267
[2023-09-27 00:49:53 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.14861665666103363
[2023-09-27 00:49:53 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.35517147183418274
[2023-09-27 00:49:53 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.33445754647254944
[2023-09-27 00:49:53 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.10860538482666
[2023-09-27 00:49:53 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.37519943714141846
[2023-09-27 00:49:53 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.24831092357635498
[2023-09-27 00:49:53 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.17790721356868744
[2023-09-27 00:49:53 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.13445931673049927
[2023-09-27 00:49:53 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16518335044384003
[2023-09-27 00:49:53 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3737305998802185
[2023-09-27 00:49:53 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.39949196577072144
[2023-09-27 00:49:53 iu_test] (trainer.py 168): INFO current best model in: 3
[2023-09-27 00:49:55 iu_test] (trainer.py 174): INFO EPOCH 3 training takes 0:01:27
[2023-09-27 00:51:22 iu_test] (trainer.py 140): INFO 	epoch          : 4
[2023-09-27 00:51:22 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.22847966849803925
[2023-09-27 00:51:22 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.13758036494255066
[2023-09-27 00:51:22 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.09541063010692596
[2023-09-27 00:51:22 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.07166126370429993
[2023-09-27 00:51:22 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.11437591165304184
[2023-09-27 00:51:22 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3014432489871979
[2023-09-27 00:51:22 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3409772515296936
[2023-09-27 00:51:22 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.8619767427444458
[2023-09-27 00:51:22 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.27317723631858826
[2023-09-27 00:51:22 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.16493669152259827
[2023-09-27 00:51:22 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.11611098796129227
[2023-09-27 00:51:22 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.08748423308134079
[2023-09-27 00:51:22 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.12849128246307373
[2023-09-27 00:51:22 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3180129826068878
[2023-09-27 00:51:22 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.35639581084251404
[2023-09-27 00:51:22 iu_test] (trainer.py 168): INFO current best model in: 3
[2023-09-27 00:51:23 iu_test] (trainer.py 174): INFO EPOCH 4 training takes 0:01:27
[2023-09-27 00:52:49 iu_test] (trainer.py 140): INFO 	epoch          : 5
[2023-09-27 00:52:49 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.18907713890075684
[2023-09-27 00:52:49 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.1123068779706955
[2023-09-27 00:52:49 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.07940645515918732
[2023-09-27 00:52:49 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.06079559400677681
[2023-09-27 00:52:49 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.10129893571138382
[2023-09-27 00:52:49 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.29379186034202576
[2023-09-27 00:52:49 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.333942711353302
[2023-09-27 00:52:49 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.7292520999908447
[2023-09-27 00:52:49 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.23163893818855286
[2023-09-27 00:52:49 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.14060145616531372
[2023-09-27 00:52:49 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.10116192698478699
[2023-09-27 00:52:49 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.0777238979935646
[2023-09-27 00:52:49 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.11685232073068619
[2023-09-27 00:52:49 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3112121820449829
[2023-09-27 00:52:49 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.34383901953697205
[2023-09-27 00:52:49 iu_test] (trainer.py 168): INFO current best model in: 3
[2023-09-27 00:52:50 iu_test] (trainer.py 174): INFO EPOCH 5 training takes 0:01:26
[2023-09-27 01:01:29 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 01:01:29 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 01:01:30 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 01:02:56 iu_test] (trainer.py 140): INFO 	epoch          : 1
[2023-09-27 01:02:56 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.0998508632183075
[2023-09-27 01:02:56 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.05694315582513809
[2023-09-27 01:02:56 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.039807043969631195
[2023-09-27 01:02:56 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.029769061133265495
[2023-09-27 01:02:56 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.05361174792051315
[2023-09-27 01:02:56 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.2530914843082428
[2023-09-27 01:02:56 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.07959121465682983
[2023-09-27 01:02:56 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 3.7552249431610107
[2023-09-27 01:02:56 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.12747687101364136
[2023-09-27 01:02:56 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.0746111050248146
[2023-09-27 01:02:56 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.05279557406902313
[2023-09-27 01:02:56 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.03923726826906204
[2023-09-27 01:02:56 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.062420476227998734
[2023-09-27 01:02:56 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.27579426765441895
[2023-09-27 01:02:56 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.08763930201530457
[2023-09-27 01:02:56 iu_test] (trainer.py 168): INFO current best model in: 1
[2023-09-27 01:02:58 iu_test] (trainer.py 174): INFO EPOCH 1 training takes 0:01:28
[2023-09-27 01:04:23 iu_test] (trainer.py 140): INFO 	epoch          : 2
[2023-09-27 01:04:23 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.31088483333587646
[2023-09-27 01:04:23 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2048460841178894
[2023-09-27 01:04:23 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.14559568464756012
[2023-09-27 01:04:23 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.1097278967499733
[2023-09-27 01:04:23 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.1463889181613922
[2023-09-27 01:04:23 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.35282212495803833
[2023-09-27 01:04:23 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.32054415345191956
[2023-09-27 01:04:23 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.5559303760528564
[2023-09-27 01:04:23 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.36189624667167664
[2023-09-27 01:04:23 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2398417443037033
[2023-09-27 01:04:23 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.17193067073822021
[2023-09-27 01:04:23 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.13011769950389862
[2023-09-27 01:04:23 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16276387870311737
[2023-09-27 01:04:23 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3700419068336487
[2023-09-27 01:04:23 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.37922096252441406
[2023-09-27 01:04:23 iu_test] (trainer.py 168): INFO current best model in: 2
[2023-09-27 01:04:25 iu_test] (trainer.py 174): INFO EPOCH 2 training takes 0:01:26
[2023-09-27 01:05:50 iu_test] (trainer.py 140): INFO 	epoch          : 3
[2023-09-27 01:05:50 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.3261716663837433
[2023-09-27 01:05:50 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2144891768693924
[2023-09-27 01:05:50 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.15199482440948486
[2023-09-27 01:05:50 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.11429591476917267
[2023-09-27 01:05:50 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.14861665666103363
[2023-09-27 01:05:50 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.35517147183418274
[2023-09-27 01:05:50 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.33445754647254944
[2023-09-27 01:05:50 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.10860538482666
[2023-09-27 01:05:50 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.37519943714141846
[2023-09-27 01:05:50 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.24831092357635498
[2023-09-27 01:05:50 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.17790721356868744
[2023-09-27 01:05:50 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.13445931673049927
[2023-09-27 01:05:50 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16518335044384003
[2023-09-27 01:05:50 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3737305998802185
[2023-09-27 01:05:50 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.39949196577072144
[2023-09-27 01:05:50 iu_test] (trainer.py 168): INFO current best model in: 3
[2023-09-27 01:05:52 iu_test] (trainer.py 174): INFO EPOCH 3 training takes 0:01:27
[2023-09-27 01:07:18 iu_test] (trainer.py 140): INFO 	epoch          : 4
[2023-09-27 01:07:18 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.22847966849803925
[2023-09-27 01:07:18 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.13758036494255066
[2023-09-27 01:07:18 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.09541063010692596
[2023-09-27 01:07:18 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.07166126370429993
[2023-09-27 01:07:18 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.11437591165304184
[2023-09-27 01:07:18 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3014432489871979
[2023-09-27 01:07:18 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3409772515296936
[2023-09-27 01:07:18 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.8619767427444458
[2023-09-27 01:07:18 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.27317723631858826
[2023-09-27 01:07:18 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.16493669152259827
[2023-09-27 01:07:18 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.11611098796129227
[2023-09-27 01:07:18 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.08748423308134079
[2023-09-27 01:07:18 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.12849128246307373
[2023-09-27 01:07:18 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3180129826068878
[2023-09-27 01:07:18 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.35639581084251404
[2023-09-27 01:07:18 iu_test] (trainer.py 168): INFO current best model in: 3
[2023-09-27 01:07:19 iu_test] (trainer.py 174): INFO EPOCH 4 training takes 0:01:26
[2023-09-27 01:07:30 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 01:07:30 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 01:07:30 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 01:08:56 iu_test] (trainer.py 140): INFO 	epoch          : 1
[2023-09-27 01:08:56 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.26786208152770996
[2023-09-27 01:08:56 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.17274639010429382
[2023-09-27 01:08:56 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.11758774518966675
[2023-09-27 01:08:56 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.08502648025751114
[2023-09-27 01:08:56 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.1397796869277954
[2023-09-27 01:08:56 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3408873379230499
[2023-09-27 01:08:56 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.20454344153404236
[2023-09-27 01:08:56 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.502134084701538
[2023-09-27 01:08:56 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.312627911567688
[2023-09-27 01:08:56 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.19949553906917572
[2023-09-27 01:08:56 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.13605773448944092
[2023-09-27 01:08:56 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.09895356744527817
[2023-09-27 01:08:56 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.1540026217699051
[2023-09-27 01:08:56 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3459078371524811
[2023-09-27 01:08:56 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.27944937348365784
[2023-09-27 01:08:56 iu_test] (trainer.py 168): INFO current best model in: 1
[2023-09-27 01:08:58 iu_test] (trainer.py 174): INFO EPOCH 1 training takes 0:01:27
[2023-09-27 01:10:07 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 01:10:07 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 01:10:07 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 01:11:34 iu_test] (trainer.py 140): INFO 	epoch          : 1
[2023-09-27 01:11:34 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.1117500513792038
[2023-09-27 01:11:34 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.0633891373872757
[2023-09-27 01:11:34 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.04417426511645317
[2023-09-27 01:11:34 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.03296046331524849
[2023-09-27 01:11:34 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.05517017841339111
[2023-09-27 01:11:34 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.2565532922744751
[2023-09-27 01:11:34 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.08183019608259201
[2023-09-27 01:11:34 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 3.750555992126465
[2023-09-27 01:11:34 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.14047162234783173
[2023-09-27 01:11:34 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.0814814418554306
[2023-09-27 01:11:34 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.0574202723801136
[2023-09-27 01:11:34 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.04254942387342453
[2023-09-27 01:11:34 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.0643947571516037
[2023-09-27 01:11:34 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.2792569398880005
[2023-09-27 01:11:34 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.08975525200366974
[2023-09-27 01:11:34 iu_test] (trainer.py 168): INFO current best model in: 1
[2023-09-27 01:11:36 iu_test] (trainer.py 174): INFO EPOCH 1 training takes 0:01:28
[2023-09-27 01:12:36 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 01:12:36 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 01:12:37 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 01:12:53 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 01:12:53 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 01:12:54 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 01:14:20 iu_test] (trainer.py 140): INFO 	epoch          : 1
[2023-09-27 01:14:20 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.1117500513792038
[2023-09-27 01:14:20 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.0633891373872757
[2023-09-27 01:14:20 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.04417426511645317
[2023-09-27 01:14:20 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.03296046331524849
[2023-09-27 01:14:20 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.05517017841339111
[2023-09-27 01:14:20 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.2565532922744751
[2023-09-27 01:14:20 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.08183019608259201
[2023-09-27 01:14:20 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 3.750555992126465
[2023-09-27 01:14:20 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.14047162234783173
[2023-09-27 01:14:20 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.0814814418554306
[2023-09-27 01:14:20 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.0574202723801136
[2023-09-27 01:14:20 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.04254942387342453
[2023-09-27 01:14:20 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.0643947571516037
[2023-09-27 01:14:20 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.2792569398880005
[2023-09-27 01:14:20 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.08975525200366974
[2023-09-27 01:14:20 iu_test] (trainer.py 168): INFO current best model in: 1
[2023-09-27 01:14:22 iu_test] (trainer.py 174): INFO EPOCH 1 training takes 0:01:28
[2023-09-27 01:15:47 iu_test] (trainer.py 140): INFO 	epoch          : 2
[2023-09-27 01:15:47 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.32543206214904785
[2023-09-27 01:15:47 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.21341681480407715
[2023-09-27 01:15:47 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.1513892114162445
[2023-09-27 01:15:47 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.11405528336763382
[2023-09-27 01:15:47 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.14950904250144958
[2023-09-27 01:15:47 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.35689741373062134
[2023-09-27 01:15:47 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.32177090644836426
[2023-09-27 01:15:47 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.5536506175994873
[2023-09-27 01:15:47 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.3773341178894043
[2023-09-27 01:15:47 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.24799713492393494
[2023-09-27 01:15:47 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.1762082874774933
[2023-09-27 01:15:47 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.13262219727039337
[2023-09-27 01:15:47 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.1661050021648407
[2023-09-27 01:15:47 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3715931177139282
[2023-09-27 01:15:47 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.3690197765827179
[2023-09-27 01:15:47 iu_test] (trainer.py 168): INFO current best model in: 2
[2023-09-27 01:15:49 iu_test] (trainer.py 174): INFO EPOCH 2 training takes 0:01:27
[2023-09-27 01:17:13 iu_test] (trainer.py 140): INFO 	epoch          : 3
[2023-09-27 01:17:13 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.34384167194366455
[2023-09-27 01:17:13 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.23994603753089905
[2023-09-27 01:17:13 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.17346860468387604
[2023-09-27 01:17:13 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.1308828890323639
[2023-09-27 01:17:13 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.16827285289764404
[2023-09-27 01:17:13 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.36971965432167053
[2023-09-27 01:17:13 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.2756890058517456
[2023-09-27 01:17:13 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 2.1119384765625
[2023-09-27 01:17:13 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.3929656445980072
[2023-09-27 01:17:13 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2766995131969452
[2023-09-27 01:17:13 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.20280222594738007
[2023-09-27 01:17:13 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.15486489236354828
[2023-09-27 01:17:13 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.18785005807876587
[2023-09-27 01:17:13 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.39211198687553406
[2023-09-27 01:17:13 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.38621073961257935
[2023-09-27 01:17:13 iu_test] (trainer.py 168): INFO current best model in: 3
[2023-09-27 01:17:15 iu_test] (trainer.py 174): INFO EPOCH 3 training takes 0:01:25
[2023-09-27 01:18:40 iu_test] (trainer.py 140): INFO 	epoch          : 4
[2023-09-27 01:18:40 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.4769466519355774
[2023-09-27 01:18:40 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.3070942759513855
[2023-09-27 01:18:40 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.20815469324588776
[2023-09-27 01:18:40 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.14881886541843414
[2023-09-27 01:18:40 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.19328153133392334
[2023-09-27 01:18:40 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3641507923603058
[2023-09-27 01:18:40 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3219425082206726
[2023-09-27 01:18:40 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.863125205039978
[2023-09-27 01:18:40 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4989164173603058
[2023-09-27 01:18:40 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.322539359331131
[2023-09-27 01:18:40 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.22207339107990265
[2023-09-27 01:18:40 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.16252896189689636
[2023-09-27 01:18:40 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.21090374886989594
[2023-09-27 01:18:40 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.38119348883628845
[2023-09-27 01:18:40 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.40977567434310913
[2023-09-27 01:18:40 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-27 01:18:42 iu_test] (trainer.py 174): INFO EPOCH 4 training takes 0:01:26
[2023-09-27 01:20:07 iu_test] (trainer.py 140): INFO 	epoch          : 5
[2023-09-27 01:20:07 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.2733844518661499
[2023-09-27 01:20:07 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.14193563163280487
[2023-09-27 01:20:07 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.08301908522844315
[2023-09-27 01:20:07 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.05339279770851135
[2023-09-27 01:20:07 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.11873957514762878
[2023-09-27 01:20:07 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.297804594039917
[2023-09-27 01:20:07 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.2023402601480484
[2023-09-27 01:20:07 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.7173007726669312
[2023-09-27 01:20:07 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.31685468554496765
[2023-09-27 01:20:07 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.17386473715305328
[2023-09-27 01:20:07 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.10947026312351227
[2023-09-27 01:20:07 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.07594650238752365
[2023-09-27 01:20:07 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.13473306596279144
[2023-09-27 01:20:07 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3210718631744385
[2023-09-27 01:20:07 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.35282883048057556
[2023-09-27 01:20:07 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-27 01:20:08 iu_test] (trainer.py 174): INFO EPOCH 5 training takes 0:01:25
[2023-09-27 01:21:33 iu_test] (trainer.py 140): INFO 	epoch          : 6
[2023-09-27 01:21:33 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.21237145364284515
[2023-09-27 01:21:33 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.13221581280231476
[2023-09-27 01:21:33 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.09414531290531158
[2023-09-27 01:21:33 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.07144026458263397
[2023-09-27 01:21:33 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.11728615313768387
[2023-09-27 01:21:33 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.31272414326667786
[2023-09-27 01:21:33 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3168726861476898
[2023-09-27 01:21:33 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.6336877346038818
[2023-09-27 01:21:33 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.25605374574661255
[2023-09-27 01:21:33 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.16014322638511658
[2023-09-27 01:21:33 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.1134776771068573
[2023-09-27 01:21:33 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.08507604151964188
[2023-09-27 01:21:33 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.13172301650047302
[2023-09-27 01:21:33 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.322723388671875
[2023-09-27 01:21:33 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.24640415608882904
[2023-09-27 01:21:33 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-27 01:21:33 iu_test] (trainer.py 174): INFO EPOCH 6 training takes 0:01:25
[2023-09-27 01:22:59 iu_test] (trainer.py 140): INFO 	epoch          : 7
[2023-09-27 01:22:59 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 01:22:59 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 01:22:59 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 01:22:59 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 01:22:59 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 01:22:59 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 01:22:59 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 01:22:59 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.5908787250518799
[2023-09-27 01:22:59 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 01:22:59 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 01:22:59 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 01:22:59 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 01:22:59 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 01:22:59 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 01:22:59 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 01:22:59 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-27 01:23:00 iu_test] (trainer.py 174): INFO EPOCH 7 training takes 0:01:26
[2023-09-27 01:24:28 iu_test] (trainer.py 140): INFO 	epoch          : 8
[2023-09-27 01:24:28 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 01:24:28 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 01:24:28 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 01:24:28 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 01:24:28 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 01:24:28 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 01:24:28 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 01:24:28 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.546852707862854
[2023-09-27 01:24:28 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 01:24:28 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 01:24:28 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 01:24:28 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 01:24:28 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 01:24:28 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 01:24:28 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 01:24:28 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-27 01:24:29 iu_test] (trainer.py 174): INFO EPOCH 8 training takes 0:01:28
[2023-09-27 01:25:55 iu_test] (trainer.py 140): INFO 	epoch          : 9
[2023-09-27 01:25:55 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.20140621066093445
[2023-09-27 01:25:55 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.11879293620586395
[2023-09-27 01:25:55 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.08352222293615341
[2023-09-27 01:25:55 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.06349898129701614
[2023-09-27 01:25:55 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.10349228233098984
[2023-09-27 01:25:55 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.2940300703048706
[2023-09-27 01:25:55 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3334653079509735
[2023-09-27 01:25:55 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.5307658910751343
[2023-09-27 01:25:55 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.24456869065761566
[2023-09-27 01:25:55 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.1480168253183365
[2023-09-27 01:25:55 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.1062462329864502
[2023-09-27 01:25:55 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.08143340051174164
[2023-09-27 01:25:55 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.12013988196849823
[2023-09-27 01:25:55 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.31182989478111267
[2023-09-27 01:25:55 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.34499266743659973
[2023-09-27 01:25:55 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-27 01:25:56 iu_test] (trainer.py 174): INFO EPOCH 9 training takes 0:01:27
[2023-09-27 01:27:20 iu_test] (trainer.py 140): INFO 	epoch          : 10
[2023-09-27 01:27:20 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.3605298697948456
[2023-09-27 01:27:20 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.21876119077205658
[2023-09-27 01:27:20 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.15076236426830292
[2023-09-27 01:27:20 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.11172409355640411
[2023-09-27 01:27:20 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.14500130712985992
[2023-09-27 01:27:20 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.31924429535865784
[2023-09-27 01:27:20 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.4070349931716919
[2023-09-27 01:27:20 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.5127283334732056
[2023-09-27 01:27:20 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.39684468507766724
[2023-09-27 01:27:20 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.24966779351234436
[2023-09-27 01:27:20 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.180384561419487
[2023-09-27 01:27:20 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.13916225731372833
[2023-09-27 01:27:20 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16161267459392548
[2023-09-27 01:27:20 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.341631144285202
[2023-09-27 01:27:20 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.49768438935279846
[2023-09-27 01:27:20 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-27 01:27:21 iu_test] (trainer.py 174): INFO EPOCH 10 training takes 0:01:24
[2023-09-27 01:28:46 iu_test] (trainer.py 140): INFO 	epoch          : 11
[2023-09-27 01:28:46 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.21818415820598602
[2023-09-27 01:28:46 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.12943416833877563
[2023-09-27 01:28:46 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.09058059751987457
[2023-09-27 01:28:46 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.06856940686702728
[2023-09-27 01:28:46 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.10720691084861755
[2023-09-27 01:28:46 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.29453983902931213
[2023-09-27 01:28:46 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3335328698158264
[2023-09-27 01:28:46 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.5212626457214355
[2023-09-27 01:28:46 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.25811851024627686
[2023-09-27 01:28:46 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.15814770758152008
[2023-09-27 01:28:46 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.11361921578645706
[2023-09-27 01:28:46 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.08725664019584656
[2023-09-27 01:28:46 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.1235540360212326
[2023-09-27 01:28:46 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3146172761917114
[2023-09-27 01:28:46 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.37696555256843567
[2023-09-27 01:28:46 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-27 01:28:47 iu_test] (trainer.py 174): INFO EPOCH 11 training takes 0:01:25
[2023-09-27 01:30:11 iu_test] (trainer.py 140): INFO 	epoch          : 12
[2023-09-27 01:30:11 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.42875245213508606
[2023-09-27 01:30:11 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.2685283124446869
[2023-09-27 01:30:11 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.1852114498615265
[2023-09-27 01:30:11 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.1366615742444992
[2023-09-27 01:30:11 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.17445692420005798
[2023-09-27 01:30:11 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3426089286804199
[2023-09-27 01:30:11 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.30852997303009033
[2023-09-27 01:30:11 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.5152842998504639
[2023-09-27 01:30:11 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4745989441871643
[2023-09-27 01:30:11 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.30667561292648315
[2023-09-27 01:30:11 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.22057263553142548
[2023-09-27 01:30:11 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.1698349416255951
[2023-09-27 01:30:11 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.19408196210861206
[2023-09-27 01:30:11 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.37080612778663635
[2023-09-27 01:30:11 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.5919452905654907
[2023-09-27 01:30:11 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-27 01:30:13 iu_test] (trainer.py 174): INFO EPOCH 12 training takes 0:01:25
[2023-09-27 01:31:37 iu_test] (trainer.py 140): INFO 	epoch          : 13
[2023-09-27 01:31:37 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.37193480134010315
[2023-09-27 01:31:37 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.22747668623924255
[2023-09-27 01:31:37 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.15321916341781616
[2023-09-27 01:31:37 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.1087557002902031
[2023-09-27 01:31:37 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.150712788105011
[2023-09-27 01:31:37 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.32338812947273254
[2023-09-27 01:31:37 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.34161797165870667
[2023-09-27 01:31:37 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.526273488998413
[2023-09-27 01:31:37 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.40089091658592224
[2023-09-27 01:31:37 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.24878081679344177
[2023-09-27 01:31:37 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.17517419159412384
[2023-09-27 01:31:37 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.13103535771369934
[2023-09-27 01:31:37 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16183723509311676
[2023-09-27 01:31:37 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.3358815312385559
[2023-09-27 01:31:37 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.42097774147987366
[2023-09-27 01:31:37 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-27 01:31:38 iu_test] (trainer.py 174): INFO EPOCH 13 training takes 0:01:25
[2023-09-27 01:33:03 iu_test] (trainer.py 140): INFO 	epoch          : 14
[2023-09-27 01:33:03 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.39669284224510193
[2023-09-27 01:33:03 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.21733778715133667
[2023-09-27 01:33:03 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.1388777792453766
[2023-09-27 01:33:03 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.09702173620462418
[2023-09-27 01:33:03 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.14773046970367432
[2023-09-27 01:33:03 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3110206723213196
[2023-09-27 01:33:03 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.3070557117462158
[2023-09-27 01:33:03 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.5399562120437622
[2023-09-27 01:33:03 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.44359222054481506
[2023-09-27 01:33:03 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2658458352088928
[2023-09-27 01:33:03 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.18747642636299133
[2023-09-27 01:33:03 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.14251208305358887
[2023-09-27 01:33:03 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.17150074243545532
[2023-09-27 01:33:03 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.34668055176734924
[2023-09-27 01:33:03 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.5771384239196777
[2023-09-27 01:33:03 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-27 01:33:04 iu_test] (trainer.py 174): INFO EPOCH 14 training takes 0:01:26
[2023-09-27 01:34:28 iu_test] (trainer.py 140): INFO 	epoch          : 15
[2023-09-27 01:34:28 iu_test] (trainer.py 140): INFO 	val_BLEU_1     : 0.3809863328933716
[2023-09-27 01:34:28 iu_test] (trainer.py 140): INFO 	val_BLEU_2     : 0.22103166580200195
[2023-09-27 01:34:28 iu_test] (trainer.py 140): INFO 	val_BLEU_3     : 0.14497289061546326
[2023-09-27 01:34:28 iu_test] (trainer.py 140): INFO 	val_BLEU_4     : 0.10284078866243362
[2023-09-27 01:34:28 iu_test] (trainer.py 140): INFO 	val_METEOR     : 0.15088385343551636
[2023-09-27 01:34:28 iu_test] (trainer.py 140): INFO 	val_ROUGE_L    : 0.3223758339881897
[2023-09-27 01:34:28 iu_test] (trainer.py 140): INFO 	val_Cider      : 0.34788569808006287
[2023-09-27 01:34:28 iu_test] (trainer.py 140): INFO 	val_ce_loss    : 1.5639599561691284
[2023-09-27 01:34:28 iu_test] (trainer.py 140): INFO 	test_BLEU_1    : 0.4128875136375427
[2023-09-27 01:34:28 iu_test] (trainer.py 140): INFO 	test_BLEU_2    : 0.2547922134399414
[2023-09-27 01:34:28 iu_test] (trainer.py 140): INFO 	test_BLEU_3    : 0.17886564135551453
[2023-09-27 01:34:28 iu_test] (trainer.py 140): INFO 	test_BLEU_4    : 0.13466250896453857
[2023-09-27 01:34:28 iu_test] (trainer.py 140): INFO 	test_METEOR    : 0.16685034334659576
[2023-09-27 01:34:28 iu_test] (trainer.py 140): INFO 	test_ROUGE_L   : 0.341562956571579
[2023-09-27 01:34:28 iu_test] (trainer.py 140): INFO 	test_Cider     : 0.47250956296920776
[2023-09-27 01:34:28 iu_test] (trainer.py 168): INFO current best model in: 4
[2023-09-27 01:34:29 iu_test] (trainer.py 174): INFO EPOCH 15 training takes 0:01:24
[2023-09-27 13:43:51 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 13:43:51 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 13:43:51 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 13:44:56 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 13:44:56 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 13:44:56 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 13:49:41 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 13:49:41 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 13:49:41 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 13:50:08 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 13:50:08 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 13:50:09 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 13:50:38 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 13:50:38 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 13:50:38 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 13:50:58 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 13:50:58 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 13:50:58 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 13:56:22 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 13:56:22 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 13:56:23 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 14:05:00 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 14:05:00 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 14:05:01 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 14:05:39 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 14:05:39 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 14:05:40 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 14:21:28 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 14:21:28 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 14:21:29 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 14:22:12 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 14:22:12 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 14:22:13 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 14:22:24 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 14:22:24 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 14:22:25 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 14:22:37 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 14:22:37 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 14:22:38 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 14:27:56 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 14:27:56 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 14:27:57 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 14:28:18 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 14:28:18 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 14:28:19 iu_test] (main.py 115): INFO number of params: 56954169
[2023-09-27 14:29:48 iu_test] (trainer.py 136): INFO 	epoch          : 1
[2023-09-27 14:29:48 iu_test] (trainer.py 136): INFO 	val_BLEU_1     : 0.1117500513792038
[2023-09-27 14:29:48 iu_test] (trainer.py 136): INFO 	val_BLEU_2     : 0.0633891373872757
[2023-09-27 14:29:48 iu_test] (trainer.py 136): INFO 	val_BLEU_3     : 0.04417426511645317
[2023-09-27 14:29:48 iu_test] (trainer.py 136): INFO 	val_BLEU_4     : 0.03296046331524849
[2023-09-27 14:29:48 iu_test] (trainer.py 136): INFO 	val_METEOR     : 0.05517017841339111
[2023-09-27 14:29:48 iu_test] (trainer.py 136): INFO 	val_ROUGE_L    : 0.2565532922744751
[2023-09-27 14:29:48 iu_test] (trainer.py 136): INFO 	val_Cider      : 0.08183019608259201
[2023-09-27 14:29:48 iu_test] (trainer.py 136): INFO 	val_ce_loss    : 3.750555992126465
[2023-09-27 14:29:48 iu_test] (trainer.py 136): INFO 	test_BLEU_1    : 0.14047162234783173
[2023-09-27 14:29:48 iu_test] (trainer.py 136): INFO 	test_BLEU_2    : 0.0814814418554306
[2023-09-27 14:29:48 iu_test] (trainer.py 136): INFO 	test_BLEU_3    : 0.0574202723801136
[2023-09-27 14:29:48 iu_test] (trainer.py 136): INFO 	test_BLEU_4    : 0.04254942387342453
[2023-09-27 14:29:48 iu_test] (trainer.py 136): INFO 	test_METEOR    : 0.0643947571516037
[2023-09-27 14:29:48 iu_test] (trainer.py 136): INFO 	test_ROUGE_L   : 0.2792569398880005
[2023-09-27 14:29:48 iu_test] (trainer.py 136): INFO 	test_Cider     : 0.08975525200366974
[2023-09-27 14:29:48 iu_test] (trainer.py 164): INFO current best model in: 1
[2023-09-27 14:29:50 iu_test] (trainer.py 170): INFO EPOCH 1 training takes 0:01:31
[2023-09-27 14:31:16 iu_test] (trainer.py 136): INFO 	epoch          : 2
[2023-09-27 14:31:16 iu_test] (trainer.py 136): INFO 	val_BLEU_1     : 0.32543206214904785
[2023-09-27 14:31:16 iu_test] (trainer.py 136): INFO 	val_BLEU_2     : 0.21341681480407715
[2023-09-27 14:31:16 iu_test] (trainer.py 136): INFO 	val_BLEU_3     : 0.1513892114162445
[2023-09-27 14:31:16 iu_test] (trainer.py 136): INFO 	val_BLEU_4     : 0.11405528336763382
[2023-09-27 14:31:16 iu_test] (trainer.py 136): INFO 	val_METEOR     : 0.14950904250144958
[2023-09-27 14:31:16 iu_test] (trainer.py 136): INFO 	val_ROUGE_L    : 0.35689741373062134
[2023-09-27 14:31:16 iu_test] (trainer.py 136): INFO 	val_Cider      : 0.32177090644836426
[2023-09-27 14:31:16 iu_test] (trainer.py 136): INFO 	val_ce_loss    : 2.5536506175994873
[2023-09-27 14:31:16 iu_test] (trainer.py 136): INFO 	test_BLEU_1    : 0.3773341178894043
[2023-09-27 14:31:16 iu_test] (trainer.py 136): INFO 	test_BLEU_2    : 0.24799713492393494
[2023-09-27 14:31:16 iu_test] (trainer.py 136): INFO 	test_BLEU_3    : 0.1762082874774933
[2023-09-27 14:31:16 iu_test] (trainer.py 136): INFO 	test_BLEU_4    : 0.13262219727039337
[2023-09-27 14:31:16 iu_test] (trainer.py 136): INFO 	test_METEOR    : 0.1661050021648407
[2023-09-27 14:31:16 iu_test] (trainer.py 136): INFO 	test_ROUGE_L   : 0.3715931177139282
[2023-09-27 14:31:16 iu_test] (trainer.py 136): INFO 	test_Cider     : 0.3690197765827179
[2023-09-27 14:31:16 iu_test] (trainer.py 164): INFO current best model in: 2
[2023-09-27 14:31:19 iu_test] (trainer.py 170): INFO EPOCH 2 training takes 0:01:28
[2023-09-27 14:32:42 iu_test] (trainer.py 136): INFO 	epoch          : 3
[2023-09-27 14:32:42 iu_test] (trainer.py 136): INFO 	val_BLEU_1     : 0.34384167194366455
[2023-09-27 14:32:42 iu_test] (trainer.py 136): INFO 	val_BLEU_2     : 0.23994603753089905
[2023-09-27 14:32:42 iu_test] (trainer.py 136): INFO 	val_BLEU_3     : 0.17346860468387604
[2023-09-27 14:32:42 iu_test] (trainer.py 136): INFO 	val_BLEU_4     : 0.1308828890323639
[2023-09-27 14:32:42 iu_test] (trainer.py 136): INFO 	val_METEOR     : 0.16827285289764404
[2023-09-27 14:32:42 iu_test] (trainer.py 136): INFO 	val_ROUGE_L    : 0.36971965432167053
[2023-09-27 14:32:42 iu_test] (trainer.py 136): INFO 	val_Cider      : 0.2756890058517456
[2023-09-27 14:32:42 iu_test] (trainer.py 136): INFO 	val_ce_loss    : 2.1119384765625
[2023-09-27 14:32:42 iu_test] (trainer.py 136): INFO 	test_BLEU_1    : 0.3929656445980072
[2023-09-27 14:32:42 iu_test] (trainer.py 136): INFO 	test_BLEU_2    : 0.2766995131969452
[2023-09-27 14:32:42 iu_test] (trainer.py 136): INFO 	test_BLEU_3    : 0.20280222594738007
[2023-09-27 14:32:42 iu_test] (trainer.py 136): INFO 	test_BLEU_4    : 0.15486489236354828
[2023-09-27 14:32:42 iu_test] (trainer.py 136): INFO 	test_METEOR    : 0.18785005807876587
[2023-09-27 14:32:42 iu_test] (trainer.py 136): INFO 	test_ROUGE_L   : 0.39211198687553406
[2023-09-27 14:32:42 iu_test] (trainer.py 136): INFO 	test_Cider     : 0.38621073961257935
[2023-09-27 14:32:42 iu_test] (trainer.py 164): INFO current best model in: 3
[2023-09-27 14:32:44 iu_test] (trainer.py 170): INFO EPOCH 3 training takes 0:01:25
[2023-09-27 14:34:10 iu_test] (trainer.py 136): INFO 	epoch          : 4
[2023-09-27 14:34:10 iu_test] (trainer.py 136): INFO 	val_BLEU_1     : 0.4769466519355774
[2023-09-27 14:34:10 iu_test] (trainer.py 136): INFO 	val_BLEU_2     : 0.3070942759513855
[2023-09-27 14:34:10 iu_test] (trainer.py 136): INFO 	val_BLEU_3     : 0.20815469324588776
[2023-09-27 14:34:10 iu_test] (trainer.py 136): INFO 	val_BLEU_4     : 0.14881886541843414
[2023-09-27 14:34:10 iu_test] (trainer.py 136): INFO 	val_METEOR     : 0.19328153133392334
[2023-09-27 14:34:10 iu_test] (trainer.py 136): INFO 	val_ROUGE_L    : 0.3641507923603058
[2023-09-27 14:34:10 iu_test] (trainer.py 136): INFO 	val_Cider      : 0.3219425082206726
[2023-09-27 14:34:10 iu_test] (trainer.py 136): INFO 	val_ce_loss    : 1.863125205039978
[2023-09-27 14:34:10 iu_test] (trainer.py 136): INFO 	test_BLEU_1    : 0.4989164173603058
[2023-09-27 14:34:10 iu_test] (trainer.py 136): INFO 	test_BLEU_2    : 0.322539359331131
[2023-09-27 14:34:10 iu_test] (trainer.py 136): INFO 	test_BLEU_3    : 0.22207339107990265
[2023-09-27 14:34:10 iu_test] (trainer.py 136): INFO 	test_BLEU_4    : 0.16252896189689636
[2023-09-27 14:34:10 iu_test] (trainer.py 136): INFO 	test_METEOR    : 0.21090374886989594
[2023-09-27 14:34:10 iu_test] (trainer.py 136): INFO 	test_ROUGE_L   : 0.38119348883628845
[2023-09-27 14:34:10 iu_test] (trainer.py 136): INFO 	test_Cider     : 0.40977567434310913
[2023-09-27 14:34:10 iu_test] (trainer.py 164): INFO current best model in: 4
[2023-09-27 14:34:12 iu_test] (trainer.py 170): INFO EPOCH 4 training takes 0:01:27
[2023-09-27 15:29:03 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 15:29:03 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 15:29:04 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 15:31:56 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 15:31:56 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 15:31:56 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 15:32:12 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 15:32:12 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 15:32:13 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 15:33:39 iu_test] (trainer.py 133): INFO 	epoch          : 1
[2023-09-27 15:33:39 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.1117500513792038
[2023-09-27 15:33:39 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.0633891373872757
[2023-09-27 15:33:39 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.04417426511645317
[2023-09-27 15:33:39 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.03296046331524849
[2023-09-27 15:33:39 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.05517017841339111
[2023-09-27 15:33:39 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.2565532922744751
[2023-09-27 15:33:39 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.08183019608259201
[2023-09-27 15:33:39 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 3.750555992126465
[2023-09-27 15:33:39 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.14047162234783173
[2023-09-27 15:33:39 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.0814814418554306
[2023-09-27 15:33:39 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.0574202723801136
[2023-09-27 15:33:39 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.04254942387342453
[2023-09-27 15:33:39 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.0643947571516037
[2023-09-27 15:33:39 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.2792569398880005
[2023-09-27 15:33:39 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.08975525200366974
[2023-09-27 15:33:39 iu_test] (trainer.py 161): INFO current best model in: 1
[2023-09-27 15:33:42 iu_test] (trainer.py 167): INFO EPOCH 1 training takes 0:01:29
[2023-09-27 15:35:08 iu_test] (trainer.py 133): INFO 	epoch          : 2
[2023-09-27 15:35:08 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.32543206214904785
[2023-09-27 15:35:08 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.21341681480407715
[2023-09-27 15:35:08 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.1513892114162445
[2023-09-27 15:35:08 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.11405528336763382
[2023-09-27 15:35:08 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.14950904250144958
[2023-09-27 15:35:08 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.35689741373062134
[2023-09-27 15:35:08 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.32177090644836426
[2023-09-27 15:35:08 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.5536506175994873
[2023-09-27 15:35:08 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.3773341178894043
[2023-09-27 15:35:08 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.24799713492393494
[2023-09-27 15:35:08 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.1762082874774933
[2023-09-27 15:35:08 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.13262219727039337
[2023-09-27 15:35:08 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.1661050021648407
[2023-09-27 15:35:08 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3715931177139282
[2023-09-27 15:35:08 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.3690197765827179
[2023-09-27 15:35:08 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-27 15:35:10 iu_test] (trainer.py 167): INFO EPOCH 2 training takes 0:01:27
[2023-09-27 15:36:34 iu_test] (trainer.py 133): INFO 	epoch          : 3
[2023-09-27 15:36:34 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.34384167194366455
[2023-09-27 15:36:34 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.23994603753089905
[2023-09-27 15:36:34 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.17346860468387604
[2023-09-27 15:36:34 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.1308828890323639
[2023-09-27 15:36:34 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.16827285289764404
[2023-09-27 15:36:34 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.36971965432167053
[2023-09-27 15:36:34 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2756890058517456
[2023-09-27 15:36:34 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.1119384765625
[2023-09-27 15:36:34 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.3929656445980072
[2023-09-27 15:36:34 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2766995131969452
[2023-09-27 15:36:34 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.20280222594738007
[2023-09-27 15:36:34 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.15486489236354828
[2023-09-27 15:36:34 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.18785005807876587
[2023-09-27 15:36:34 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.39211198687553406
[2023-09-27 15:36:34 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.38621073961257935
[2023-09-27 15:36:34 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 15:36:36 iu_test] (trainer.py 167): INFO EPOCH 3 training takes 0:01:26
[2023-09-27 15:38:02 iu_test] (trainer.py 133): INFO 	epoch          : 4
[2023-09-27 15:38:02 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.4769466519355774
[2023-09-27 15:38:02 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.3070942759513855
[2023-09-27 15:38:02 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.20815469324588776
[2023-09-27 15:38:02 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.14881886541843414
[2023-09-27 15:38:02 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.19328153133392334
[2023-09-27 15:38:02 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3641507923603058
[2023-09-27 15:38:02 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3219425082206726
[2023-09-27 15:38:02 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.863125205039978
[2023-09-27 15:38:02 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4989164173603058
[2023-09-27 15:38:02 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.322539359331131
[2023-09-27 15:38:02 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.22207339107990265
[2023-09-27 15:38:02 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.16252896189689636
[2023-09-27 15:38:02 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.21090374886989594
[2023-09-27 15:38:02 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.38119348883628845
[2023-09-27 15:38:02 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.40977567434310913
[2023-09-27 15:38:02 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 15:38:04 iu_test] (trainer.py 167): INFO EPOCH 4 training takes 0:01:27
[2023-09-27 15:39:30 iu_test] (trainer.py 133): INFO 	epoch          : 5
[2023-09-27 15:39:30 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.2733844518661499
[2023-09-27 15:39:30 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.14193563163280487
[2023-09-27 15:39:30 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08301908522844315
[2023-09-27 15:39:30 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.05339279770851135
[2023-09-27 15:39:30 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.11873957514762878
[2023-09-27 15:39:30 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.297804594039917
[2023-09-27 15:39:30 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2023402601480484
[2023-09-27 15:39:30 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.7173007726669312
[2023-09-27 15:39:30 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.31685468554496765
[2023-09-27 15:39:30 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.17386473715305328
[2023-09-27 15:39:30 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10947026312351227
[2023-09-27 15:39:30 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.07594650238752365
[2023-09-27 15:39:30 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.13473306596279144
[2023-09-27 15:39:30 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3210718631744385
[2023-09-27 15:39:30 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.35282883048057556
[2023-09-27 15:39:30 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 15:39:31 iu_test] (trainer.py 167): INFO EPOCH 5 training takes 0:01:26
[2023-09-27 15:40:56 iu_test] (trainer.py 133): INFO 	epoch          : 6
[2023-09-27 15:40:56 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.21237145364284515
[2023-09-27 15:40:56 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.13221581280231476
[2023-09-27 15:40:56 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.09414531290531158
[2023-09-27 15:40:56 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.07144026458263397
[2023-09-27 15:40:56 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.11728615313768387
[2023-09-27 15:40:56 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.31272414326667786
[2023-09-27 15:40:56 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3168726861476898
[2023-09-27 15:40:56 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.6336877346038818
[2023-09-27 15:40:56 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.25605374574661255
[2023-09-27 15:40:56 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.16014322638511658
[2023-09-27 15:40:56 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.1134776771068573
[2023-09-27 15:40:56 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08507604151964188
[2023-09-27 15:40:56 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.13172301650047302
[2023-09-27 15:40:56 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.322723388671875
[2023-09-27 15:40:56 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.24640415608882904
[2023-09-27 15:40:56 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 15:40:57 iu_test] (trainer.py 167): INFO EPOCH 6 training takes 0:01:26
[2023-09-27 15:42:24 iu_test] (trainer.py 133): INFO 	epoch          : 7
[2023-09-27 15:42:24 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 15:42:24 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 15:42:24 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 15:42:24 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 15:42:24 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 15:42:24 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 15:42:24 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 15:42:24 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5908787250518799
[2023-09-27 15:42:24 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 15:42:24 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 15:42:24 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 15:42:24 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 15:42:24 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 15:42:24 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 15:42:24 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 15:42:24 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 15:42:25 iu_test] (trainer.py 167): INFO EPOCH 7 training takes 0:01:28
[2023-09-27 15:43:51 iu_test] (trainer.py 133): INFO 	epoch          : 8
[2023-09-27 15:43:51 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 15:43:51 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 15:43:51 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 15:43:51 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 15:43:51 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 15:43:51 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 15:43:51 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 15:43:51 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.546852707862854
[2023-09-27 15:43:51 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 15:43:51 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 15:43:51 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 15:43:51 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 15:43:51 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 15:43:51 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 15:43:51 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 15:43:51 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 15:43:52 iu_test] (trainer.py 167): INFO EPOCH 8 training takes 0:01:26
[2023-09-27 15:45:16 iu_test] (trainer.py 133): INFO 	epoch          : 9
[2023-09-27 15:45:16 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.20140621066093445
[2023-09-27 15:45:16 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11879293620586395
[2023-09-27 15:45:16 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08352222293615341
[2023-09-27 15:45:16 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06349898129701614
[2023-09-27 15:45:16 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10349228233098984
[2023-09-27 15:45:16 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.2940300703048706
[2023-09-27 15:45:16 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3334653079509735
[2023-09-27 15:45:16 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5307658910751343
[2023-09-27 15:45:16 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24456869065761566
[2023-09-27 15:45:16 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.1480168253183365
[2023-09-27 15:45:16 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.1062462329864502
[2023-09-27 15:45:16 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08143340051174164
[2023-09-27 15:45:16 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.12013988196849823
[2023-09-27 15:45:16 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.31182989478111267
[2023-09-27 15:45:16 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34499266743659973
[2023-09-27 15:45:16 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 15:45:17 iu_test] (trainer.py 167): INFO EPOCH 9 training takes 0:01:25
[2023-09-27 15:46:43 iu_test] (trainer.py 133): INFO 	epoch          : 10
[2023-09-27 15:46:43 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.3605298697948456
[2023-09-27 15:46:43 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.21876119077205658
[2023-09-27 15:46:43 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.15076236426830292
[2023-09-27 15:46:43 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.11172409355640411
[2023-09-27 15:46:43 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.14500130712985992
[2023-09-27 15:46:43 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.31924429535865784
[2023-09-27 15:46:43 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.4070349931716919
[2023-09-27 15:46:43 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5127283334732056
[2023-09-27 15:46:43 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.39684468507766724
[2023-09-27 15:46:43 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.24966779351234436
[2023-09-27 15:46:43 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.180384561419487
[2023-09-27 15:46:43 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.13916225731372833
[2023-09-27 15:46:43 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.16161267459392548
[2023-09-27 15:46:43 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.341631144285202
[2023-09-27 15:46:43 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.49768438935279846
[2023-09-27 15:46:43 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 15:46:44 iu_test] (trainer.py 167): INFO EPOCH 10 training takes 0:01:26
[2023-09-27 15:48:09 iu_test] (trainer.py 133): INFO 	epoch          : 11
[2023-09-27 15:48:09 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.21818415820598602
[2023-09-27 15:48:09 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.12943416833877563
[2023-09-27 15:48:09 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.09058059751987457
[2023-09-27 15:48:09 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06856940686702728
[2023-09-27 15:48:09 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10720691084861755
[2023-09-27 15:48:09 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29453983902931213
[2023-09-27 15:48:09 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3335328698158264
[2023-09-27 15:48:09 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5212626457214355
[2023-09-27 15:48:09 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.25811851024627686
[2023-09-27 15:48:09 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.15814770758152008
[2023-09-27 15:48:09 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.11361921578645706
[2023-09-27 15:48:09 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08725664019584656
[2023-09-27 15:48:09 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.1235540360212326
[2023-09-27 15:48:09 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3146172761917114
[2023-09-27 15:48:09 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.37696555256843567
[2023-09-27 15:48:09 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 15:48:10 iu_test] (trainer.py 167): INFO EPOCH 11 training takes 0:01:25
[2023-09-27 15:49:36 iu_test] (trainer.py 133): INFO 	epoch          : 12
[2023-09-27 15:49:36 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.42875245213508606
[2023-09-27 15:49:36 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.2685283124446869
[2023-09-27 15:49:36 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.1852114498615265
[2023-09-27 15:49:36 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.1366615742444992
[2023-09-27 15:49:36 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.17445692420005798
[2023-09-27 15:49:36 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3426089286804199
[2023-09-27 15:49:36 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.30852997303009033
[2023-09-27 15:49:36 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5152842998504639
[2023-09-27 15:49:36 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4745989441871643
[2023-09-27 15:49:36 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.30667561292648315
[2023-09-27 15:49:36 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.22057263553142548
[2023-09-27 15:49:36 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.1698349416255951
[2023-09-27 15:49:36 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.19408196210861206
[2023-09-27 15:49:36 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.37080612778663635
[2023-09-27 15:49:36 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.5919452905654907
[2023-09-27 15:49:36 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 15:49:37 iu_test] (trainer.py 167): INFO EPOCH 12 training takes 0:01:26
[2023-09-27 15:51:02 iu_test] (trainer.py 133): INFO 	epoch          : 13
[2023-09-27 15:51:02 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.37193480134010315
[2023-09-27 15:51:02 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.22747668623924255
[2023-09-27 15:51:02 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.15321916341781616
[2023-09-27 15:51:02 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.1087557002902031
[2023-09-27 15:51:02 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.150712788105011
[2023-09-27 15:51:02 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.32338812947273254
[2023-09-27 15:51:02 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.34161797165870667
[2023-09-27 15:51:02 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.526273488998413
[2023-09-27 15:51:02 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.40089091658592224
[2023-09-27 15:51:02 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.24878081679344177
[2023-09-27 15:51:02 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.17517419159412384
[2023-09-27 15:51:02 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.13103535771369934
[2023-09-27 15:51:02 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.16183723509311676
[2023-09-27 15:51:02 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3358815312385559
[2023-09-27 15:51:02 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.42097774147987366
[2023-09-27 15:51:02 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 15:51:03 iu_test] (trainer.py 167): INFO EPOCH 13 training takes 0:01:25
[2023-09-27 15:52:27 iu_test] (trainer.py 133): INFO 	epoch          : 14
[2023-09-27 15:52:27 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.39669284224510193
[2023-09-27 15:52:27 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.21733778715133667
[2023-09-27 15:52:27 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.1388777792453766
[2023-09-27 15:52:27 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.09702173620462418
[2023-09-27 15:52:27 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.14773046970367432
[2023-09-27 15:52:27 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3110206723213196
[2023-09-27 15:52:27 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3070557117462158
[2023-09-27 15:52:27 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5399562120437622
[2023-09-27 15:52:27 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.44359222054481506
[2023-09-27 15:52:27 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2658458352088928
[2023-09-27 15:52:27 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.18747642636299133
[2023-09-27 15:52:27 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.14251208305358887
[2023-09-27 15:52:27 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.17150074243545532
[2023-09-27 15:52:27 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.34668055176734924
[2023-09-27 15:52:27 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.5771384239196777
[2023-09-27 15:52:27 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 15:52:28 iu_test] (trainer.py 167): INFO EPOCH 14 training takes 0:01:25
[2023-09-27 15:53:53 iu_test] (trainer.py 133): INFO 	epoch          : 15
[2023-09-27 15:53:53 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.3809863328933716
[2023-09-27 15:53:53 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.22103166580200195
[2023-09-27 15:53:53 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.14497289061546326
[2023-09-27 15:53:53 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.10284078866243362
[2023-09-27 15:53:53 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.15088385343551636
[2023-09-27 15:53:53 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3223758339881897
[2023-09-27 15:53:53 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.34788569808006287
[2023-09-27 15:53:53 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5639599561691284
[2023-09-27 15:53:53 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4128875136375427
[2023-09-27 15:53:53 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2547922134399414
[2023-09-27 15:53:53 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.17886564135551453
[2023-09-27 15:53:53 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.13466250896453857
[2023-09-27 15:53:53 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.16685034334659576
[2023-09-27 15:53:53 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.341562956571579
[2023-09-27 15:53:53 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.47250956296920776
[2023-09-27 15:53:53 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 15:53:54 iu_test] (trainer.py 167): INFO EPOCH 15 training takes 0:01:25
[2023-09-27 15:55:19 iu_test] (trainer.py 133): INFO 	epoch          : 16
[2023-09-27 15:55:19 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.4137328565120697
[2023-09-27 15:55:19 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.2466045320034027
[2023-09-27 15:55:19 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.16279961168766022
[2023-09-27 15:55:19 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.11507909744977951
[2023-09-27 15:55:19 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.15951037406921387
[2023-09-27 15:55:19 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3295036554336548
[2023-09-27 15:55:19 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3122981786727905
[2023-09-27 15:55:19 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5989024639129639
[2023-09-27 15:55:19 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.45128846168518066
[2023-09-27 15:55:19 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2779206931591034
[2023-09-27 15:55:19 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.195085346698761
[2023-09-27 15:55:19 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.14715002477169037
[2023-09-27 15:55:19 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.17839975655078888
[2023-09-27 15:55:19 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3510417640209198
[2023-09-27 15:55:19 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.5355973243713379
[2023-09-27 15:55:19 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 15:55:21 iu_test] (trainer.py 167): INFO EPOCH 16 training takes 0:01:27
[2023-09-27 15:56:47 iu_test] (trainer.py 133): INFO 	epoch          : 17
[2023-09-27 15:56:47 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.41751977801322937
[2023-09-27 15:56:47 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.267551988363266
[2023-09-27 15:56:47 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.18391139805316925
[2023-09-27 15:56:47 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.13415071368217468
[2023-09-27 15:56:47 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.16901244223117828
[2023-09-27 15:56:47 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.33649179339408875
[2023-09-27 15:56:47 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3291199207305908
[2023-09-27 15:56:47 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.623171091079712
[2023-09-27 15:56:47 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4496305584907532
[2023-09-27 15:56:47 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.29087328910827637
[2023-09-27 15:56:47 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.20739661157131195
[2023-09-27 15:56:47 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.1578860878944397
[2023-09-27 15:56:47 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.1829409897327423
[2023-09-27 15:56:47 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.35702234506607056
[2023-09-27 15:56:47 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.4634106755256653
[2023-09-27 15:56:47 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 15:56:48 iu_test] (trainer.py 167): INFO EPOCH 17 training takes 0:01:27
[2023-09-27 15:58:13 iu_test] (trainer.py 133): INFO 	epoch          : 18
[2023-09-27 15:58:13 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.40391281247138977
[2023-09-27 15:58:13 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.24035300314426422
[2023-09-27 15:58:13 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.1628500074148178
[2023-09-27 15:58:13 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.11901013553142548
[2023-09-27 15:58:13 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.15729805827140808
[2023-09-27 15:58:13 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3268231749534607
[2023-09-27 15:58:13 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3094100058078766
[2023-09-27 15:58:13 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.646095633506775
[2023-09-27 15:58:13 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4410800039768219
[2023-09-27 15:58:13 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2744106948375702
[2023-09-27 15:58:13 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.19808410108089447
[2023-09-27 15:58:13 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.1537783145904541
[2023-09-27 15:58:13 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.1741102784872055
[2023-09-27 15:58:13 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.347502201795578
[2023-09-27 15:58:13 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.5262185335159302
[2023-09-27 15:58:13 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 15:58:14 iu_test] (trainer.py 167): INFO EPOCH 18 training takes 0:01:26
[2023-09-27 15:59:40 iu_test] (trainer.py 133): INFO 	epoch          : 19
[2023-09-27 15:59:40 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.3934248089790344
[2023-09-27 15:59:40 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.2364649772644043
[2023-09-27 15:59:40 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.15937837958335876
[2023-09-27 15:59:40 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.11524935811758041
[2023-09-27 15:59:40 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.15745778381824493
[2023-09-27 15:59:40 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.33437731862068176
[2023-09-27 15:59:40 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3774060606956482
[2023-09-27 15:59:40 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.6596077680587769
[2023-09-27 15:59:40 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.43257835507392883
[2023-09-27 15:59:40 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2661791443824768
[2023-09-27 15:59:40 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.18442724645137787
[2023-09-27 15:59:40 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.1376354843378067
[2023-09-27 15:59:40 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.17566688358783722
[2023-09-27 15:59:40 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3494843542575836
[2023-09-27 15:59:40 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.44221487641334534
[2023-09-27 15:59:40 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 15:59:41 iu_test] (trainer.py 167): INFO EPOCH 19 training takes 0:01:26
[2023-09-27 16:01:06 iu_test] (trainer.py 133): INFO 	epoch          : 20
[2023-09-27 16:01:06 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.4048662483692169
[2023-09-27 16:01:06 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.24889305233955383
[2023-09-27 16:01:06 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.17226901650428772
[2023-09-27 16:01:06 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.1291128695011139
[2023-09-27 16:01:06 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.16207274794578552
[2023-09-27 16:01:06 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3324277400970459
[2023-09-27 16:01:06 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.36256974935531616
[2023-09-27 16:01:06 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.7110297679901123
[2023-09-27 16:01:06 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4489191472530365
[2023-09-27 16:01:06 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2872539758682251
[2023-09-27 16:01:06 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.20895959436893463
[2023-09-27 16:01:06 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.16403304040431976
[2023-09-27 16:01:06 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.1845928579568863
[2023-09-27 16:01:06 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.35965198278427124
[2023-09-27 16:01:06 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.6062034368515015
[2023-09-27 16:01:06 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 16:01:07 iu_test] (trainer.py 167): INFO EPOCH 20 training takes 0:01:25
[2023-09-27 16:02:31 iu_test] (trainer.py 133): INFO 	epoch          : 21
[2023-09-27 16:02:31 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.4183681607246399
[2023-09-27 16:02:31 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.2592158019542694
[2023-09-27 16:02:31 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.17729665338993073
[2023-09-27 16:02:31 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.12963071465492249
[2023-09-27 16:02:31 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.16099612414836884
[2023-09-27 16:02:31 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.32828184962272644
[2023-09-27 16:02:31 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.26955947279930115
[2023-09-27 16:02:31 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.7055201530456543
[2023-09-27 16:02:31 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.447099894285202
[2023-09-27 16:02:31 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2895644009113312
[2023-09-27 16:02:31 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.20856957137584686
[2023-09-27 16:02:31 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.1618129462003708
[2023-09-27 16:02:31 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.1779463142156601
[2023-09-27 16:02:31 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3530231714248657
[2023-09-27 16:02:31 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.5000063180923462
[2023-09-27 16:02:31 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 16:02:33 iu_test] (trainer.py 167): INFO EPOCH 21 training takes 0:01:25
[2023-09-27 16:03:57 iu_test] (trainer.py 133): INFO 	epoch          : 22
[2023-09-27 16:03:57 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.4334229826927185
[2023-09-27 16:03:57 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.2713163495063782
[2023-09-27 16:03:57 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.18796901404857635
[2023-09-27 16:03:57 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.1395246982574463
[2023-09-27 16:03:57 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.16793790459632874
[2023-09-27 16:03:57 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.33622992038726807
[2023-09-27 16:03:57 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.38677480816841125
[2023-09-27 16:03:57 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.7318066358566284
[2023-09-27 16:03:57 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.45587626099586487
[2023-09-27 16:03:57 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2922757565975189
[2023-09-27 16:03:57 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.21043053269386292
[2023-09-27 16:03:57 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.16205927729606628
[2023-09-27 16:03:57 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.18615680932998657
[2023-09-27 16:03:57 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.35766980051994324
[2023-09-27 16:03:57 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.5331266522407532
[2023-09-27 16:03:57 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 16:03:58 iu_test] (trainer.py 167): INFO EPOCH 22 training takes 0:01:25
[2023-09-27 16:05:23 iu_test] (trainer.py 133): INFO 	epoch          : 23
[2023-09-27 16:05:23 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.3980932831764221
[2023-09-27 16:05:23 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.24850334227085114
[2023-09-27 16:05:23 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.17325080931186676
[2023-09-27 16:05:23 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.1301555037498474
[2023-09-27 16:05:23 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.16198469698429108
[2023-09-27 16:05:23 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3332260251045227
[2023-09-27 16:05:23 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.4046032428741455
[2023-09-27 16:05:23 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.7806118726730347
[2023-09-27 16:05:23 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4464629292488098
[2023-09-27 16:05:23 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2903274595737457
[2023-09-27 16:05:23 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.21055848896503448
[2023-09-27 16:05:23 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.16380639374256134
[2023-09-27 16:05:23 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.1847122311592102
[2023-09-27 16:05:23 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3638351559638977
[2023-09-27 16:05:23 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.5552654266357422
[2023-09-27 16:05:23 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 16:05:24 iu_test] (trainer.py 167): INFO EPOCH 23 training takes 0:01:26
[2023-09-27 16:06:50 iu_test] (trainer.py 133): INFO 	epoch          : 24
[2023-09-27 16:06:50 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.40136486291885376
[2023-09-27 16:06:50 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.2455349713563919
[2023-09-27 16:06:50 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.16836680471897125
[2023-09-27 16:06:50 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.12503042817115784
[2023-09-27 16:06:50 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.15729722380638123
[2023-09-27 16:06:50 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3283252716064453
[2023-09-27 16:06:50 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.312728613615036
[2023-09-27 16:06:50 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.7942962646484375
[2023-09-27 16:06:50 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4283753037452698
[2023-09-27 16:06:50 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.26834002137184143
[2023-09-27 16:06:50 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.1884085088968277
[2023-09-27 16:06:50 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.14241334795951843
[2023-09-27 16:06:50 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.1724431961774826
[2023-09-27 16:06:50 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3428440988063812
[2023-09-27 16:06:50 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.4238825738430023
[2023-09-27 16:06:50 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 16:06:51 iu_test] (trainer.py 167): INFO EPOCH 24 training takes 0:01:26
[2023-09-27 16:08:15 iu_test] (trainer.py 133): INFO 	epoch          : 25
[2023-09-27 16:08:15 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.406715989112854
[2023-09-27 16:08:15 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.24752873182296753
[2023-09-27 16:08:15 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.1652488112449646
[2023-09-27 16:08:15 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.11867605149745941
[2023-09-27 16:08:15 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.16062018275260925
[2023-09-27 16:08:15 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3280348777770996
[2023-09-27 16:08:15 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3437735438346863
[2023-09-27 16:08:15 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.8217658996582031
[2023-09-27 16:08:15 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.41892868280410767
[2023-09-27 16:08:15 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2620093524456024
[2023-09-27 16:08:15 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.18427743017673492
[2023-09-27 16:08:15 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.13908669352531433
[2023-09-27 16:08:15 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.16954554617404938
[2023-09-27 16:08:15 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3414818346500397
[2023-09-27 16:08:15 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.5113668441772461
[2023-09-27 16:08:15 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 16:08:16 iu_test] (trainer.py 167): INFO EPOCH 25 training takes 0:01:25
[2023-09-27 19:10:40 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 19:10:40 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 19:10:40 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 19:12:26 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 19:12:26 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 19:12:26 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 19:27:48 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 19:27:48 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 19:27:49 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 19:30:02 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 19:30:02 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 19:30:02 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 19:47:20 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 19:47:20 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 19:47:21 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 19:47:47 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 19:47:47 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 19:47:47 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 19:48:09 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 19:48:09 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 19:48:09 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 19:51:25 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 19:51:25 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 19:51:26 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 19:51:53 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 19:51:53 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 19:51:54 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 19:52:34 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 19:52:34 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 19:52:35 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 19:54:02 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 19:54:02 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 19:54:02 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 19:54:09 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 19:54:09 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 19:54:10 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 19:55:24 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 19:55:24 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 19:55:25 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 19:56:58 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 19:56:58 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 19:56:59 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 19:59:18 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 19:59:18 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 19:59:19 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 20:06:31 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 20:06:31 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 20:06:32 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 20:07:18 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 20:07:18 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 20:07:19 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 20:07:38 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 20:07:38 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 20:07:39 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 20:09:38 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 20:09:38 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 20:09:39 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 20:15:44 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 20:15:44 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 20:15:44 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 20:17:53 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 20:17:53 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 20:17:53 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 20:19:22 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 20:19:22 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 20:19:22 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 20:21:08 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 20:21:08 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 20:21:08 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 20:24:05 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 20:24:05 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 20:24:06 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 20:26:56 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 20:26:56 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 20:26:57 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 20:33:18 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 20:33:18 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 20:33:18 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 20:34:20 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 20:34:20 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 20:34:20 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 20:35:27 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 20:35:27 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 20:35:28 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 20:36:39 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 20:36:39 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 20:36:39 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 20:38:16 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 20:38:16 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 20:38:16 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 20:43:38 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 20:43:38 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 20:43:38 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 20:43:53 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 20:43:53 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 20:43:54 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 20:47:21 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 20:47:21 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 20:47:21 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 20:48:48 iu_test] (trainer.py 133): INFO 	epoch          : 1
[2023-09-27 20:48:48 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.1117500513792038
[2023-09-27 20:48:48 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.0633891373872757
[2023-09-27 20:48:48 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.04417426511645317
[2023-09-27 20:48:48 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.03296046331524849
[2023-09-27 20:48:48 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.05517017841339111
[2023-09-27 20:48:48 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.2565532922744751
[2023-09-27 20:48:48 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.08183019608259201
[2023-09-27 20:48:48 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 3.750555992126465
[2023-09-27 20:48:48 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.14047162234783173
[2023-09-27 20:48:48 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.0814814418554306
[2023-09-27 20:48:48 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.0574202723801136
[2023-09-27 20:48:48 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.04254942387342453
[2023-09-27 20:48:48 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.0643947571516037
[2023-09-27 20:48:48 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.2792569398880005
[2023-09-27 20:48:48 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.08975525200366974
[2023-09-27 20:48:48 iu_test] (trainer.py 161): INFO current best model in: 1
[2023-09-27 20:48:50 iu_test] (trainer.py 167): INFO EPOCH 1 training takes 0:01:28
[2023-09-27 20:50:14 iu_test] (trainer.py 133): INFO 	epoch          : 2
[2023-09-27 20:50:14 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.32543206214904785
[2023-09-27 20:50:14 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.21341681480407715
[2023-09-27 20:50:14 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.1513892114162445
[2023-09-27 20:50:14 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.11405528336763382
[2023-09-27 20:50:14 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.14950904250144958
[2023-09-27 20:50:14 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.35689741373062134
[2023-09-27 20:50:14 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.32177090644836426
[2023-09-27 20:50:14 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.5536506175994873
[2023-09-27 20:50:14 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.3773341178894043
[2023-09-27 20:50:14 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.24799713492393494
[2023-09-27 20:50:14 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.1762082874774933
[2023-09-27 20:50:14 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.13262219727039337
[2023-09-27 20:50:14 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.1661050021648407
[2023-09-27 20:50:14 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3715931177139282
[2023-09-27 20:50:14 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.3690197765827179
[2023-09-27 20:50:14 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-27 20:50:15 iu_test] (trainer.py 167): INFO EPOCH 2 training takes 0:01:25
[2023-09-27 20:51:39 iu_test] (trainer.py 133): INFO 	epoch          : 3
[2023-09-27 20:51:39 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.34360286593437195
[2023-09-27 20:51:39 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.23985089361667633
[2023-09-27 20:51:39 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.17344994843006134
[2023-09-27 20:51:39 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.13091379404067993
[2023-09-27 20:51:39 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.16832998394966125
[2023-09-27 20:51:39 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.37000030279159546
[2023-09-27 20:51:39 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2766512930393219
[2023-09-27 20:51:39 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.1119384765625
[2023-09-27 20:51:39 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.3929656445980072
[2023-09-27 20:51:39 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2766995131969452
[2023-09-27 20:51:39 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.20280222594738007
[2023-09-27 20:51:39 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.15486489236354828
[2023-09-27 20:51:39 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.18785005807876587
[2023-09-27 20:51:39 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.39211198687553406
[2023-09-27 20:51:39 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.38621073961257935
[2023-09-27 20:51:39 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 20:51:41 iu_test] (trainer.py 167): INFO EPOCH 3 training takes 0:01:25
[2023-09-27 20:53:04 iu_test] (trainer.py 133): INFO 	epoch          : 4
[2023-09-27 20:53:04 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.4776710867881775
[2023-09-27 20:53:04 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.30756768584251404
[2023-09-27 20:53:04 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.20836831629276276
[2023-09-27 20:53:04 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.14893122017383575
[2023-09-27 20:53:04 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.19346070289611816
[2023-09-27 20:53:04 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.36425071954727173
[2023-09-27 20:53:04 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3220568597316742
[2023-09-27 20:53:04 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.863125205039978
[2023-09-27 20:53:04 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4988393187522888
[2023-09-27 20:53:04 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.3224303722381592
[2023-09-27 20:53:04 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.22196440398693085
[2023-09-27 20:53:04 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.16245761513710022
[2023-09-27 20:53:04 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.21088746190071106
[2023-09-27 20:53:04 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3812112808227539
[2023-09-27 20:53:04 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.40837204456329346
[2023-09-27 20:53:04 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 20:53:07 iu_test] (trainer.py 167): INFO EPOCH 4 training takes 0:01:25
[2023-09-27 20:54:30 iu_test] (trainer.py 133): INFO 	epoch          : 5
[2023-09-27 20:54:30 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.2733844518661499
[2023-09-27 20:54:30 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.14193563163280487
[2023-09-27 20:54:30 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08301908522844315
[2023-09-27 20:54:30 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.05339279770851135
[2023-09-27 20:54:30 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.11873957514762878
[2023-09-27 20:54:30 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.297804594039917
[2023-09-27 20:54:30 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2023402601480484
[2023-09-27 20:54:30 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.7173007726669312
[2023-09-27 20:54:30 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.31685468554496765
[2023-09-27 20:54:30 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.17386473715305328
[2023-09-27 20:54:30 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10947026312351227
[2023-09-27 20:54:30 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.07594650238752365
[2023-09-27 20:54:30 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.13473306596279144
[2023-09-27 20:54:30 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3210718631744385
[2023-09-27 20:54:30 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.35282883048057556
[2023-09-27 20:54:30 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 20:54:31 iu_test] (trainer.py 167): INFO EPOCH 5 training takes 0:01:24
[2023-09-27 20:55:55 iu_test] (trainer.py 133): INFO 	epoch          : 6
[2023-09-27 20:55:55 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.21237145364284515
[2023-09-27 20:55:55 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.13221581280231476
[2023-09-27 20:55:55 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.09414531290531158
[2023-09-27 20:55:55 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.07144026458263397
[2023-09-27 20:55:55 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.11728615313768387
[2023-09-27 20:55:55 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.31272414326667786
[2023-09-27 20:55:55 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3168726861476898
[2023-09-27 20:55:55 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.6336877346038818
[2023-09-27 20:55:55 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.25601130723953247
[2023-09-27 20:55:55 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.16002187132835388
[2023-09-27 20:55:55 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.11329279094934464
[2023-09-27 20:55:55 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08494161069393158
[2023-09-27 20:55:55 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.13169075548648834
[2023-09-27 20:55:55 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.32256415486335754
[2023-09-27 20:55:55 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.24607159197330475
[2023-09-27 20:55:55 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 20:55:56 iu_test] (trainer.py 167): INFO EPOCH 6 training takes 0:01:24
[2023-09-27 20:57:21 iu_test] (trainer.py 133): INFO 	epoch          : 7
[2023-09-27 20:57:21 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 20:57:21 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 20:57:21 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 20:57:21 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 20:57:21 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 20:57:21 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 20:57:21 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 20:57:21 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5908787250518799
[2023-09-27 20:57:21 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 20:57:21 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 20:57:21 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 20:57:21 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 20:57:21 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 20:57:21 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 20:57:21 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 20:57:21 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 20:57:22 iu_test] (trainer.py 167): INFO EPOCH 7 training takes 0:01:25
[2023-09-27 20:58:47 iu_test] (trainer.py 133): INFO 	epoch          : 8
[2023-09-27 20:58:47 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 20:58:47 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 20:58:47 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 20:58:47 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 20:58:47 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 20:58:47 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 20:58:47 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 20:58:47 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.546852707862854
[2023-09-27 20:58:47 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 20:58:47 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 20:58:47 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 20:58:47 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 20:58:47 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 20:58:47 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 20:58:47 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 20:58:47 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 20:58:48 iu_test] (trainer.py 167): INFO EPOCH 8 training takes 0:01:25
[2023-09-27 21:00:13 iu_test] (trainer.py 133): INFO 	epoch          : 9
[2023-09-27 21:00:13 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.20140621066093445
[2023-09-27 21:00:13 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11879293620586395
[2023-09-27 21:00:13 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08352222293615341
[2023-09-27 21:00:13 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06349898129701614
[2023-09-27 21:00:13 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10349228233098984
[2023-09-27 21:00:13 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.2940300703048706
[2023-09-27 21:00:13 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3334653079509735
[2023-09-27 21:00:13 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5307658910751343
[2023-09-27 21:00:13 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24500130116939545
[2023-09-27 21:00:13 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14824537932872772
[2023-09-27 21:00:13 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10639818012714386
[2023-09-27 21:00:13 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.0815424919128418
[2023-09-27 21:00:13 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.12016724050045013
[2023-09-27 21:00:13 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3118588328361511
[2023-09-27 21:00:13 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34499266743659973
[2023-09-27 21:00:13 iu_test] (trainer.py 161): INFO current best model in: 4
[2023-09-27 21:00:14 iu_test] (trainer.py 167): INFO EPOCH 9 training takes 0:01:26
[2023-09-27 21:01:17 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 21:01:17 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 21:01:37 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 21:01:37 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 21:01:52 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 21:01:52 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 21:01:52 iu_test] (main.py 117): INFO number of params: 55905081
[2023-09-27 21:05:48 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 21:05:48 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 21:06:09 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 21:06:09 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 21:06:09 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 21:08:50 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 21:08:50 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 21:08:50 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 21:10:16 iu_test] (trainer.py 133): INFO 	epoch          : 1
[2023-09-27 21:10:16 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.2480921745300293
[2023-09-27 21:10:16 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.14768290519714355
[2023-09-27 21:10:16 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.09837942570447922
[2023-09-27 21:10:16 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06918294727802277
[2023-09-27 21:10:16 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.0918319821357727
[2023-09-27 21:10:16 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29714128375053406
[2023-09-27 21:10:16 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.1394197791814804
[2023-09-27 21:10:16 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 3.7069191932678223
[2023-09-27 21:10:16 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.27589914202690125
[2023-09-27 21:10:16 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.16515327990055084
[2023-09-27 21:10:16 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.11083849519491196
[2023-09-27 21:10:16 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.07783450186252594
[2023-09-27 21:10:16 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.10032112151384354
[2023-09-27 21:10:16 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3088124096393585
[2023-09-27 21:10:16 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.14401033520698547
[2023-09-27 21:10:16 iu_test] (trainer.py 161): INFO current best model in: 1
[2023-09-27 21:10:19 iu_test] (trainer.py 167): INFO EPOCH 1 training takes 0:01:28
[2023-09-27 21:11:42 iu_test] (trainer.py 133): INFO 	epoch          : 2
[2023-09-27 21:11:42 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.3221227526664734
[2023-09-27 21:11:42 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.21197539567947388
[2023-09-27 21:11:42 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.15076930820941925
[2023-09-27 21:11:42 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.11367077380418777
[2023-09-27 21:11:42 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.14869780838489532
[2023-09-27 21:11:42 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.35389822721481323
[2023-09-27 21:11:42 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3219132721424103
[2023-09-27 21:11:42 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.54317307472229
[2023-09-27 21:11:42 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.3734743297100067
[2023-09-27 21:11:42 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.24728576838970184
[2023-09-27 21:11:42 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.17745688557624817
[2023-09-27 21:11:42 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.13443145155906677
[2023-09-27 21:11:42 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.16588075459003448
[2023-09-27 21:11:42 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.37087610363960266
[2023-09-27 21:11:42 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.3817463219165802
[2023-09-27 21:11:42 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-27 21:11:44 iu_test] (trainer.py 167): INFO EPOCH 2 training takes 0:01:25
[2023-09-27 21:13:09 iu_test] (trainer.py 133): INFO 	epoch          : 3
[2023-09-27 21:13:09 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 21:13:09 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 21:13:09 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 21:13:09 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 21:13:09 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 21:13:09 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 21:13:09 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 21:13:09 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.1067636013031006
[2023-09-27 21:13:09 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 21:13:09 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 21:13:09 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 21:13:09 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 21:13:09 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 21:13:09 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 21:13:09 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 21:13:09 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-27 21:13:10 iu_test] (trainer.py 167): INFO EPOCH 3 training takes 0:01:25
[2023-09-27 21:14:34 iu_test] (trainer.py 133): INFO 	epoch          : 4
[2023-09-27 21:14:34 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 21:14:34 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 21:14:34 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 21:14:34 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 21:14:34 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 21:14:34 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 21:14:34 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 21:14:34 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.86277437210083
[2023-09-27 21:14:34 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 21:14:34 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 21:14:34 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 21:14:34 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 21:14:34 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 21:14:34 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 21:14:34 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 21:14:34 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-27 21:14:35 iu_test] (trainer.py 167): INFO EPOCH 4 training takes 0:01:24
[2023-09-27 21:15:58 iu_test] (trainer.py 133): INFO 	epoch          : 5
[2023-09-27 21:15:58 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 21:15:58 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 21:15:58 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 21:15:58 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 21:15:58 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 21:15:58 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 21:15:58 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 21:15:58 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.7206615209579468
[2023-09-27 21:15:58 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 21:15:58 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 21:15:58 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 21:15:58 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 21:15:58 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 21:15:58 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 21:15:58 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 21:15:58 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-27 21:15:59 iu_test] (trainer.py 167): INFO EPOCH 5 training takes 0:01:24
[2023-09-27 21:17:23 iu_test] (trainer.py 133): INFO 	epoch          : 6
[2023-09-27 21:17:23 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.43189504742622375
[2023-09-27 21:17:23 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.2750268876552582
[2023-09-27 21:17:23 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.18538950383663177
[2023-09-27 21:17:23 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.12952920794487
[2023-09-27 21:17:23 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.17627815902233124
[2023-09-27 21:17:23 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3301030397415161
[2023-09-27 21:17:23 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2308095246553421
[2023-09-27 21:17:23 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.6316189765930176
[2023-09-27 21:17:23 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4760660231113434
[2023-09-27 21:17:23 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.30854207277297974
[2023-09-27 21:17:23 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.21570897102355957
[2023-09-27 21:17:23 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.158542662858963
[2023-09-27 21:17:23 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.19721442461013794
[2023-09-27 21:17:23 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.35066109895706177
[2023-09-27 21:17:23 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.45055854320526123
[2023-09-27 21:17:23 iu_test] (trainer.py 161): INFO current best model in: 6
[2023-09-27 21:17:25 iu_test] (trainer.py 167): INFO EPOCH 6 training takes 0:01:25
[2023-09-27 21:18:49 iu_test] (trainer.py 133): INFO 	epoch          : 7
[2023-09-27 21:18:49 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.23150911927223206
[2023-09-27 21:18:49 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.13691946864128113
[2023-09-27 21:18:49 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.09391491115093231
[2023-09-27 21:18:49 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06940959393978119
[2023-09-27 21:18:49 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.11558394879102707
[2023-09-27 21:18:49 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.30482491850852966
[2023-09-27 21:18:49 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.28758880496025085
[2023-09-27 21:18:49 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5731945037841797
[2023-09-27 21:18:49 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.2716406285762787
[2023-09-27 21:18:49 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.16354958713054657
[2023-09-27 21:18:49 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.11468667536973953
[2023-09-27 21:18:49 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08589733392000198
[2023-09-27 21:18:49 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.12891124188899994
[2023-09-27 21:18:49 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3211699426174164
[2023-09-27 21:18:49 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.33302873373031616
[2023-09-27 21:18:49 iu_test] (trainer.py 161): INFO current best model in: 6
[2023-09-27 21:18:51 iu_test] (trainer.py 167): INFO EPOCH 7 training takes 0:01:25
[2023-09-27 21:20:15 iu_test] (trainer.py 133): INFO 	epoch          : 8
[2023-09-27 21:20:15 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.23354962468147278
[2023-09-27 21:20:15 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.14026550948619843
[2023-09-27 21:20:15 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.09818292409181595
[2023-09-27 21:20:15 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.07358463853597641
[2023-09-27 21:20:15 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.11494093388319016
[2023-09-27 21:20:15 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.30179277062416077
[2023-09-27 21:20:15 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.32294127345085144
[2023-09-27 21:20:15 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5490103960037231
[2023-09-27 21:20:15 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.26740482449531555
[2023-09-27 21:20:15 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.16313405334949493
[2023-09-27 21:20:15 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.1160438284277916
[2023-09-27 21:20:15 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08792999386787415
[2023-09-27 21:20:15 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.12661392986774445
[2023-09-27 21:20:15 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.31674185395240784
[2023-09-27 21:20:15 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.33435818552970886
[2023-09-27 21:20:15 iu_test] (trainer.py 161): INFO current best model in: 6
[2023-09-27 21:20:16 iu_test] (trainer.py 167): INFO EPOCH 8 training takes 0:01:25
[2023-09-27 21:21:40 iu_test] (trainer.py 133): INFO 	epoch          : 9
[2023-09-27 21:21:40 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.20276227593421936
[2023-09-27 21:21:40 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11975423991680145
[2023-09-27 21:21:40 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08432035893201828
[2023-09-27 21:21:40 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.064140684902668
[2023-09-27 21:21:40 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10427812486886978
[2023-09-27 21:21:40 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.2932448089122772
[2023-09-27 21:21:40 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3010077178478241
[2023-09-27 21:21:40 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5262240171432495
[2023-09-27 21:21:40 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24499762058258057
[2023-09-27 21:21:40 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14935635030269623
[2023-09-27 21:21:40 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10762225091457367
[2023-09-27 21:21:40 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08271609991788864
[2023-09-27 21:21:40 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.12073295563459396
[2023-09-27 21:21:40 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3133690059185028
[2023-09-27 21:21:40 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.3476332426071167
[2023-09-27 21:21:40 iu_test] (trainer.py 161): INFO current best model in: 6
[2023-09-27 21:21:41 iu_test] (trainer.py 167): INFO EPOCH 9 training takes 0:01:24
[2023-09-27 21:23:04 iu_test] (trainer.py 133): INFO 	epoch          : 10
[2023-09-27 21:23:04 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.20315620303153992
[2023-09-27 21:23:04 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.12026256322860718
[2023-09-27 21:23:04 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08493933081626892
[2023-09-27 21:23:04 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06488342583179474
[2023-09-27 21:23:04 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10426519066095352
[2023-09-27 21:23:04 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.2945529520511627
[2023-09-27 21:23:04 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33207613229751587
[2023-09-27 21:23:04 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5259225368499756
[2023-09-27 21:23:04 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24748572707176208
[2023-09-27 21:23:04 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.15005016326904297
[2023-09-27 21:23:04 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10803604125976562
[2023-09-27 21:23:04 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08313467353582382
[2023-09-27 21:23:04 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.12021053582429886
[2023-09-27 21:23:04 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.31127098202705383
[2023-09-27 21:23:04 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34227249026298523
[2023-09-27 21:23:04 iu_test] (trainer.py 161): INFO current best model in: 6
[2023-09-27 21:23:05 iu_test] (trainer.py 167): INFO EPOCH 10 training takes 0:01:24
[2023-09-27 21:24:29 iu_test] (trainer.py 133): INFO 	epoch          : 11
[2023-09-27 21:24:29 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.20637965202331543
[2023-09-27 21:24:29 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.12217246741056442
[2023-09-27 21:24:29 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08573305606842041
[2023-09-27 21:24:29 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06523054838180542
[2023-09-27 21:24:29 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10616510361433029
[2023-09-27 21:24:29 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.297049343585968
[2023-09-27 21:24:29 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3384818136692047
[2023-09-27 21:24:29 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5334030389785767
[2023-09-27 21:24:29 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.25981566309928894
[2023-09-27 21:24:29 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.15921913087368011
[2023-09-27 21:24:29 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.11418154090642929
[2023-09-27 21:24:29 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08763039857149124
[2023-09-27 21:24:29 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.1264280378818512
[2023-09-27 21:24:29 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.32031533122062683
[2023-09-27 21:24:29 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.3890250027179718
[2023-09-27 21:24:29 iu_test] (trainer.py 161): INFO current best model in: 6
[2023-09-27 21:24:30 iu_test] (trainer.py 167): INFO EPOCH 11 training takes 0:01:25
[2023-09-27 21:25:54 iu_test] (trainer.py 133): INFO 	epoch          : 12
[2023-09-27 21:25:54 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.2603955566883087
[2023-09-27 21:25:54 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.15017054975032806
[2023-09-27 21:25:54 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.10086120665073395
[2023-09-27 21:25:54 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.07288836687803268
[2023-09-27 21:25:54 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.11511315405368805
[2023-09-27 21:25:54 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.2983893156051636
[2023-09-27 21:25:54 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2959591746330261
[2023-09-27 21:25:54 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5268996953964233
[2023-09-27 21:25:54 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.3082354962825775
[2023-09-27 21:25:54 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.1869022250175476
[2023-09-27 21:25:54 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.13275524973869324
[2023-09-27 21:25:54 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.10098434239625931
[2023-09-27 21:25:54 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.13569456338882446
[2023-09-27 21:25:54 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3289453983306885
[2023-09-27 21:25:54 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.40664589405059814
[2023-09-27 21:25:54 iu_test] (trainer.py 161): INFO current best model in: 6
[2023-09-27 21:25:55 iu_test] (trainer.py 167): INFO EPOCH 12 training takes 0:01:24
[2023-09-27 21:27:19 iu_test] (trainer.py 133): INFO 	epoch          : 13
[2023-09-27 21:27:19 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.2522698640823364
[2023-09-27 21:27:19 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.14551740884780884
[2023-09-27 21:27:19 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.09618080407381058
[2023-09-27 21:27:19 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06886106729507446
[2023-09-27 21:27:19 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.11824014037847519
[2023-09-27 21:27:19 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.30236300826072693
[2023-09-27 21:27:19 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2645523250102997
[2023-09-27 21:27:19 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5445152521133423
[2023-09-27 21:27:19 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.30081114172935486
[2023-09-27 21:27:19 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.18164928257465363
[2023-09-27 21:27:19 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.12714014947414398
[2023-09-27 21:27:19 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.0954757109284401
[2023-09-27 21:27:19 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.13676674664020538
[2023-09-27 21:27:19 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.32809504866600037
[2023-09-27 21:27:19 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.4148724675178528
[2023-09-27 21:27:19 iu_test] (trainer.py 161): INFO current best model in: 6
[2023-09-27 21:27:20 iu_test] (trainer.py 167): INFO EPOCH 13 training takes 0:01:24
[2023-09-27 21:28:44 iu_test] (trainer.py 133): INFO 	epoch          : 14
[2023-09-27 21:28:44 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.34624242782592773
[2023-09-27 21:28:44 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.2018333524465561
[2023-09-27 21:28:44 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.12962602078914642
[2023-09-27 21:28:44 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.0880768895149231
[2023-09-27 21:28:44 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.14447757601737976
[2023-09-27 21:28:44 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3194301724433899
[2023-09-27 21:28:44 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.21013978123664856
[2023-09-27 21:28:44 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.569196105003357
[2023-09-27 21:28:44 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.3945193588733673
[2023-09-27 21:28:44 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.24379612505435944
[2023-09-27 21:28:44 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.16790293157100677
[2023-09-27 21:28:44 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.12398599088191986
[2023-09-27 21:28:44 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.16512371599674225
[2023-09-27 21:28:44 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.34556999802589417
[2023-09-27 21:28:44 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.4081191122531891
[2023-09-27 21:28:44 iu_test] (trainer.py 161): INFO current best model in: 6
[2023-09-27 21:28:45 iu_test] (trainer.py 167): INFO EPOCH 14 training takes 0:01:25
[2023-09-27 21:32:32 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 21:32:32 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 21:32:33 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 21:33:44 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'resnet101', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 21:33:44 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 21:33:45 iu_test] (main.py 117): INFO number of params: 56954169
[2023-09-27 21:35:12 iu_test] (trainer.py 133): INFO 	epoch          : 1
[2023-09-27 21:35:12 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.2480921745300293
[2023-09-27 21:35:12 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.14768290519714355
[2023-09-27 21:35:12 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.09837942570447922
[2023-09-27 21:35:12 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06918294727802277
[2023-09-27 21:35:12 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.0918319821357727
[2023-09-27 21:35:12 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29714128375053406
[2023-09-27 21:35:12 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.1394197791814804
[2023-09-27 21:35:12 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 3.7069191932678223
[2023-09-27 21:35:12 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.27589914202690125
[2023-09-27 21:35:12 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.16515327990055084
[2023-09-27 21:35:12 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.11083849519491196
[2023-09-27 21:35:12 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.07783450186252594
[2023-09-27 21:35:12 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.10032112151384354
[2023-09-27 21:35:12 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3088124096393585
[2023-09-27 21:35:12 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.14401033520698547
[2023-09-27 21:35:12 iu_test] (trainer.py 161): INFO current best model in: 1
[2023-09-27 21:35:14 iu_test] (trainer.py 167): INFO EPOCH 1 training takes 0:01:28
[2023-09-27 21:36:39 iu_test] (trainer.py 133): INFO 	epoch          : 2
[2023-09-27 21:36:39 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.3221227526664734
[2023-09-27 21:36:39 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.21197539567947388
[2023-09-27 21:36:39 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.15076930820941925
[2023-09-27 21:36:39 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.11367077380418777
[2023-09-27 21:36:39 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.14869780838489532
[2023-09-27 21:36:39 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.35389822721481323
[2023-09-27 21:36:39 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3219132721424103
[2023-09-27 21:36:39 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.54317307472229
[2023-09-27 21:36:39 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.3734743297100067
[2023-09-27 21:36:39 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.24728576838970184
[2023-09-27 21:36:39 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.17745688557624817
[2023-09-27 21:36:39 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.13443145155906677
[2023-09-27 21:36:39 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.16588075459003448
[2023-09-27 21:36:39 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.37087610363960266
[2023-09-27 21:36:39 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.3817463219165802
[2023-09-27 21:36:39 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-27 21:36:41 iu_test] (trainer.py 167): INFO EPOCH 2 training takes 0:01:27
[2023-09-27 21:38:06 iu_test] (trainer.py 133): INFO 	epoch          : 3
[2023-09-27 21:38:06 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 21:38:06 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 21:38:06 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 21:38:06 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 21:38:06 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 21:38:06 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 21:38:06 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 21:38:06 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.1067636013031006
[2023-09-27 21:38:06 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 21:38:06 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 21:38:06 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 21:38:06 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 21:38:06 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 21:38:06 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 21:38:06 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 21:38:06 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-27 21:38:07 iu_test] (trainer.py 167): INFO EPOCH 3 training takes 0:01:26
[2023-09-27 21:39:33 iu_test] (trainer.py 133): INFO 	epoch          : 4
[2023-09-27 21:39:33 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 21:39:33 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 21:39:33 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 21:39:33 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 21:39:33 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 21:39:33 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 21:39:33 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 21:39:33 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.86277437210083
[2023-09-27 21:39:33 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 21:39:33 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 21:39:33 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 21:39:33 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 21:39:33 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 21:39:33 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 21:39:33 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 21:39:33 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-27 21:39:34 iu_test] (trainer.py 167): INFO EPOCH 4 training takes 0:01:26
[2023-09-27 21:41:00 iu_test] (trainer.py 133): INFO 	epoch          : 5
[2023-09-27 21:41:00 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 21:41:00 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 21:41:00 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 21:41:00 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 21:41:00 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 21:41:00 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 21:41:00 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 21:41:00 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.7206615209579468
[2023-09-27 21:41:00 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 21:41:00 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 21:41:00 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 21:41:00 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 21:41:00 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 21:41:00 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 21:41:00 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 21:41:00 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-27 21:41:01 iu_test] (trainer.py 167): INFO EPOCH 5 training takes 0:01:26
[2023-09-27 21:42:26 iu_test] (trainer.py 133): INFO 	epoch          : 6
[2023-09-27 21:42:26 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.43189504742622375
[2023-09-27 21:42:26 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.2750268876552582
[2023-09-27 21:42:26 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.18538950383663177
[2023-09-27 21:42:26 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.12952920794487
[2023-09-27 21:42:26 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.17627815902233124
[2023-09-27 21:42:26 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3301030397415161
[2023-09-27 21:42:26 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2308095246553421
[2023-09-27 21:42:26 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.6316189765930176
[2023-09-27 21:42:26 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4760660231113434
[2023-09-27 21:42:26 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.30854207277297974
[2023-09-27 21:42:26 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.21570897102355957
[2023-09-27 21:42:26 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.158542662858963
[2023-09-27 21:42:26 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.19721442461013794
[2023-09-27 21:42:26 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.35066109895706177
[2023-09-27 21:42:26 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.45055854320526123
[2023-09-27 21:42:26 iu_test] (trainer.py 161): INFO current best model in: 6
[2023-09-27 21:42:28 iu_test] (trainer.py 167): INFO EPOCH 6 training takes 0:01:27
[2023-09-27 21:48:13 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 21:48:13 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 21:49:36 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 21:49:36 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 21:50:33 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 21:50:33 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 21:50:47 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 21:50:47 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 21:52:10 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'input_image_feats': 1024, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 21:52:10 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 21:52:12 iu_test] (main.py 117): INFO number of params: 101197233
[2023-09-27 21:53:13 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'input_image_feats': 1024, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 21:53:13 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 21:53:14 iu_test] (main.py 117): INFO number of params: 101197233
[2023-09-27 21:54:27 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'input_image_feats': 1024, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 21:54:27 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 21:54:28 iu_test] (main.py 117): INFO number of params: 101197233
[2023-09-27 21:55:44 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 21:55:44 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 21:55:45 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 21:57:21 iu_test] (trainer.py 133): INFO 	epoch          : 1
[2023-09-27 21:57:21 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.07648343592882156
[2023-09-27 21:57:21 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.046677377074956894
[2023-09-27 21:57:21 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.033105552196502686
[2023-09-27 21:57:21 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.024846801534295082
[2023-09-27 21:57:21 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.05948254466056824
[2023-09-27 21:57:21 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.24722668528556824
[2023-09-27 21:57:21 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.08521709591150284
[2023-09-27 21:57:21 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 3.633880615234375
[2023-09-27 21:57:21 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.09573978930711746
[2023-09-27 21:57:21 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.060061849653720856
[2023-09-27 21:57:21 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.04362951219081879
[2023-09-27 21:57:21 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.03277241066098213
[2023-09-27 21:57:21 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.06849377602338791
[2023-09-27 21:57:21 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.2682456076145172
[2023-09-27 21:57:21 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.09512093663215637
[2023-09-27 21:57:21 iu_test] (trainer.py 161): INFO current best model in: 1
[2023-09-27 21:57:24 iu_test] (trainer.py 167): INFO EPOCH 1 training takes 0:01:39
[2023-09-27 21:59:02 iu_test] (trainer.py 133): INFO 	epoch          : 2
[2023-09-27 21:59:02 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.3221227526664734
[2023-09-27 21:59:02 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.21197539567947388
[2023-09-27 21:59:02 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.15076930820941925
[2023-09-27 21:59:02 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.11367077380418777
[2023-09-27 21:59:02 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.14869780838489532
[2023-09-27 21:59:02 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.35389822721481323
[2023-09-27 21:59:02 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3219132721424103
[2023-09-27 21:59:02 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.4810869693756104
[2023-09-27 21:59:02 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.3734743297100067
[2023-09-27 21:59:02 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.24728576838970184
[2023-09-27 21:59:02 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.17745688557624817
[2023-09-27 21:59:02 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.13443145155906677
[2023-09-27 21:59:02 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.16588075459003448
[2023-09-27 21:59:02 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.37087610363960266
[2023-09-27 21:59:02 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.3817463219165802
[2023-09-27 21:59:02 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-27 21:59:05 iu_test] (trainer.py 167): INFO EPOCH 2 training takes 0:01:40
[2023-09-27 22:00:41 iu_test] (trainer.py 133): INFO 	epoch          : 3
[2023-09-27 22:00:41 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.3888028562068939
[2023-09-27 22:00:41 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.25001078844070435
[2023-09-27 22:00:41 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.17879508435726166
[2023-09-27 22:00:41 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.13529914617538452
[2023-09-27 22:00:41 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.16010749340057373
[2023-09-27 22:00:41 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3650689125061035
[2023-09-27 22:00:41 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3653295636177063
[2023-09-27 22:00:41 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.094273328781128
[2023-09-27 22:00:41 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4350369870662689
[2023-09-27 22:00:41 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.28019413352012634
[2023-09-27 22:00:41 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.20263290405273438
[2023-09-27 22:00:41 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.15501677989959717
[2023-09-27 22:00:41 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.17829711735248566
[2023-09-27 22:00:41 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3772081434726715
[2023-09-27 22:00:41 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.4346838593482971
[2023-09-27 22:00:41 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 22:00:44 iu_test] (trainer.py 167): INFO EPOCH 3 training takes 0:01:38
[2023-09-27 22:02:20 iu_test] (trainer.py 133): INFO 	epoch          : 4
[2023-09-27 22:02:20 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 22:02:20 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 22:02:20 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 22:02:20 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 22:02:20 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 22:02:20 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 22:02:20 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 22:02:20 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.8790161609649658
[2023-09-27 22:02:20 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 22:02:20 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 22:02:20 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 22:02:20 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 22:02:20 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 22:02:20 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 22:02:20 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 22:02:20 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 22:02:22 iu_test] (trainer.py 167): INFO EPOCH 4 training takes 0:01:37
[2023-09-27 22:03:58 iu_test] (trainer.py 133): INFO 	epoch          : 5
[2023-09-27 22:03:58 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.20203258097171783
[2023-09-27 22:03:58 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11903396993875504
[2023-09-27 22:03:58 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.0838208943605423
[2023-09-27 22:03:58 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06377910822629929
[2023-09-27 22:03:58 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10386062413454056
[2023-09-27 22:03:58 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.2954493463039398
[2023-09-27 22:03:58 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.30114084482192993
[2023-09-27 22:03:58 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.7460349798202515
[2023-09-27 22:03:58 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24493010342121124
[2023-09-27 22:03:58 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.1489468663930893
[2023-09-27 22:03:58 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10717238485813141
[2023-09-27 22:03:58 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08252441883087158
[2023-09-27 22:03:58 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.12070227414369583
[2023-09-27 22:03:58 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3133714199066162
[2023-09-27 22:03:58 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.3589686155319214
[2023-09-27 22:03:58 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 22:04:00 iu_test] (trainer.py 167): INFO EPOCH 5 training takes 0:01:37
[2023-09-27 22:05:34 iu_test] (trainer.py 133): INFO 	epoch          : 6
[2023-09-27 22:05:34 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 22:05:34 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 22:05:34 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 22:05:34 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 22:05:34 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 22:05:34 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 22:05:34 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 22:05:34 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.642655372619629
[2023-09-27 22:05:34 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 22:05:34 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 22:05:34 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 22:05:34 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 22:05:34 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 22:05:34 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 22:05:34 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 22:05:34 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 22:05:36 iu_test] (trainer.py 167): INFO EPOCH 6 training takes 0:01:36
[2023-09-27 22:07:11 iu_test] (trainer.py 133): INFO 	epoch          : 7
[2023-09-27 22:07:11 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 22:07:11 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 22:07:11 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 22:07:11 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 22:07:11 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 22:07:11 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 22:07:11 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 22:07:11 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5725370645523071
[2023-09-27 22:07:11 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 22:07:11 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 22:07:11 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 22:07:11 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 22:07:11 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 22:07:11 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 22:07:11 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 22:07:11 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 22:07:13 iu_test] (trainer.py 167): INFO EPOCH 7 training takes 0:01:37
[2023-09-27 22:07:30 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:07:30 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:07:32 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:09:19 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:09:19 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:09:20 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:09:31 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:09:31 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:09:32 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:11:10 iu_test] (trainer.py 133): INFO 	epoch          : 1
[2023-09-27 22:11:10 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.0017342005157843232
[2023-09-27 22:11:10 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.0012188628315925598
[2023-09-27 22:11:10 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.001012495718896389
[2023-09-27 22:11:10 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.0008506393060088158
[2023-09-27 22:11:10 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.03612038120627403
[2023-09-27 22:11:10 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.1630064696073532
[2023-09-27 22:11:10 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.034587908536195755
[2023-09-27 22:11:10 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 3.555478096008301
[2023-09-27 22:11:10 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.0033335802145302296
[2023-09-27 22:11:10 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.002466827630996704
[2023-09-27 22:11:10 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.0020796300377696753
[2023-09-27 22:11:10 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.0017352665308862925
[2023-09-27 22:11:10 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.044007785618305206
[2023-09-27 22:11:10 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.18684543669223785
[2023-09-27 22:11:10 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.04431045800447464
[2023-09-27 22:11:10 iu_test] (trainer.py 161): INFO current best model in: 1
[2023-09-27 22:11:13 iu_test] (trainer.py 167): INFO EPOCH 1 training takes 0:01:40
[2023-09-27 22:14:24 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:14:24 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:14:25 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:15:11 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:15:11 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:15:12 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:15:46 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:15:46 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:15:47 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:16:47 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:16:47 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:16:48 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:17:46 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:17:46 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:17:47 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:18:27 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:18:27 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:18:29 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:19:05 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:19:05 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:19:06 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:19:38 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:19:38 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:19:47 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:19:47 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:19:48 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:20:22 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:20:22 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:20:23 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:20:51 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:20:51 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:20:53 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:21:36 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:21:36 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:21:37 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:23:29 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:23:29 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:23:30 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:26:37 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:26:37 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:26:38 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:30:37 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:30:37 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:30:39 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:30:49 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:30:49 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:30:50 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:31:10 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:31:10 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:31:12 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:35:20 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:35:20 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:35:21 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:35:37 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:35:37 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:35:38 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:35:54 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:35:54 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:35:55 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:38:51 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:38:51 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:38:52 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:43:04 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:43:04 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:43:05 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:43:31 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:43:31 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:43:33 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:45:58 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:45:58 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:46:00 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:46:23 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:46:23 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:46:24 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:47:40 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:47:40 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:47:41 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:47:54 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:47:54 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:47:55 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:49:23 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:49:23 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:49:24 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:49:56 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:49:56 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:49:57 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:52:18 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:52:18 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:52:19 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:52:57 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:52:57 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:52:58 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:57:25 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:57:25 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:57:26 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 22:59:55 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 22:59:55 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 22:59:56 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 23:01:49 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 23:01:49 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 23:01:50 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 23:02:06 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 23:02:06 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 23:02:18 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 23:02:18 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 23:02:19 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 23:04:42 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 23:04:42 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 23:04:44 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 23:06:18 iu_test] (trainer.py 133): INFO 	epoch          : 1
[2023-09-27 23:06:18 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.09361305087804794
[2023-09-27 23:06:18 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.057364363223314285
[2023-09-27 23:06:18 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.040199391543865204
[2023-09-27 23:06:18 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.02968757413327694
[2023-09-27 23:06:18 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.06477510184049606
[2023-09-27 23:06:18 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.25486481189727783
[2023-09-27 23:06:18 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.09362845122814178
[2023-09-27 23:06:18 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 3.63309907913208
[2023-09-27 23:06:18 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.11985301971435547
[2023-09-27 23:06:18 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.07489612698554993
[2023-09-27 23:06:18 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.053560394793748856
[2023-09-27 23:06:18 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.039827827364206314
[2023-09-27 23:06:18 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.07652962952852249
[2023-09-27 23:06:18 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.2801854908466339
[2023-09-27 23:06:18 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.1136159896850586
[2023-09-27 23:06:18 iu_test] (trainer.py 161): INFO current best model in: 1
[2023-09-27 23:06:21 iu_test] (trainer.py 167): INFO EPOCH 1 training takes 0:01:37
[2023-09-27 23:07:54 iu_test] (trainer.py 133): INFO 	epoch          : 2
[2023-09-27 23:07:54 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.3463851511478424
[2023-09-27 23:07:54 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.22230872511863708
[2023-09-27 23:07:54 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.15676061809062958
[2023-09-27 23:07:54 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.11826136708259583
[2023-09-27 23:07:54 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.15151144564151764
[2023-09-27 23:07:54 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3583361804485321
[2023-09-27 23:07:54 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3153131902217865
[2023-09-27 23:07:54 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.482707977294922
[2023-09-27 23:07:54 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.3936794698238373
[2023-09-27 23:07:54 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2523171603679657
[2023-09-27 23:07:54 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.17823240160942078
[2023-09-27 23:07:54 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.13419906795024872
[2023-09-27 23:07:54 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.1668950468301773
[2023-09-27 23:07:54 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3708335757255554
[2023-09-27 23:07:54 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.3608323633670807
[2023-09-27 23:07:54 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-27 23:07:57 iu_test] (trainer.py 167): INFO EPOCH 2 training takes 0:01:36
[2023-09-27 23:09:31 iu_test] (trainer.py 133): INFO 	epoch          : 3
[2023-09-27 23:09:31 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.36534687876701355
[2023-09-27 23:09:31 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.23351259529590607
[2023-09-27 23:09:31 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.16444098949432373
[2023-09-27 23:09:31 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.12447153031826019
[2023-09-27 23:09:31 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.15721972286701202
[2023-09-27 23:09:31 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3605540692806244
[2023-09-27 23:09:31 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3811596930027008
[2023-09-27 23:09:31 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.0941178798675537
[2023-09-27 23:09:31 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4146279990673065
[2023-09-27 23:09:31 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2654428780078888
[2023-09-27 23:09:31 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.18800215423107147
[2023-09-27 23:09:31 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.14241330325603485
[2023-09-27 23:09:31 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.17518000304698944
[2023-09-27 23:09:31 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3742557466030121
[2023-09-27 23:09:31 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.4262000620365143
[2023-09-27 23:09:31 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 23:09:34 iu_test] (trainer.py 167): INFO EPOCH 3 training takes 0:01:36
[2023-09-27 23:11:06 iu_test] (trainer.py 133): INFO 	epoch          : 4
[2023-09-27 23:11:06 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 23:11:06 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 23:11:06 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 23:11:06 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 23:11:06 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 23:11:06 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 23:11:06 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 23:11:06 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.879473090171814
[2023-09-27 23:11:06 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 23:11:06 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 23:11:06 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 23:11:06 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 23:11:06 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 23:11:06 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 23:11:06 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 23:11:06 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 23:11:08 iu_test] (trainer.py 167): INFO EPOCH 4 training takes 0:01:34
[2023-09-27 23:12:40 iu_test] (trainer.py 133): INFO 	epoch          : 5
[2023-09-27 23:12:40 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 23:12:40 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 23:12:40 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 23:12:40 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 23:12:40 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 23:12:40 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 23:12:40 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 23:12:40 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.7540627717971802
[2023-09-27 23:12:40 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 23:12:40 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 23:12:40 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 23:12:40 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 23:12:40 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 23:12:40 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 23:12:40 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 23:12:40 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 23:12:41 iu_test] (trainer.py 167): INFO EPOCH 5 training takes 0:01:33
[2023-09-27 23:14:13 iu_test] (trainer.py 133): INFO 	epoch          : 6
[2023-09-27 23:14:13 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 23:14:13 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 23:14:13 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 23:14:13 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 23:14:13 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 23:14:13 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 23:14:13 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 23:14:13 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.642575979232788
[2023-09-27 23:14:13 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 23:14:13 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 23:14:13 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 23:14:13 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 23:14:13 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 23:14:13 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 23:14:13 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 23:14:13 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 23:14:15 iu_test] (trainer.py 167): INFO EPOCH 6 training takes 0:01:33
[2023-09-27 23:15:46 iu_test] (trainer.py 133): INFO 	epoch          : 7
[2023-09-27 23:15:46 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 23:15:46 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 23:15:46 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 23:15:46 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 23:15:46 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 23:15:46 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 23:15:46 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 23:15:46 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5757319927215576
[2023-09-27 23:15:46 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 23:15:46 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 23:15:46 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 23:15:46 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 23:15:46 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 23:15:46 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 23:15:46 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 23:15:46 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 23:15:48 iu_test] (trainer.py 167): INFO EPOCH 7 training takes 0:01:32
[2023-09-27 23:17:25 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0001, 'lr_ed': 0.0002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 23:17:25 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 23:17:26 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 23:18:59 iu_test] (trainer.py 133): INFO 	epoch          : 1
[2023-09-27 23:18:59 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.09361305087804794
[2023-09-27 23:18:59 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.057364363223314285
[2023-09-27 23:18:59 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.040199391543865204
[2023-09-27 23:18:59 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.02968757413327694
[2023-09-27 23:18:59 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.06477510184049606
[2023-09-27 23:18:59 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.25486481189727783
[2023-09-27 23:18:59 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.09362845122814178
[2023-09-27 23:18:59 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 3.63309907913208
[2023-09-27 23:18:59 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.11985301971435547
[2023-09-27 23:18:59 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.07489612698554993
[2023-09-27 23:18:59 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.053560394793748856
[2023-09-27 23:18:59 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.039827827364206314
[2023-09-27 23:18:59 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.07652962952852249
[2023-09-27 23:18:59 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.2801854908466339
[2023-09-27 23:18:59 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.1136159896850586
[2023-09-27 23:18:59 iu_test] (trainer.py 161): INFO current best model in: 1
[2023-09-27 23:19:02 iu_test] (trainer.py 167): INFO EPOCH 1 training takes 0:01:36
[2023-09-27 23:20:36 iu_test] (trainer.py 133): INFO 	epoch          : 2
[2023-09-27 23:20:36 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.3463851511478424
[2023-09-27 23:20:36 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.22230872511863708
[2023-09-27 23:20:36 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.15676061809062958
[2023-09-27 23:20:36 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.11826136708259583
[2023-09-27 23:20:36 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.15151144564151764
[2023-09-27 23:20:36 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3583361804485321
[2023-09-27 23:20:36 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3153131902217865
[2023-09-27 23:20:36 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.482707977294922
[2023-09-27 23:20:36 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.3936794698238373
[2023-09-27 23:20:36 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2523171603679657
[2023-09-27 23:20:36 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.17823240160942078
[2023-09-27 23:20:36 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.13419906795024872
[2023-09-27 23:20:36 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.1668950468301773
[2023-09-27 23:20:36 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3708335757255554
[2023-09-27 23:20:36 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.3608323633670807
[2023-09-27 23:20:36 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-27 23:20:39 iu_test] (trainer.py 167): INFO EPOCH 2 training takes 0:01:36
[2023-09-27 23:22:11 iu_test] (trainer.py 133): INFO 	epoch          : 3
[2023-09-27 23:22:11 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.36534687876701355
[2023-09-27 23:22:11 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.23351259529590607
[2023-09-27 23:22:11 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.16444098949432373
[2023-09-27 23:22:11 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.12447153031826019
[2023-09-27 23:22:11 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.15721972286701202
[2023-09-27 23:22:11 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3605540692806244
[2023-09-27 23:22:11 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3811596930027008
[2023-09-27 23:22:11 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.0941178798675537
[2023-09-27 23:22:11 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4146279990673065
[2023-09-27 23:22:11 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2654428780078888
[2023-09-27 23:22:11 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.18800215423107147
[2023-09-27 23:22:11 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.14241330325603485
[2023-09-27 23:22:11 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.17518000304698944
[2023-09-27 23:22:11 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3742557466030121
[2023-09-27 23:22:11 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.4262000620365143
[2023-09-27 23:22:11 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 23:22:14 iu_test] (trainer.py 167): INFO EPOCH 3 training takes 0:01:35
[2023-09-27 23:23:47 iu_test] (trainer.py 133): INFO 	epoch          : 4
[2023-09-27 23:23:47 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 23:23:47 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 23:23:47 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 23:23:47 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 23:23:47 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 23:23:47 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 23:23:47 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 23:23:47 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.879473090171814
[2023-09-27 23:23:47 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 23:23:47 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 23:23:47 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 23:23:47 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 23:23:47 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 23:23:47 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 23:23:47 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 23:23:47 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 23:23:48 iu_test] (trainer.py 167): INFO EPOCH 4 training takes 0:01:34
[2023-09-27 23:25:21 iu_test] (trainer.py 133): INFO 	epoch          : 5
[2023-09-27 23:25:21 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 23:25:21 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 23:25:21 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 23:25:21 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 23:25:21 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 23:25:21 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 23:25:21 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 23:25:21 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.7540627717971802
[2023-09-27 23:25:21 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 23:25:21 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 23:25:21 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 23:25:21 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 23:25:21 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 23:25:21 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 23:25:21 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 23:25:21 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 23:25:22 iu_test] (trainer.py 167): INFO EPOCH 5 training takes 0:01:34
[2023-09-27 23:26:56 iu_test] (trainer.py 133): INFO 	epoch          : 6
[2023-09-27 23:26:56 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 23:26:56 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 23:26:56 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 23:26:56 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 23:26:56 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 23:26:56 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 23:26:56 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 23:26:56 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.642575979232788
[2023-09-27 23:26:56 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 23:26:56 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 23:26:56 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 23:26:56 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 23:26:56 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 23:26:56 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 23:26:56 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 23:26:56 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 23:26:57 iu_test] (trainer.py 167): INFO EPOCH 6 training takes 0:01:34
[2023-09-27 23:28:29 iu_test] (trainer.py 133): INFO 	epoch          : 7
[2023-09-27 23:28:29 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 23:28:29 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 23:28:29 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 23:28:29 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 23:28:29 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 23:28:29 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 23:28:29 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 23:28:29 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5757319927215576
[2023-09-27 23:28:29 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 23:28:29 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 23:28:29 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 23:28:29 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 23:28:29 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 23:28:29 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 23:28:29 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 23:28:29 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 23:28:30 iu_test] (trainer.py 167): INFO EPOCH 7 training takes 0:01:32
[2023-09-27 23:30:03 iu_test] (trainer.py 133): INFO 	epoch          : 8
[2023-09-27 23:30:03 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 23:30:03 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 23:30:03 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 23:30:03 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 23:30:03 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 23:30:03 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 23:30:03 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 23:30:03 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5478154420852661
[2023-09-27 23:30:03 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 23:30:03 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 23:30:03 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 23:30:03 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 23:30:03 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 23:30:03 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 23:30:03 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 23:30:03 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 23:30:04 iu_test] (trainer.py 167): INFO EPOCH 8 training takes 0:01:34
[2023-09-27 23:32:09 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 5e-05, 'lr_ed': 0.0001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 23:32:09 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 23:32:10 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 23:33:46 iu_test] (trainer.py 133): INFO 	epoch          : 1
[2023-09-27 23:33:46 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.14337942004203796
[2023-09-27 23:33:46 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.04945312440395355
[2023-09-27 23:33:46 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.01023081224411726
[2023-09-27 23:33:46 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 5.616580551759398e-07
[2023-09-27 23:33:46 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.03744375705718994
[2023-09-27 23:33:46 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.21631765365600586
[2023-09-27 23:33:46 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.0109383100643754
[2023-09-27 23:33:46 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 4.390860080718994
[2023-09-27 23:33:46 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.15900586545467377
[2023-09-27 23:33:46 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.054178379476070404
[2023-09-27 23:33:46 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.012536189518868923
[2023-09-27 23:33:46 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 5.731176315748598e-07
[2023-09-27 23:33:46 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.0393829271197319
[2023-09-27 23:33:46 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.21504779160022736
[2023-09-27 23:33:46 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.012960516847670078
[2023-09-27 23:33:46 iu_test] (trainer.py 161): INFO current best model in: 1
[2023-09-27 23:33:49 iu_test] (trainer.py 167): INFO EPOCH 1 training takes 0:01:39
[2023-09-27 23:35:23 iu_test] (trainer.py 133): INFO 	epoch          : 2
[2023-09-27 23:35:23 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.3111499547958374
[2023-09-27 23:35:23 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.1983894258737564
[2023-09-27 23:35:23 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.13613125681877136
[2023-09-27 23:35:23 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.09926947206258774
[2023-09-27 23:35:23 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.13778017461299896
[2023-09-27 23:35:23 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.35394901037216187
[2023-09-27 23:35:23 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2558637857437134
[2023-09-27 23:35:23 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.9275171756744385
[2023-09-27 23:35:23 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.35835087299346924
[2023-09-27 23:35:23 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.22877910733222961
[2023-09-27 23:35:23 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.15814988315105438
[2023-09-27 23:35:23 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.11548837274312973
[2023-09-27 23:35:23 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.15334339439868927
[2023-09-27 23:35:23 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.36621519923210144
[2023-09-27 23:35:23 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.3035193085670471
[2023-09-27 23:35:23 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-27 23:35:26 iu_test] (trainer.py 167): INFO EPOCH 2 training takes 0:01:36
[2023-09-27 23:36:58 iu_test] (trainer.py 133): INFO 	epoch          : 3
[2023-09-27 23:36:58 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.3594028055667877
[2023-09-27 23:36:58 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.22559362649917603
[2023-09-27 23:36:58 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.1567411571741104
[2023-09-27 23:36:58 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.1170346811413765
[2023-09-27 23:36:58 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.1517009735107422
[2023-09-27 23:36:58 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3606981635093689
[2023-09-27 23:36:58 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.30837056040763855
[2023-09-27 23:36:58 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.41019868850708
[2023-09-27 23:36:58 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.40800851583480835
[2023-09-27 23:36:58 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.25438907742500305
[2023-09-27 23:36:58 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.1772356778383255
[2023-09-27 23:36:58 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.1325668841600418
[2023-09-27 23:36:58 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.16745369136333466
[2023-09-27 23:36:58 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.37204718589782715
[2023-09-27 23:36:58 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34491270780563354
[2023-09-27 23:36:58 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 23:37:01 iu_test] (trainer.py 167): INFO EPOCH 3 training takes 0:01:35
[2023-09-27 23:38:33 iu_test] (trainer.py 133): INFO 	epoch          : 4
[2023-09-27 23:38:33 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 23:38:33 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 23:38:33 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 23:38:33 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 23:38:33 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 23:38:33 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 23:38:33 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 23:38:33 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.1334762573242188
[2023-09-27 23:38:33 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24194936454296112
[2023-09-27 23:38:33 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14687173068523407
[2023-09-27 23:38:33 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10567884892225266
[2023-09-27 23:38:33 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08118468523025513
[2023-09-27 23:38:33 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11957735568284988
[2023-09-27 23:38:33 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.31236532330513
[2023-09-27 23:38:33 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.3441663086414337
[2023-09-27 23:38:33 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 23:38:35 iu_test] (trainer.py 167): INFO EPOCH 4 training takes 0:01:33
[2023-09-27 23:40:08 iu_test] (trainer.py 133): INFO 	epoch          : 5
[2023-09-27 23:40:08 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 23:40:08 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 23:40:08 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 23:40:08 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 23:40:08 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 23:40:08 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 23:40:08 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 23:40:08 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.9316235780715942
[2023-09-27 23:40:08 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 23:40:08 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 23:40:08 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 23:40:08 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 23:40:08 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 23:40:08 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 23:40:08 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 23:40:08 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 23:40:09 iu_test] (trainer.py 167): INFO EPOCH 5 training takes 0:01:34
[2023-09-27 23:41:42 iu_test] (trainer.py 133): INFO 	epoch          : 6
[2023-09-27 23:41:42 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 23:41:42 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 23:41:42 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 23:41:42 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 23:41:42 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 23:41:42 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 23:41:42 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 23:41:42 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.7975976467132568
[2023-09-27 23:41:42 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 23:41:42 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 23:41:42 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 23:41:42 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 23:41:42 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 23:41:42 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 23:41:42 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 23:41:42 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 23:41:44 iu_test] (trainer.py 167): INFO EPOCH 6 training takes 0:01:34
[2023-09-27 23:43:16 iu_test] (trainer.py 133): INFO 	epoch          : 7
[2023-09-27 23:43:16 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 23:43:16 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 23:43:16 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 23:43:16 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 23:43:16 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 23:43:16 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 23:43:16 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 23:43:16 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.7005436420440674
[2023-09-27 23:43:16 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 23:43:16 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 23:43:16 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 23:43:16 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 23:43:16 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 23:43:16 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 23:43:16 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 23:43:16 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 23:43:18 iu_test] (trainer.py 167): INFO EPOCH 7 training takes 0:01:34
[2023-09-27 23:44:49 iu_test] (trainer.py 133): INFO 	epoch          : 8
[2023-09-27 23:44:49 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 23:44:49 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 23:44:49 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 23:44:49 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 23:44:49 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 23:44:49 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 23:44:49 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 23:44:49 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.640458106994629
[2023-09-27 23:44:49 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 23:44:49 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 23:44:49 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 23:44:49 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 23:44:49 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 23:44:49 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 23:44:49 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 23:44:49 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 23:44:51 iu_test] (trainer.py 167): INFO EPOCH 8 training takes 0:01:33
[2023-09-27 23:46:23 iu_test] (trainer.py 133): INFO 	epoch          : 9
[2023-09-27 23:46:23 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 23:46:23 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 23:46:23 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 23:46:23 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 23:46:23 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 23:46:23 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 23:46:23 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 23:46:23 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.6036415100097656
[2023-09-27 23:46:23 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 23:46:23 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 23:46:23 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 23:46:23 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 23:46:23 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 23:46:23 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 23:46:23 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 23:46:23 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 23:46:24 iu_test] (trainer.py 167): INFO EPOCH 9 training takes 0:01:33
[2023-09-27 23:47:58 iu_test] (trainer.py 133): INFO 	epoch          : 10
[2023-09-27 23:47:58 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 23:47:58 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 23:47:58 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 23:47:58 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 23:47:58 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 23:47:58 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 23:47:58 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 23:47:58 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5846539735794067
[2023-09-27 23:47:58 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 23:47:58 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 23:47:58 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 23:47:58 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 23:47:58 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 23:47:58 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 23:47:58 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 23:47:58 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 23:48:00 iu_test] (trainer.py 167): INFO EPOCH 10 training takes 0:01:35
[2023-09-27 23:49:32 iu_test] (trainer.py 133): INFO 	epoch          : 11
[2023-09-27 23:49:32 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 23:49:32 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 23:49:32 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 23:49:32 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 23:49:32 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 23:49:32 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 23:49:32 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 23:49:32 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5508345365524292
[2023-09-27 23:49:32 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 23:49:32 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 23:49:32 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 23:49:32 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 23:49:32 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 23:49:32 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 23:49:32 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 23:49:32 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 23:49:33 iu_test] (trainer.py 167): INFO EPOCH 11 training takes 0:01:33
[2023-09-27 23:51:05 iu_test] (trainer.py 133): INFO 	epoch          : 12
[2023-09-27 23:51:05 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-27 23:51:05 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-27 23:51:05 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-27 23:51:05 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-27 23:51:05 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-27 23:51:05 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-27 23:51:05 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-27 23:51:05 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.5319373607635498
[2023-09-27 23:51:05 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-27 23:51:05 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-27 23:51:05 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-27 23:51:05 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-27 23:51:05 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-27 23:51:05 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-27 23:51:05 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-27 23:51:05 iu_test] (trainer.py 161): INFO current best model in: 3
[2023-09-27 23:51:07 iu_test] (trainer.py 167): INFO EPOCH 12 training takes 0:01:33
[2023-09-27 23:52:36 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-27 23:52:36 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-27 23:52:37 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-27 23:54:11 iu_test] (trainer.py 133): INFO 	epoch          : 1
[2023-09-27 23:54:11 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.27041196823120117
[2023-09-27 23:54:11 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.1766764521598816
[2023-09-27 23:54:11 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.12598539888858795
[2023-09-27 23:54:11 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.09560471773147583
[2023-09-27 23:54:11 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.1457161158323288
[2023-09-27 23:54:11 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3608664572238922
[2023-09-27 23:54:11 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.32191208004951477
[2023-09-27 23:54:11 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.4575307369232178
[2023-09-27 23:54:11 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.3208436071872711
[2023-09-27 23:54:11 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.20891520380973816
[2023-09-27 23:54:11 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.1495012491941452
[2023-09-27 23:54:11 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.11374286562204361
[2023-09-27 23:54:11 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.1619422733783722
[2023-09-27 23:54:11 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.37899112701416016
[2023-09-27 23:54:11 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.3510761559009552
[2023-09-27 23:54:11 iu_test] (trainer.py 161): INFO current best model in: 1
[2023-09-27 23:54:14 iu_test] (trainer.py 167): INFO EPOCH 1 training takes 0:01:37
[2023-09-27 23:55:48 iu_test] (trainer.py 133): INFO 	epoch          : 2
[2023-09-27 23:55:48 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.4557066857814789
[2023-09-27 23:55:48 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.29322442412376404
[2023-09-27 23:55:48 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.2000940591096878
[2023-09-27 23:55:48 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.14349885284900665
[2023-09-27 23:55:48 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.1889062225818634
[2023-09-27 23:55:48 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3560945987701416
[2023-09-27 23:55:48 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.31388023495674133
[2023-09-27 23:55:48 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.9244552850723267
[2023-09-27 23:55:48 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4918595254421234
[2023-09-27 23:55:48 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.3177638649940491
[2023-09-27 23:55:48 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.22013604640960693
[2023-09-27 23:55:48 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.16160617768764496
[2023-09-27 23:55:48 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.20546260476112366
[2023-09-27 23:55:48 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.37178555130958557
[2023-09-27 23:55:48 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.4145509898662567
[2023-09-27 23:55:48 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-27 23:55:51 iu_test] (trainer.py 167): INFO EPOCH 2 training takes 0:01:36
[2023-09-27 23:57:24 iu_test] (trainer.py 133): INFO 	epoch          : 3
[2023-09-27 23:57:24 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.27290239930152893
[2023-09-27 23:57:24 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.14215154945850372
[2023-09-27 23:57:24 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08294909447431564
[2023-09-27 23:57:24 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.053332697600126266
[2023-09-27 23:57:24 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.11918573826551437
[2023-09-27 23:57:24 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.2987513244152069
[2023-09-27 23:57:24 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2019057273864746
[2023-09-27 23:57:24 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.7757353782653809
[2023-09-27 23:57:24 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.31625446677207947
[2023-09-27 23:57:24 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.17395368218421936
[2023-09-27 23:57:24 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10964535921812057
[2023-09-27 23:57:24 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.0761038139462471
[2023-09-27 23:57:24 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.1348991096019745
[2023-09-27 23:57:24 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.32122552394866943
[2023-09-27 23:57:24 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.3527339696884155
[2023-09-27 23:57:24 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-27 23:57:26 iu_test] (trainer.py 167): INFO EPOCH 3 training takes 0:01:34
[2023-09-27 23:58:58 iu_test] (trainer.py 133): INFO 	epoch          : 4
[2023-09-27 23:58:58 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.2733844518661499
[2023-09-27 23:58:58 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.14193563163280487
[2023-09-27 23:58:58 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08301908522844315
[2023-09-27 23:58:58 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.05339279770851135
[2023-09-27 23:58:58 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.11873957514762878
[2023-09-27 23:58:58 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.297804594039917
[2023-09-27 23:58:58 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2023402601480484
[2023-09-27 23:58:58 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.7226591110229492
[2023-09-27 23:58:58 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.31685468554496765
[2023-09-27 23:58:58 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.17386473715305328
[2023-09-27 23:58:58 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10947026312351227
[2023-09-27 23:58:58 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.07594650238752365
[2023-09-27 23:58:58 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.13473306596279144
[2023-09-27 23:58:58 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3210718631744385
[2023-09-27 23:58:58 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.35282883048057556
[2023-09-27 23:58:58 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-27 23:59:00 iu_test] (trainer.py 167): INFO EPOCH 4 training takes 0:01:34
[2023-09-28 00:00:33 iu_test] (trainer.py 133): INFO 	epoch          : 5
[2023-09-28 00:00:33 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.2737051546573639
[2023-09-28 00:00:33 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.16420018672943115
[2023-09-28 00:00:33 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.10324333608150482
[2023-09-28 00:00:33 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.07269097864627838
[2023-09-28 00:00:33 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.13928775489330292
[2023-09-28 00:00:33 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29999256134033203
[2023-09-28 00:00:33 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.11715175956487656
[2023-09-28 00:00:33 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.7098768949508667
[2023-09-28 00:00:33 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.30307334661483765
[2023-09-28 00:00:33 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.18111303448677063
[2023-09-28 00:00:33 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.11329979449510574
[2023-09-28 00:00:33 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.07833016663789749
[2023-09-28 00:00:33 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.15047188103199005
[2023-09-28 00:00:33 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.30716487765312195
[2023-09-28 00:00:33 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.18757766485214233
[2023-09-28 00:00:33 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:00:34 iu_test] (trainer.py 167): INFO EPOCH 5 training takes 0:01:34
[2023-09-28 00:02:09 iu_test] (trainer.py 133): INFO 	epoch          : 6
[2023-09-28 00:02:09 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.4073777496814728
[2023-09-28 00:02:09 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.26216354966163635
[2023-09-28 00:02:09 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.18052977323532104
[2023-09-28 00:02:09 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.13073201477527618
[2023-09-28 00:02:09 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.17834334075450897
[2023-09-28 00:02:09 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.34469494223594666
[2023-09-28 00:02:09 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2921835780143738
[2023-09-28 00:02:09 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.6846086978912354
[2023-09-28 00:02:09 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.44966787099838257
[2023-09-28 00:02:09 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.29046469926834106
[2023-09-28 00:02:09 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.20255666971206665
[2023-09-28 00:02:09 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.15011553466320038
[2023-09-28 00:02:09 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.1935088038444519
[2023-09-28 00:02:09 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.36180874705314636
[2023-09-28 00:02:09 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.4107096791267395
[2023-09-28 00:02:09 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:02:10 iu_test] (trainer.py 167): INFO EPOCH 6 training takes 0:01:35
[2023-09-28 00:03:44 iu_test] (trainer.py 133): INFO 	epoch          : 7
[2023-09-28 00:03:44 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.2733844518661499
[2023-09-28 00:03:44 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.14193563163280487
[2023-09-28 00:03:44 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08301908522844315
[2023-09-28 00:03:44 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.05339279770851135
[2023-09-28 00:03:44 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.11873957514762878
[2023-09-28 00:03:44 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.297804594039917
[2023-09-28 00:03:44 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2023402601480484
[2023-09-28 00:03:44 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.6766815185546875
[2023-09-28 00:03:44 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.31685468554496765
[2023-09-28 00:03:44 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.17386473715305328
[2023-09-28 00:03:44 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10947026312351227
[2023-09-28 00:03:44 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.07594650238752365
[2023-09-28 00:03:44 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.13473306596279144
[2023-09-28 00:03:44 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3210718631744385
[2023-09-28 00:03:44 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.35282883048057556
[2023-09-28 00:03:44 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:03:46 iu_test] (trainer.py 167): INFO EPOCH 7 training takes 0:01:35
[2023-09-28 00:05:19 iu_test] (trainer.py 133): INFO 	epoch          : 8
[2023-09-28 00:05:19 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 00:05:19 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 00:05:19 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 00:05:19 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 00:05:19 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 00:05:19 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 00:05:19 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 00:05:19 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.6568878889083862
[2023-09-28 00:05:19 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 00:05:19 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 00:05:19 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 00:05:19 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 00:05:19 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 00:05:19 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 00:05:19 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 00:05:19 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:05:21 iu_test] (trainer.py 167): INFO EPOCH 8 training takes 0:01:34
[2023-09-28 00:06:53 iu_test] (trainer.py 133): INFO 	epoch          : 9
[2023-09-28 00:06:53 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 00:06:53 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 00:06:53 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 00:06:53 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 00:06:53 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 00:06:53 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 00:06:53 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 00:06:53 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.687831997871399
[2023-09-28 00:06:53 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 00:06:53 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 00:06:53 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 00:06:53 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 00:06:53 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 00:06:53 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 00:06:53 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 00:06:53 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:06:54 iu_test] (trainer.py 167): INFO EPOCH 9 training takes 0:01:33
[2023-09-28 00:08:28 iu_test] (trainer.py 133): INFO 	epoch          : 10
[2023-09-28 00:08:28 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 00:08:28 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 00:08:28 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 00:08:28 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 00:08:28 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 00:08:28 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 00:08:28 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 00:08:28 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.6886454820632935
[2023-09-28 00:08:28 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 00:08:28 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 00:08:28 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 00:08:28 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 00:08:28 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 00:08:28 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 00:08:28 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 00:08:28 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:08:29 iu_test] (trainer.py 167): INFO EPOCH 10 training takes 0:01:34
[2023-09-28 00:10:01 iu_test] (trainer.py 133): INFO 	epoch          : 11
[2023-09-28 00:10:01 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 00:10:01 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 00:10:01 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 00:10:01 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 00:10:01 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 00:10:01 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 00:10:01 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 00:10:01 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.6760644912719727
[2023-09-28 00:10:01 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 00:10:01 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 00:10:01 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 00:10:01 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 00:10:01 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 00:10:01 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 00:10:01 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 00:10:01 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:10:02 iu_test] (trainer.py 167): INFO EPOCH 11 training takes 0:01:33
[2023-09-28 00:13:00 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-28 00:13:00 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-28 00:13:01 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-28 00:14:10 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-28 00:14:10 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-28 00:14:11 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-28 00:14:40 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-28 00:14:40 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-28 00:14:41 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-28 00:15:13 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-28 00:15:13 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-28 00:15:15 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-28 00:15:30 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-28 00:15:30 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-28 00:15:31 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-28 00:17:05 iu_test] (trainer.py 133): INFO 	epoch          : 1
[2023-09-28 00:17:05 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.27041196823120117
[2023-09-28 00:17:05 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.1766764521598816
[2023-09-28 00:17:05 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.12598539888858795
[2023-09-28 00:17:05 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.09560471773147583
[2023-09-28 00:17:05 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.1457161158323288
[2023-09-28 00:17:05 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3608664572238922
[2023-09-28 00:17:05 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.32191208004951477
[2023-09-28 00:17:05 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.4575307369232178
[2023-09-28 00:17:05 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.3208436071872711
[2023-09-28 00:17:05 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.20891520380973816
[2023-09-28 00:17:05 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.1495012491941452
[2023-09-28 00:17:05 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.11374286562204361
[2023-09-28 00:17:05 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.1619422733783722
[2023-09-28 00:17:05 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.37899112701416016
[2023-09-28 00:17:05 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.3510761559009552
[2023-09-28 00:17:05 iu_test] (trainer.py 161): INFO current best model in: 1
[2023-09-28 00:17:08 iu_test] (trainer.py 167): INFO EPOCH 1 training takes 0:01:37
[2023-09-28 00:18:40 iu_test] (trainer.py 133): INFO 	epoch          : 2
[2023-09-28 00:18:40 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.4557066857814789
[2023-09-28 00:18:40 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.29322442412376404
[2023-09-28 00:18:40 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.2000940591096878
[2023-09-28 00:18:40 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.14349885284900665
[2023-09-28 00:18:40 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.1889062225818634
[2023-09-28 00:18:40 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3560945987701416
[2023-09-28 00:18:40 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.31388023495674133
[2023-09-28 00:18:40 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.9244552850723267
[2023-09-28 00:18:40 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4918595254421234
[2023-09-28 00:18:40 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.3177638649940491
[2023-09-28 00:18:40 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.22013604640960693
[2023-09-28 00:18:40 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.16160617768764496
[2023-09-28 00:18:40 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.20546260476112366
[2023-09-28 00:18:40 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.37178555130958557
[2023-09-28 00:18:40 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.4145509898662567
[2023-09-28 00:18:40 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:18:44 iu_test] (trainer.py 167): INFO EPOCH 2 training takes 0:01:35
[2023-09-28 00:20:16 iu_test] (trainer.py 133): INFO 	epoch          : 3
[2023-09-28 00:20:16 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.27290239930152893
[2023-09-28 00:20:16 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.14215154945850372
[2023-09-28 00:20:16 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08294909447431564
[2023-09-28 00:20:16 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.053332697600126266
[2023-09-28 00:20:16 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.11918573826551437
[2023-09-28 00:20:16 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.2987513244152069
[2023-09-28 00:20:16 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2019057273864746
[2023-09-28 00:20:16 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.7757353782653809
[2023-09-28 00:20:16 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.31625446677207947
[2023-09-28 00:20:16 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.17395368218421936
[2023-09-28 00:20:16 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10964535921812057
[2023-09-28 00:20:16 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.0761038139462471
[2023-09-28 00:20:16 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.1348991096019745
[2023-09-28 00:20:16 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.32122552394866943
[2023-09-28 00:20:16 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.3527339696884155
[2023-09-28 00:20:16 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:20:18 iu_test] (trainer.py 167): INFO EPOCH 3 training takes 0:01:34
[2023-09-28 00:21:50 iu_test] (trainer.py 133): INFO 	epoch          : 4
[2023-09-28 00:21:50 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.2733844518661499
[2023-09-28 00:21:50 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.14193563163280487
[2023-09-28 00:21:50 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08301908522844315
[2023-09-28 00:21:50 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.05339279770851135
[2023-09-28 00:21:50 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.11873957514762878
[2023-09-28 00:21:50 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.297804594039917
[2023-09-28 00:21:50 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2023402601480484
[2023-09-28 00:21:50 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.7226591110229492
[2023-09-28 00:21:50 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.31685468554496765
[2023-09-28 00:21:50 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.17386473715305328
[2023-09-28 00:21:50 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10947026312351227
[2023-09-28 00:21:50 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.07594650238752365
[2023-09-28 00:21:50 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.13473306596279144
[2023-09-28 00:21:50 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3210718631744385
[2023-09-28 00:21:50 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.35282883048057556
[2023-09-28 00:21:50 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:21:52 iu_test] (trainer.py 167): INFO EPOCH 4 training takes 0:01:34
[2023-09-28 00:23:25 iu_test] (trainer.py 133): INFO 	epoch          : 5
[2023-09-28 00:23:25 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.2737051546573639
[2023-09-28 00:23:25 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.16420018672943115
[2023-09-28 00:23:25 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.10324333608150482
[2023-09-28 00:23:25 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.07269097864627838
[2023-09-28 00:23:25 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.13928775489330292
[2023-09-28 00:23:25 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29999256134033203
[2023-09-28 00:23:25 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.11715175956487656
[2023-09-28 00:23:25 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.7098768949508667
[2023-09-28 00:23:25 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.30307334661483765
[2023-09-28 00:23:25 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.18111303448677063
[2023-09-28 00:23:25 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.11329979449510574
[2023-09-28 00:23:25 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.07833016663789749
[2023-09-28 00:23:25 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.15047188103199005
[2023-09-28 00:23:25 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.30716487765312195
[2023-09-28 00:23:25 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.18757766485214233
[2023-09-28 00:23:25 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:23:26 iu_test] (trainer.py 167): INFO EPOCH 5 training takes 0:01:34
[2023-09-28 00:24:59 iu_test] (trainer.py 133): INFO 	epoch          : 6
[2023-09-28 00:24:59 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.4073777496814728
[2023-09-28 00:24:59 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.26216354966163635
[2023-09-28 00:24:59 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.18052977323532104
[2023-09-28 00:24:59 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.13073201477527618
[2023-09-28 00:24:59 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.17834334075450897
[2023-09-28 00:24:59 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.34469494223594666
[2023-09-28 00:24:59 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2921835780143738
[2023-09-28 00:24:59 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.6846086978912354
[2023-09-28 00:24:59 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.44966787099838257
[2023-09-28 00:24:59 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.29046469926834106
[2023-09-28 00:24:59 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.20255666971206665
[2023-09-28 00:24:59 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.15011553466320038
[2023-09-28 00:24:59 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.1935088038444519
[2023-09-28 00:24:59 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.36180874705314636
[2023-09-28 00:24:59 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.4107096791267395
[2023-09-28 00:24:59 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:25:01 iu_test] (trainer.py 167): INFO EPOCH 6 training takes 0:01:34
[2023-09-28 00:26:35 iu_test] (trainer.py 133): INFO 	epoch          : 7
[2023-09-28 00:26:35 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.2733844518661499
[2023-09-28 00:26:35 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.14193563163280487
[2023-09-28 00:26:35 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08301908522844315
[2023-09-28 00:26:35 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.05339279770851135
[2023-09-28 00:26:35 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.11873957514762878
[2023-09-28 00:26:35 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.297804594039917
[2023-09-28 00:26:35 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2023402601480484
[2023-09-28 00:26:35 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.6766815185546875
[2023-09-28 00:26:35 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.31685468554496765
[2023-09-28 00:26:35 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.17386473715305328
[2023-09-28 00:26:35 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10947026312351227
[2023-09-28 00:26:35 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.07594650238752365
[2023-09-28 00:26:35 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.13473306596279144
[2023-09-28 00:26:35 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3210718631744385
[2023-09-28 00:26:35 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.35282883048057556
[2023-09-28 00:26:35 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:26:36 iu_test] (trainer.py 167): INFO EPOCH 7 training takes 0:01:35
[2023-09-28 00:28:08 iu_test] (trainer.py 133): INFO 	epoch          : 8
[2023-09-28 00:28:08 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 00:28:08 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 00:28:08 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 00:28:08 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 00:28:08 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 00:28:08 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 00:28:08 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 00:28:08 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.6568878889083862
[2023-09-28 00:28:08 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 00:28:08 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 00:28:08 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 00:28:08 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 00:28:08 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 00:28:08 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 00:28:08 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 00:28:08 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:28:10 iu_test] (trainer.py 167): INFO EPOCH 8 training takes 0:01:33
[2023-09-28 00:29:42 iu_test] (trainer.py 133): INFO 	epoch          : 9
[2023-09-28 00:29:42 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 00:29:42 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 00:29:42 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 00:29:42 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 00:29:42 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 00:29:42 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 00:29:42 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 00:29:42 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.687831997871399
[2023-09-28 00:29:42 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 00:29:42 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 00:29:42 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 00:29:42 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 00:29:42 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 00:29:42 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 00:29:42 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 00:29:42 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:29:43 iu_test] (trainer.py 167): INFO EPOCH 9 training takes 0:01:33
[2023-09-28 00:31:15 iu_test] (trainer.py 133): INFO 	epoch          : 10
[2023-09-28 00:31:15 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 00:31:15 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 00:31:15 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 00:31:15 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 00:31:15 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 00:31:15 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 00:31:15 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 00:31:15 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.6886454820632935
[2023-09-28 00:31:15 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 00:31:15 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 00:31:15 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 00:31:15 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 00:31:15 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 00:31:15 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 00:31:15 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 00:31:15 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:31:17 iu_test] (trainer.py 167): INFO EPOCH 10 training takes 0:01:33
[2023-09-28 00:32:49 iu_test] (trainer.py 133): INFO 	epoch          : 11
[2023-09-28 00:32:49 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 00:32:49 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 00:32:49 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 00:32:49 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 00:32:49 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 00:32:49 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 00:32:49 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 00:32:49 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.6760644912719727
[2023-09-28 00:32:49 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 00:32:49 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 00:32:49 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 00:32:49 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 00:32:49 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 00:32:49 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 00:32:49 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 00:32:49 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:32:50 iu_test] (trainer.py 167): INFO EPOCH 11 training takes 0:01:33
[2023-09-28 00:34:23 iu_test] (trainer.py 133): INFO 	epoch          : 12
[2023-09-28 00:34:23 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 00:34:23 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 00:34:23 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 00:34:23 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 00:34:23 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 00:34:23 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 00:34:23 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 00:34:23 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.7161169052124023
[2023-09-28 00:34:23 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 00:34:23 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 00:34:23 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 00:34:23 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 00:34:23 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 00:34:23 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 00:34:23 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 00:34:23 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:34:25 iu_test] (trainer.py 167): INFO EPOCH 12 training takes 0:01:34
[2023-09-28 00:35:57 iu_test] (trainer.py 133): INFO 	epoch          : 13
[2023-09-28 00:35:57 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 00:35:57 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 00:35:57 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 00:35:57 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 00:35:57 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 00:35:57 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 00:35:57 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 00:35:57 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.7572708129882812
[2023-09-28 00:35:57 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 00:35:57 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 00:35:57 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 00:35:57 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 00:35:57 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 00:35:57 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 00:35:57 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 00:35:57 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:35:58 iu_test] (trainer.py 167): INFO EPOCH 13 training takes 0:01:33
[2023-09-28 00:37:31 iu_test] (trainer.py 133): INFO 	epoch          : 14
[2023-09-28 00:37:31 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.4143832325935364
[2023-09-28 00:37:31 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.22387857735157013
[2023-09-28 00:37:31 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.14333991706371307
[2023-09-28 00:37:31 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.09928033500909805
[2023-09-28 00:37:31 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.15086789429187775
[2023-09-28 00:37:31 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.30748507380485535
[2023-09-28 00:37:31 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2971348166465759
[2023-09-28 00:37:31 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.7926329374313354
[2023-09-28 00:37:31 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4265702962875366
[2023-09-28 00:37:31 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2514986991882324
[2023-09-28 00:37:31 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.17674300074577332
[2023-09-28 00:37:31 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.13352429866790771
[2023-09-28 00:37:31 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.17305678129196167
[2023-09-28 00:37:31 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.338417649269104
[2023-09-28 00:37:31 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.5254278182983398
[2023-09-28 00:37:31 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:37:32 iu_test] (trainer.py 167): INFO EPOCH 14 training takes 0:01:34
[2023-09-28 00:39:05 iu_test] (trainer.py 133): INFO 	epoch          : 15
[2023-09-28 00:39:05 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.4143832325935364
[2023-09-28 00:39:05 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.22387857735157013
[2023-09-28 00:39:05 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.14333991706371307
[2023-09-28 00:39:05 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.09928033500909805
[2023-09-28 00:39:05 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.15086789429187775
[2023-09-28 00:39:05 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.30748507380485535
[2023-09-28 00:39:05 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2971348166465759
[2023-09-28 00:39:05 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.8291682004928589
[2023-09-28 00:39:05 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4265702962875366
[2023-09-28 00:39:05 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2514986991882324
[2023-09-28 00:39:05 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.17674300074577332
[2023-09-28 00:39:05 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.13352429866790771
[2023-09-28 00:39:05 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.17305678129196167
[2023-09-28 00:39:05 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.338417649269104
[2023-09-28 00:39:05 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.5254278182983398
[2023-09-28 00:39:05 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:39:07 iu_test] (trainer.py 167): INFO EPOCH 15 training takes 0:01:34
[2023-09-28 00:40:39 iu_test] (trainer.py 133): INFO 	epoch          : 16
[2023-09-28 00:40:39 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 00:40:39 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 00:40:39 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 00:40:39 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 00:40:39 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 00:40:39 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 00:40:39 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 00:40:39 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.872472882270813
[2023-09-28 00:40:39 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 00:40:39 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 00:40:39 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 00:40:39 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 00:40:39 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 00:40:39 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 00:40:39 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 00:40:39 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:40:40 iu_test] (trainer.py 167): INFO EPOCH 16 training takes 0:01:33
[2023-09-28 00:42:12 iu_test] (trainer.py 133): INFO 	epoch          : 17
[2023-09-28 00:42:12 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 00:42:12 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 00:42:12 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 00:42:12 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 00:42:12 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 00:42:12 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 00:42:12 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 00:42:12 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.9148001670837402
[2023-09-28 00:42:12 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 00:42:12 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 00:42:12 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 00:42:12 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 00:42:12 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 00:42:12 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 00:42:12 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 00:42:12 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:42:14 iu_test] (trainer.py 167): INFO EPOCH 17 training takes 0:01:33
[2023-09-28 00:43:47 iu_test] (trainer.py 133): INFO 	epoch          : 18
[2023-09-28 00:43:47 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 00:43:47 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 00:43:47 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 00:43:47 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 00:43:47 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 00:43:47 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 00:43:47 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 00:43:47 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.9396589994430542
[2023-09-28 00:43:47 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 00:43:47 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 00:43:47 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 00:43:47 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 00:43:47 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 00:43:47 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 00:43:47 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 00:43:47 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:43:48 iu_test] (trainer.py 167): INFO EPOCH 18 training takes 0:01:34
[2023-09-28 00:45:20 iu_test] (trainer.py 133): INFO 	epoch          : 19
[2023-09-28 00:45:20 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.4143832325935364
[2023-09-28 00:45:20 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.22387857735157013
[2023-09-28 00:45:20 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.14333991706371307
[2023-09-28 00:45:20 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.09928033500909805
[2023-09-28 00:45:20 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.15086789429187775
[2023-09-28 00:45:20 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.30748507380485535
[2023-09-28 00:45:20 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2971348166465759
[2023-09-28 00:45:20 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.980300784111023
[2023-09-28 00:45:20 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4265702962875366
[2023-09-28 00:45:20 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2514986991882324
[2023-09-28 00:45:20 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.17674300074577332
[2023-09-28 00:45:20 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.13352429866790771
[2023-09-28 00:45:20 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.17305678129196167
[2023-09-28 00:45:20 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.338417649269104
[2023-09-28 00:45:20 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.5254278182983398
[2023-09-28 00:45:20 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:45:22 iu_test] (trainer.py 167): INFO EPOCH 19 training takes 0:01:33
[2023-09-28 00:46:55 iu_test] (trainer.py 133): INFO 	epoch          : 20
[2023-09-28 00:46:55 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.4143832325935364
[2023-09-28 00:46:55 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.22387857735157013
[2023-09-28 00:46:55 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.14333991706371307
[2023-09-28 00:46:55 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.09928033500909805
[2023-09-28 00:46:55 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.15086789429187775
[2023-09-28 00:46:55 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.30748507380485535
[2023-09-28 00:46:55 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2971348166465759
[2023-09-28 00:46:55 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.979533314704895
[2023-09-28 00:46:55 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4265702962875366
[2023-09-28 00:46:55 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2514986991882324
[2023-09-28 00:46:55 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.17674300074577332
[2023-09-28 00:46:55 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.13352429866790771
[2023-09-28 00:46:55 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.17305678129196167
[2023-09-28 00:46:55 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.338417649269104
[2023-09-28 00:46:55 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.5254278182983398
[2023-09-28 00:46:55 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:46:57 iu_test] (trainer.py 167): INFO EPOCH 20 training takes 0:01:34
[2023-09-28 00:48:30 iu_test] (trainer.py 133): INFO 	epoch          : 21
[2023-09-28 00:48:30 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.4143832325935364
[2023-09-28 00:48:30 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.22387857735157013
[2023-09-28 00:48:30 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.14333991706371307
[2023-09-28 00:48:30 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.09928033500909805
[2023-09-28 00:48:30 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.15086789429187775
[2023-09-28 00:48:30 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.30748507380485535
[2023-09-28 00:48:30 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2971348166465759
[2023-09-28 00:48:30 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.9804939031600952
[2023-09-28 00:48:30 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4265702962875366
[2023-09-28 00:48:30 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2514986991882324
[2023-09-28 00:48:30 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.17674300074577332
[2023-09-28 00:48:30 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.13352429866790771
[2023-09-28 00:48:30 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.17305678129196167
[2023-09-28 00:48:30 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.338417649269104
[2023-09-28 00:48:30 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.5254278182983398
[2023-09-28 00:48:30 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:48:32 iu_test] (trainer.py 167): INFO EPOCH 21 training takes 0:01:34
[2023-09-28 00:50:03 iu_test] (trainer.py 133): INFO 	epoch          : 22
[2023-09-28 00:50:03 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 00:50:03 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 00:50:03 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 00:50:03 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 00:50:03 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 00:50:03 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 00:50:03 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 00:50:03 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.0005075931549072
[2023-09-28 00:50:03 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 00:50:03 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 00:50:03 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 00:50:03 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 00:50:03 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 00:50:03 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 00:50:03 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 00:50:03 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:50:05 iu_test] (trainer.py 167): INFO EPOCH 22 training takes 0:01:33
[2023-09-28 00:51:38 iu_test] (trainer.py 133): INFO 	epoch          : 23
[2023-09-28 00:51:38 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.4143832325935364
[2023-09-28 00:51:38 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.22387857735157013
[2023-09-28 00:51:38 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.14333991706371307
[2023-09-28 00:51:38 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.09928033500909805
[2023-09-28 00:51:38 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.15086789429187775
[2023-09-28 00:51:38 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.30748507380485535
[2023-09-28 00:51:38 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2971348166465759
[2023-09-28 00:51:38 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.044743776321411
[2023-09-28 00:51:38 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4265702962875366
[2023-09-28 00:51:38 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2514986991882324
[2023-09-28 00:51:38 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.17674300074577332
[2023-09-28 00:51:38 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.13352429866790771
[2023-09-28 00:51:38 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.17305678129196167
[2023-09-28 00:51:38 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.338417649269104
[2023-09-28 00:51:38 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.5254278182983398
[2023-09-28 00:51:38 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:51:40 iu_test] (trainer.py 167): INFO EPOCH 23 training takes 0:01:34
[2023-09-28 00:53:12 iu_test] (trainer.py 133): INFO 	epoch          : 24
[2023-09-28 00:53:12 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.4143832325935364
[2023-09-28 00:53:12 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.22387857735157013
[2023-09-28 00:53:12 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.14333991706371307
[2023-09-28 00:53:12 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.09928033500909805
[2023-09-28 00:53:12 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.15086789429187775
[2023-09-28 00:53:12 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.30748507380485535
[2023-09-28 00:53:12 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2971348166465759
[2023-09-28 00:53:12 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.087416172027588
[2023-09-28 00:53:12 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4265702962875366
[2023-09-28 00:53:12 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2514986991882324
[2023-09-28 00:53:12 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.17674300074577332
[2023-09-28 00:53:12 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.13352429866790771
[2023-09-28 00:53:12 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.17305678129196167
[2023-09-28 00:53:12 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.338417649269104
[2023-09-28 00:53:12 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.5254278182983398
[2023-09-28 00:53:12 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:53:14 iu_test] (trainer.py 167): INFO EPOCH 24 training takes 0:01:33
[2023-09-28 00:54:46 iu_test] (trainer.py 133): INFO 	epoch          : 25
[2023-09-28 00:54:46 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 00:54:46 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 00:54:46 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 00:54:46 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 00:54:46 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 00:54:46 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 00:54:46 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 00:54:46 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.102792978286743
[2023-09-28 00:54:46 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 00:54:46 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 00:54:46 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 00:54:46 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 00:54:46 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 00:54:46 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 00:54:46 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 00:54:46 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:54:47 iu_test] (trainer.py 167): INFO EPOCH 25 training takes 0:01:33
[2023-09-28 00:56:22 iu_test] (trainer.py 133): INFO 	epoch          : 26
[2023-09-28 00:56:22 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.4143832325935364
[2023-09-28 00:56:22 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.22387857735157013
[2023-09-28 00:56:22 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.14333991706371307
[2023-09-28 00:56:22 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.09928033500909805
[2023-09-28 00:56:22 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.15086789429187775
[2023-09-28 00:56:22 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.30748507380485535
[2023-09-28 00:56:22 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2971348166465759
[2023-09-28 00:56:22 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.1314024925231934
[2023-09-28 00:56:22 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4265702962875366
[2023-09-28 00:56:22 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2514986991882324
[2023-09-28 00:56:22 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.17674300074577332
[2023-09-28 00:56:22 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.13352429866790771
[2023-09-28 00:56:22 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.17305678129196167
[2023-09-28 00:56:22 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.338417649269104
[2023-09-28 00:56:22 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.5254278182983398
[2023-09-28 00:56:22 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:56:23 iu_test] (trainer.py 167): INFO EPOCH 26 training takes 0:01:35
[2023-09-28 00:57:55 iu_test] (trainer.py 133): INFO 	epoch          : 27
[2023-09-28 00:57:55 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.3962767720222473
[2023-09-28 00:57:55 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.2525562047958374
[2023-09-28 00:57:55 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.16696561872959137
[2023-09-28 00:57:55 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.1062621995806694
[2023-09-28 00:57:55 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.16162574291229248
[2023-09-28 00:57:55 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.33059147000312805
[2023-09-28 00:57:55 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.1860351413488388
[2023-09-28 00:57:55 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.1433615684509277
[2023-09-28 00:57:55 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.42133215069770813
[2023-09-28 00:57:55 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2682648003101349
[2023-09-28 00:57:55 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.17856812477111816
[2023-09-28 00:57:55 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.11555685847997665
[2023-09-28 00:57:55 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.1725291609764099
[2023-09-28 00:57:55 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3321034610271454
[2023-09-28 00:57:55 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.2780439257621765
[2023-09-28 00:57:55 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:57:56 iu_test] (trainer.py 167): INFO EPOCH 27 training takes 0:01:32
[2023-09-28 00:59:29 iu_test] (trainer.py 133): INFO 	epoch          : 28
[2023-09-28 00:59:29 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 00:59:29 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 00:59:29 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 00:59:29 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 00:59:29 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 00:59:29 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 00:59:29 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 00:59:29 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.134982109069824
[2023-09-28 00:59:29 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 00:59:29 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 00:59:29 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 00:59:29 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 00:59:29 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 00:59:29 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 00:59:29 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 00:59:29 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 00:59:30 iu_test] (trainer.py 167): INFO EPOCH 28 training takes 0:01:33
[2023-09-28 01:01:02 iu_test] (trainer.py 133): INFO 	epoch          : 29
[2023-09-28 01:01:02 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 01:01:02 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 01:01:02 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 01:01:02 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 01:01:02 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 01:01:02 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 01:01:02 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 01:01:02 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.176344394683838
[2023-09-28 01:01:02 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 01:01:02 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 01:01:02 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 01:01:02 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 01:01:02 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 01:01:02 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 01:01:02 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 01:01:02 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 01:01:04 iu_test] (trainer.py 167): INFO EPOCH 29 training takes 0:01:33
[2023-09-28 01:02:36 iu_test] (trainer.py 133): INFO 	epoch          : 30
[2023-09-28 01:02:36 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.4143832325935364
[2023-09-28 01:02:36 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.22387857735157013
[2023-09-28 01:02:36 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.14333991706371307
[2023-09-28 01:02:36 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.09928033500909805
[2023-09-28 01:02:36 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.15086789429187775
[2023-09-28 01:02:36 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.30748507380485535
[2023-09-28 01:02:36 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2971348166465759
[2023-09-28 01:02:36 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.185749053955078
[2023-09-28 01:02:36 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4265702962875366
[2023-09-28 01:02:36 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2514986991882324
[2023-09-28 01:02:36 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.17674300074577332
[2023-09-28 01:02:36 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.13352429866790771
[2023-09-28 01:02:36 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.17305678129196167
[2023-09-28 01:02:36 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.338417649269104
[2023-09-28 01:02:36 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.5254278182983398
[2023-09-28 01:02:36 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 01:02:37 iu_test] (trainer.py 167): INFO EPOCH 30 training takes 0:01:33
[2023-09-28 01:04:09 iu_test] (trainer.py 133): INFO 	epoch          : 31
[2023-09-28 01:04:09 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 01:04:09 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 01:04:09 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 01:04:09 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 01:04:09 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 01:04:09 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 01:04:09 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 01:04:09 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.178204298019409
[2023-09-28 01:04:09 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 01:04:09 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 01:04:09 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 01:04:09 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 01:04:09 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 01:04:09 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 01:04:09 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 01:04:09 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 01:04:11 iu_test] (trainer.py 167): INFO EPOCH 31 training takes 0:01:33
[2023-09-28 01:05:43 iu_test] (trainer.py 133): INFO 	epoch          : 32
[2023-09-28 01:05:43 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 01:05:43 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 01:05:43 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 01:05:43 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 01:05:43 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 01:05:43 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 01:05:43 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 01:05:43 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.207815170288086
[2023-09-28 01:05:43 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 01:05:43 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 01:05:43 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 01:05:43 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 01:05:43 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 01:05:43 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 01:05:43 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 01:05:43 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 01:05:45 iu_test] (trainer.py 167): INFO EPOCH 32 training takes 0:01:33
[2023-09-28 01:07:16 iu_test] (trainer.py 133): INFO 	epoch          : 33
[2023-09-28 01:07:16 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 01:07:16 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 01:07:16 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 01:07:16 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 01:07:16 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 01:07:16 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 01:07:16 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 01:07:16 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.2401793003082275
[2023-09-28 01:07:16 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 01:07:16 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 01:07:16 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 01:07:16 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 01:07:16 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 01:07:16 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 01:07:16 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 01:07:16 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 01:07:18 iu_test] (trainer.py 167): INFO EPOCH 33 training takes 0:01:32
[2023-09-28 01:08:49 iu_test] (trainer.py 133): INFO 	epoch          : 34
[2023-09-28 01:08:49 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 01:08:49 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 01:08:49 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 01:08:49 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 01:08:49 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 01:08:49 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 01:08:49 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 01:08:49 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.2642178535461426
[2023-09-28 01:08:49 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 01:08:49 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 01:08:49 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 01:08:49 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 01:08:49 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 01:08:49 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 01:08:49 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 01:08:49 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 01:08:50 iu_test] (trainer.py 167): INFO EPOCH 34 training takes 0:01:32
[2023-09-28 01:10:22 iu_test] (trainer.py 133): INFO 	epoch          : 35
[2023-09-28 01:10:22 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 01:10:22 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 01:10:22 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 01:10:22 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 01:10:22 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 01:10:22 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 01:10:22 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 01:10:22 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.2591609954833984
[2023-09-28 01:10:22 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 01:10:22 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 01:10:22 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 01:10:22 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 01:10:22 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 01:10:22 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 01:10:22 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 01:10:22 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 01:10:23 iu_test] (trainer.py 167): INFO EPOCH 35 training takes 0:01:32
[2023-09-28 01:11:56 iu_test] (trainer.py 133): INFO 	epoch          : 36
[2023-09-28 01:11:56 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 01:11:56 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 01:11:56 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 01:11:56 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 01:11:56 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 01:11:56 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 01:11:56 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 01:11:56 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.257429838180542
[2023-09-28 01:11:56 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 01:11:56 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 01:11:56 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 01:11:56 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 01:11:56 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 01:11:56 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 01:11:56 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 01:11:56 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 01:11:58 iu_test] (trainer.py 167): INFO EPOCH 36 training takes 0:01:34
[2023-09-28 01:13:29 iu_test] (trainer.py 133): INFO 	epoch          : 37
[2023-09-28 01:13:29 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 01:13:29 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 01:13:29 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 01:13:29 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 01:13:29 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 01:13:29 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 01:13:29 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 01:13:29 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.260784864425659
[2023-09-28 01:13:29 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 01:13:29 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 01:13:29 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 01:13:29 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 01:13:29 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 01:13:29 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 01:13:29 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 01:13:29 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 01:13:31 iu_test] (trainer.py 167): INFO EPOCH 37 training takes 0:01:33
[2023-09-28 01:15:02 iu_test] (trainer.py 133): INFO 	epoch          : 38
[2023-09-28 01:15:02 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-09-28 01:15:02 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-09-28 01:15:02 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-09-28 01:15:02 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-09-28 01:15:02 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-09-28 01:15:02 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-09-28 01:15:02 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-09-28 01:15:02 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.3026351928710938
[2023-09-28 01:15:02 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-09-28 01:15:02 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-09-28 01:15:02 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-09-28 01:15:02 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-09-28 01:15:02 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-09-28 01:15:02 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-09-28 01:15:02 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-09-28 01:15:02 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-28 01:15:04 iu_test] (trainer.py 167): INFO EPOCH 38 training takes 0:01:33
[2023-09-28 15:52:24 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-28 15:52:24 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-28 15:54:04 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-28 15:54:04 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-28 15:56:41 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-28 15:56:41 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-28 15:58:08 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-28 15:58:08 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-28 15:59:06 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-28 15:59:06 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-28 15:59:41 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-28 15:59:41 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-28 16:00:08 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-28 16:00:08 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-28 16:00:39 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-28 16:00:39 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-28 16:01:08 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-28 16:01:08 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-28 16:01:35 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-28 16:01:35 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-28 16:02:01 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-28 16:02:01 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-28 16:02:18 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-28 16:02:18 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-28 16:03:09 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-28 16:03:09 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-28 16:03:11 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-28 16:04:08 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-28 16:04:08 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-28 16:04:10 iu_test] (main.py 117): INFO number of params: 100672945
[2023-09-30 22:07:31 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'dsr': 1, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'att_cls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-30 22:07:31 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-30 22:07:48 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'dsr': 1, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'att_cls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-30 22:07:48 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-30 22:07:49 iu_test] (main.py 103): INFO RRGModel(
  (visual_extractor): VisualExtractor(
    (model): SwinTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (layers): Sequential(
        (0): BasicLayer(
          dim=128, input_resolution=(56, 56), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): Identity()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(56, 56), dim=128
            (reduction): Linear(in_features=512, out_features=256, bias=False)
            (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          )
        )
        (1): BasicLayer(
          dim=256, input_resolution=(28, 28), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(28, 28), dim=256
            (reduction): Linear(in_features=1024, out_features=512, bias=False)
            (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
        (2): BasicLayer(
          dim=512, input_resolution=(14, 14), depth=18
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (2): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (3): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (4): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (5): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (6): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (7): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (8): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (9): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (10): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (11): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (12): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (13): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (14): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (15): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (16): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (17): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(14, 14), dim=512
            (reduction): Linear(in_features=2048, out_features=1024, bias=False)
            (norm): LayerNorm((2048,), eps=1e-05, elementwise_affine=True)
          )
        )
        (3): BasicLayer(
          dim=1024, input_resolution=(7, 7), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
        )
      )
      (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (avgpool): AdaptiveAvgPool1d(output_size=1)
    )
    (avgpool): AdaptiveAvgPool1d(output_size=1)
  )
  (encoder_decoder): EncoderDecoder(
    (model): Transformer(
      (vis_encoder): Encoder(
        (layers): ModuleList(
          (0): EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (1): EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (2): EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (text_encoder): TextEncoder(
        (embed): Sequential(
          (0): Embeddings(
            (lut): Embedding(761, 512)
          )
          (1): PositionalEncoding(
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (decoder): Decoder(
        (layers): ModuleList(
          (0): DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (2): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (1): DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (2): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (2): DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (2): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (logit): Linear(in_features=512, out_features=761, bias=True)
    (att_embed): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): ReLU()
      (2): Dropout(p=0.5, inplace=False)
    )
  )
)
Trainable parameters: 100672945
[2023-09-30 22:07:49 iu_test] (main.py 120): INFO number of params: 100672945
[2023-09-30 22:10:12 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'dsr': 1, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'att_cls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-30 22:10:12 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-30 22:10:14 iu_test] (main.py 103): INFO RRGModel(
  (visual_extractor): VisualExtractor(
    (model): SwinTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (layers): Sequential(
        (0): BasicLayer(
          dim=128, input_resolution=(56, 56), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): Identity()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(56, 56), dim=128
            (reduction): Linear(in_features=512, out_features=256, bias=False)
            (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          )
        )
        (1): BasicLayer(
          dim=256, input_resolution=(28, 28), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(28, 28), dim=256
            (reduction): Linear(in_features=1024, out_features=512, bias=False)
            (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
        (2): BasicLayer(
          dim=512, input_resolution=(14, 14), depth=18
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (2): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (3): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (4): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (5): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (6): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (7): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (8): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (9): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (10): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (11): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (12): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (13): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (14): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (15): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (16): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (17): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(14, 14), dim=512
            (reduction): Linear(in_features=2048, out_features=1024, bias=False)
            (norm): LayerNorm((2048,), eps=1e-05, elementwise_affine=True)
          )
        )
        (3): BasicLayer(
          dim=1024, input_resolution=(7, 7), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
        )
      )
      (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (avgpool): AdaptiveAvgPool1d(output_size=1)
    )
    (avgpool): AdaptiveAvgPool1d(output_size=1)
  )
  (encoder_decoder): EncoderDecoder(
    (model): Transformer(
      (vis_encoder): Encoder(
        (layers): ModuleList(
          (0): EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (1): EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (2): EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (text_encoder): TextEncoder(
        (embed): Sequential(
          (0): Embeddings(
            (lut): Embedding(761, 512)
          )
          (1): PositionalEncoding(
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (decoder): Decoder(
        (layers): ModuleList(
          (0): DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (2): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (1): DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (2): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (2): DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (2): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (logit): Linear(in_features=512, out_features=761, bias=True)
    (att_embed): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): ReLU()
      (2): Dropout(p=0.5, inplace=False)
    )
  )
)
Trainable parameters: 100672945
[2023-09-30 22:10:14 iu_test] (main.py 120): INFO number of params: 100672945
[2023-09-30 22:11:13 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'dsr': 1, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'att_cls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-30 22:11:13 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-30 22:11:14 iu_test] (main.py 103): INFO RRGModel(
  (visual_extractor): VisualExtractor(
    (model): SwinTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (layers): Sequential(
        (0): BasicLayer(
          dim=128, input_resolution=(56, 56), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): Identity()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(56, 56), dim=128
            (reduction): Linear(in_features=512, out_features=256, bias=False)
            (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          )
        )
        (1): BasicLayer(
          dim=256, input_resolution=(28, 28), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(28, 28), dim=256
            (reduction): Linear(in_features=1024, out_features=512, bias=False)
            (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
        (2): BasicLayer(
          dim=512, input_resolution=(14, 14), depth=18
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (2): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (3): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (4): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (5): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (6): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (7): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (8): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (9): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (10): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (11): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (12): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (13): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (14): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (15): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (16): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (17): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(14, 14), dim=512
            (reduction): Linear(in_features=2048, out_features=1024, bias=False)
            (norm): LayerNorm((2048,), eps=1e-05, elementwise_affine=True)
          )
        )
        (3): BasicLayer(
          dim=1024, input_resolution=(7, 7), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
        )
      )
      (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (avgpool): AdaptiveAvgPool1d(output_size=1)
    )
    (avgpool): AdaptiveAvgPool1d(output_size=1)
  )
  (encoder_decoder): EncoderDecoder(
    (model): Transformer(
      (vis_encoder): Encoder(
        (layers): ModuleList(
          (0): EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (1): EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (2): EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (text_encoder): TextEncoder(
        (embed): Sequential(
          (0): Embeddings(
            (lut): Embedding(761, 512)
          )
          (1): PositionalEncoding(
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (decoder): Decoder(
        (layers): ModuleList(
          (0): DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (2): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (1): DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (2): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (2): DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (2): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (logit): Linear(in_features=512, out_features=761, bias=True)
    (att_embed): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): ReLU()
      (2): Dropout(p=0.5, inplace=False)
    )
  )
)
Trainable parameters: 100672945
[2023-09-30 22:11:14 iu_test] (main.py 120): INFO number of params: 100672945
[2023-09-30 22:11:49 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'dsr': 1, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'att_cls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-30 22:11:49 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-30 22:11:50 iu_test] (main.py 103): INFO RRGModel(
  (visual_extractor): VisualExtractor(
    (model): SwinTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (layers): Sequential(
        (0): BasicLayer(
          dim=128, input_resolution=(56, 56), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): Identity()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(56, 56), dim=128
            (reduction): Linear(in_features=512, out_features=256, bias=False)
            (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          )
        )
        (1): BasicLayer(
          dim=256, input_resolution=(28, 28), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(28, 28), dim=256
            (reduction): Linear(in_features=1024, out_features=512, bias=False)
            (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
        (2): BasicLayer(
          dim=512, input_resolution=(14, 14), depth=18
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (2): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (3): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (4): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (5): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (6): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (7): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (8): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (9): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (10): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (11): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (12): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (13): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (14): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (15): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (16): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (17): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(14, 14), dim=512
            (reduction): Linear(in_features=2048, out_features=1024, bias=False)
            (norm): LayerNorm((2048,), eps=1e-05, elementwise_affine=True)
          )
        )
        (3): BasicLayer(
          dim=1024, input_resolution=(7, 7), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
        )
      )
      (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (avgpool): AdaptiveAvgPool1d(output_size=1)
    )
    (avgpool): AdaptiveAvgPool1d(output_size=1)
  )
  (encoder_decoder): EncoderDecoder(
    (model): Transformer(
      (vis_encoder): Encoder(
        (layers): ModuleList(
          (0): EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (1): EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (2): EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (text_encoder): TextEncoder(
        (embed): Sequential(
          (0): Embeddings(
            (lut): Embedding(761, 512)
          )
          (1): PositionalEncoding(
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (decoder): Decoder(
        (layers): ModuleList(
          (0): DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (2): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (1): DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (2): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (2): DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (2): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (logit): Linear(in_features=512, out_features=761, bias=True)
    (att_embed): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): ReLU()
      (2): Dropout(p=0.5, inplace=False)
    )
  )
)
Trainable parameters: 100672945
[2023-09-30 22:11:50 iu_test] (main.py 120): INFO number of params: 100672945
[2023-09-30 22:14:10 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'dsr': 1, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'att_cls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-30 22:14:10 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-30 22:14:11 iu_test] (main.py 103): INFO RRGModel(
  (visual_extractor): VisualExtractor(
    (model): SwinTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (layers): Sequential(
        (0): BasicLayer(
          dim=128, input_resolution=(56, 56), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): Identity()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(56, 56), dim=128
            (reduction): Linear(in_features=512, out_features=256, bias=False)
            (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          )
        )
        (1): BasicLayer(
          dim=256, input_resolution=(28, 28), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(28, 28), dim=256
            (reduction): Linear(in_features=1024, out_features=512, bias=False)
            (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
        (2): BasicLayer(
          dim=512, input_resolution=(14, 14), depth=18
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (2): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (3): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (4): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (5): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (6): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (7): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (8): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (9): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (10): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (11): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (12): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (13): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (14): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (15): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (16): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (17): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(14, 14), dim=512
            (reduction): Linear(in_features=2048, out_features=1024, bias=False)
            (norm): LayerNorm((2048,), eps=1e-05, elementwise_affine=True)
          )
        )
        (3): BasicLayer(
          dim=1024, input_resolution=(7, 7), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
        )
      )
      (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (avgpool): AdaptiveAvgPool1d(output_size=1)
    )
    (avgpool): AdaptiveAvgPool1d(output_size=1)
  )
  (encoder_decoder): EncoderDecoder(
    (model): Transformer(
      (vis_encoder): Encoder(
        (layers): ModuleList(
          (0): EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (1): EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (2): EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (text_encoder): TextEncoder(
        (embed): Sequential(
          (0): Embeddings(
            (lut): Embedding(761, 512)
          )
          (1): PositionalEncoding(
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (decoder): Decoder(
        (layers): ModuleList(
          (0): DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (2): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (1): DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (2): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (2): DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0): Linear(in_features=512, out_features=512, bias=True)
                (1): Linear(in_features=512, out_features=512, bias=True)
                (2): Linear(in_features=512, out_features=512, bias=True)
                (3): Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (2): SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (logit): Linear(in_features=512, out_features=761, bias=True)
    (att_embed): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): ReLU()
      (2): Dropout(p=0.5, inplace=False)
    )
  )
)
Trainable parameters: 100672945
[2023-09-30 22:14:11 iu_test] (main.py 120): INFO number of params: 100672945
[2023-09-30 22:59:24 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'dsr': 1, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'att_cls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-30 22:59:24 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-30 22:59:25 iu_test] (main.py 103): INFO RRGModel(
  (visual_extractor): VisualExtractor(
    (model): SwinTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (layers): Sequential(
        (0): BasicLayer(
          dim=128, input_resolution=(56, 56), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): Identity()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(56, 56), dim=128
            (reduction): Linear(in_features=512, out_features=256, bias=False)
            (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          )
        )
        (1): BasicLayer(
          dim=256, input_resolution=(28, 28), depth=2
          (blocks): ModuleList(
            (0-1): 2 x SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(28, 28), dim=256
            (reduction): Linear(in_features=1024, out_features=512, bias=False)
            (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
        (2): BasicLayer(
          dim=512, input_resolution=(14, 14), depth=18
          (blocks): ModuleList(
            (0-17): 18 x SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(14, 14), dim=512
            (reduction): Linear(in_features=2048, out_features=1024, bias=False)
            (norm): LayerNorm((2048,), eps=1e-05, elementwise_affine=True)
          )
        )
        (3): BasicLayer(
          dim=1024, input_resolution=(7, 7), depth=2
          (blocks): ModuleList(
            (0-1): 2 x SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
        )
      )
      (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (avgpool): AdaptiveAvgPool1d(output_size=1)
    )
    (avgpool): AdaptiveAvgPool1d(output_size=1)
  )
  (encoder_decoder): EncoderDecoder(
    (model): Transformer(
      (vis_encoder): Encoder(
        (layers): ModuleList(
          (0-2): 3 x EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0-1): 2 x SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (text_encoder): TextEncoder(
        (embed): Sequential(
          (0): Embeddings(
            (lut): Embedding(761, 512)
          )
          (1): PositionalEncoding(
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (decoder): Decoder(
        (layers): ModuleList(
          (0-2): 3 x DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0-2): 3 x SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (logit): Linear(in_features=512, out_features=761, bias=True)
    (att_embed): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): ReLU()
      (2): Dropout(p=0.5, inplace=False)
    )
  )
)
Trainable parameters: 100672945
[2023-09-30 23:00:03 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'dsr': 1, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'att_cls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-30 23:00:03 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-30 23:00:04 iu_test] (main.py 105): INFO RRGModel(
  (visual_extractor): VisualExtractor(
    (model): SwinTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (layers): Sequential(
        (0): BasicLayer(
          dim=128, input_resolution=(56, 56), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): Identity()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(56, 56), dim=128
            (reduction): Linear(in_features=512, out_features=256, bias=False)
            (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          )
        )
        (1): BasicLayer(
          dim=256, input_resolution=(28, 28), depth=2
          (blocks): ModuleList(
            (0-1): 2 x SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(28, 28), dim=256
            (reduction): Linear(in_features=1024, out_features=512, bias=False)
            (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
        (2): BasicLayer(
          dim=512, input_resolution=(14, 14), depth=18
          (blocks): ModuleList(
            (0-17): 18 x SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(14, 14), dim=512
            (reduction): Linear(in_features=2048, out_features=1024, bias=False)
            (norm): LayerNorm((2048,), eps=1e-05, elementwise_affine=True)
          )
        )
        (3): BasicLayer(
          dim=1024, input_resolution=(7, 7), depth=2
          (blocks): ModuleList(
            (0-1): 2 x SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
        )
      )
      (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (avgpool): AdaptiveAvgPool1d(output_size=1)
    )
    (avgpool): AdaptiveAvgPool1d(output_size=1)
  )
  (encoder_decoder): EncoderDecoder(
    (model): Transformer(
      (vis_encoder): Encoder(
        (layers): ModuleList(
          (0-2): 3 x EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0-1): 2 x SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (text_encoder): TextEncoder(
        (embed): Sequential(
          (0): Embeddings(
            (lut): Embedding(761, 512)
          )
          (1): PositionalEncoding(
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (decoder): Decoder(
        (layers): ModuleList(
          (0-2): 3 x DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0-2): 3 x SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (logit): Linear(in_features=512, out_features=761, bias=True)
    (att_embed): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): ReLU()
      (2): Dropout(p=0.5, inplace=False)
    )
  )
)
Trainable parameters: 100672945
[2023-09-30 23:00:04 iu_test] (main.py 123): INFO number of params: 100672945
[2023-09-30 23:00:33 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'dsr': 1, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'att_cls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-30 23:00:33 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-30 23:00:34 iu_test] (main.py 105): INFO RRGModel(
  (visual_extractor): VisualExtractor(
    (model): SwinTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (layers): Sequential(
        (0): BasicLayer(
          dim=128, input_resolution=(56, 56), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): Identity()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(56, 56), dim=128
            (reduction): Linear(in_features=512, out_features=256, bias=False)
            (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          )
        )
        (1): BasicLayer(
          dim=256, input_resolution=(28, 28), depth=2
          (blocks): ModuleList(
            (0-1): 2 x SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(28, 28), dim=256
            (reduction): Linear(in_features=1024, out_features=512, bias=False)
            (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
        (2): BasicLayer(
          dim=512, input_resolution=(14, 14), depth=18
          (blocks): ModuleList(
            (0-17): 18 x SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(14, 14), dim=512
            (reduction): Linear(in_features=2048, out_features=1024, bias=False)
            (norm): LayerNorm((2048,), eps=1e-05, elementwise_affine=True)
          )
        )
        (3): BasicLayer(
          dim=1024, input_resolution=(7, 7), depth=2
          (blocks): ModuleList(
            (0-1): 2 x SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
        )
      )
      (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (avgpool): AdaptiveAvgPool1d(output_size=1)
    )
    (avgpool): AdaptiveAvgPool1d(output_size=1)
  )
  (encoder_decoder): EncoderDecoder(
    (model): Transformer(
      (vis_encoder): Encoder(
        (layers): ModuleList(
          (0-2): 3 x EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0-1): 2 x SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (text_encoder): TextEncoder(
        (embed): Sequential(
          (0): Embeddings(
            (lut): Embedding(761, 512)
          )
          (1): PositionalEncoding(
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (decoder): Decoder(
        (layers): ModuleList(
          (0-2): 3 x DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0-2): 3 x SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (logit): Linear(in_features=512, out_features=761, bias=True)
    (att_embed): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): ReLU()
      (2): Dropout(p=0.5, inplace=False)
    )
  )
)
Trainable parameters: 100672945
[2023-09-30 23:00:34 iu_test] (main.py 123): INFO number of params: 100672945
[2023-09-30 23:02:07 iu_test] (trainer.py 133): INFO 	epoch          : 1
[2023-09-30 23:02:07 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.27055948972702026
[2023-09-30 23:02:07 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.17666484415531158
[2023-09-30 23:02:07 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.12625126540660858
[2023-09-30 23:02:07 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.09560348093509674
[2023-09-30 23:02:07 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.1457352489233017
[2023-09-30 23:02:07 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3615453541278839
[2023-09-30 23:02:07 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3339795768260956
[2023-09-30 23:02:07 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.453899383544922
[2023-09-30 23:02:07 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.3207974433898926
[2023-09-30 23:02:07 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.20981106162071228
[2023-09-30 23:02:07 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.1502436250448227
[2023-09-30 23:02:07 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.11389239877462387
[2023-09-30 23:02:07 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.16217419505119324
[2023-09-30 23:02:07 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3814627528190613
[2023-09-30 23:02:07 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.35461360216140747
[2023-09-30 23:02:07 iu_test] (trainer.py 161): INFO current best model in: 1
[2023-09-30 23:02:11 iu_test] (trainer.py 167): INFO EPOCH 1 training takes 0:01:36
[2023-09-30 23:03:43 iu_test] (trainer.py 133): INFO 	epoch          : 2
[2023-09-30 23:03:43 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.4073777496814728
[2023-09-30 23:03:43 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.26216354966163635
[2023-09-30 23:03:43 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.18052977323532104
[2023-09-30 23:03:43 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.13073201477527618
[2023-09-30 23:03:43 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.17834334075450897
[2023-09-30 23:03:43 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.34469494223594666
[2023-09-30 23:03:43 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.2921835780143738
[2023-09-30 23:03:43 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.926456332206726
[2023-09-30 23:03:43 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.44966787099838257
[2023-09-30 23:03:43 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.29046469926834106
[2023-09-30 23:03:43 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.20255666971206665
[2023-09-30 23:03:43 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.15011553466320038
[2023-09-30 23:03:43 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.1935088038444519
[2023-09-30 23:03:43 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.36180874705314636
[2023-09-30 23:03:43 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.4107096791267395
[2023-09-30 23:03:43 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-09-30 23:03:47 iu_test] (trainer.py 167): INFO EPOCH 2 training takes 0:01:36
[2023-09-30 23:16:33 iu_test] (main.py 65): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'dsr': 1, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'att_cls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-30 23:16:33 iu_test] (main.py 66): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-30 23:16:34 iu_test] (main.py 106): INFO RRGModel(
  (visual_extractor): VisualExtractor(
    (model): SwinTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (layers): Sequential(
        (0): BasicLayer(
          dim=128, input_resolution=(56, 56), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): Identity()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(56, 56), dim=128
            (reduction): Linear(in_features=512, out_features=256, bias=False)
            (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          )
        )
        (1): BasicLayer(
          dim=256, input_resolution=(28, 28), depth=2
          (blocks): ModuleList(
            (0-1): 2 x SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(28, 28), dim=256
            (reduction): Linear(in_features=1024, out_features=512, bias=False)
            (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
        (2): BasicLayer(
          dim=512, input_resolution=(14, 14), depth=18
          (blocks): ModuleList(
            (0-17): 18 x SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(14, 14), dim=512
            (reduction): Linear(in_features=2048, out_features=1024, bias=False)
            (norm): LayerNorm((2048,), eps=1e-05, elementwise_affine=True)
          )
        )
        (3): BasicLayer(
          dim=1024, input_resolution=(7, 7), depth=2
          (blocks): ModuleList(
            (0-1): 2 x SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
        )
      )
      (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (avgpool): AdaptiveAvgPool1d(output_size=1)
    )
    (avgpool): AdaptiveAvgPool1d(output_size=1)
  )
  (encoder_decoder): EncoderDecoder(
    (model): Transformer(
      (vis_encoder): Encoder(
        (layers): ModuleList(
          (0-2): 3 x EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0-1): 2 x SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (text_encoder): TextEncoder(
        (embed): Sequential(
          (0): Embeddings(
            (lut): Embedding(761, 512)
          )
          (1): PositionalEncoding(
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (decoder): Decoder(
        (layers): ModuleList(
          (0-2): 3 x DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0-2): 3 x SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (logit): Linear(in_features=512, out_features=761, bias=True)
    (att_embed): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): ReLU()
      (2): Dropout(p=0.5, inplace=False)
    )
  )
)
Trainable parameters: 100672945
[2023-09-30 23:17:20 iu_test] (main.py 65): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'dsr': 1, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'att_cls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-30 23:17:20 iu_test] (main.py 66): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-30 23:17:21 iu_test] (main.py 106): INFO RRGModel(
  (visual_extractor): VisualExtractor(
    (model): SwinTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (layers): Sequential(
        (0): BasicLayer(
          dim=128, input_resolution=(56, 56), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): Identity()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(56, 56), dim=128
            (reduction): Linear(in_features=512, out_features=256, bias=False)
            (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          )
        )
        (1): BasicLayer(
          dim=256, input_resolution=(28, 28), depth=2
          (blocks): ModuleList(
            (0-1): 2 x SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(28, 28), dim=256
            (reduction): Linear(in_features=1024, out_features=512, bias=False)
            (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
        (2): BasicLayer(
          dim=512, input_resolution=(14, 14), depth=18
          (blocks): ModuleList(
            (0-17): 18 x SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(14, 14), dim=512
            (reduction): Linear(in_features=2048, out_features=1024, bias=False)
            (norm): LayerNorm((2048,), eps=1e-05, elementwise_affine=True)
          )
        )
        (3): BasicLayer(
          dim=1024, input_resolution=(7, 7), depth=2
          (blocks): ModuleList(
            (0-1): 2 x SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
        )
      )
      (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (avgpool): AdaptiveAvgPool1d(output_size=1)
    )
    (avgpool): AdaptiveAvgPool1d(output_size=1)
  )
  (encoder_decoder): EncoderDecoder(
    (model): Transformer(
      (vis_encoder): Encoder(
        (layers): ModuleList(
          (0-2): 3 x EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0-1): 2 x SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (text_encoder): TextEncoder(
        (embed): Sequential(
          (0): Embeddings(
            (lut): Embedding(761, 512)
          )
          (1): PositionalEncoding(
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (decoder): Decoder(
        (layers): ModuleList(
          (0-2): 3 x DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0-2): 3 x SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (logit): Linear(in_features=512, out_features=761, bias=True)
    (att_embed): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): ReLU()
      (2): Dropout(p=0.5, inplace=False)
    )
  )
)
Trainable parameters: 100672945
[2023-09-30 23:17:22 iu_test] (main.py 123): INFO number of params: 100672945
[2023-09-30 23:18:53 iu_test] (trainer.py 133): INFO 	epoch          : 1
[2023-09-30 23:18:53 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.27055948972702026
[2023-09-30 23:18:53 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.17666484415531158
[2023-09-30 23:18:53 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.12625126540660858
[2023-09-30 23:18:53 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.09560348093509674
[2023-09-30 23:18:53 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.1457352489233017
[2023-09-30 23:18:53 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3615453541278839
[2023-09-30 23:18:53 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3339795768260956
[2023-09-30 23:18:53 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.453899383544922
[2023-09-30 23:18:53 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.3207974433898926
[2023-09-30 23:18:53 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.20981106162071228
[2023-09-30 23:18:53 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.1502436250448227
[2023-09-30 23:18:53 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.11389239877462387
[2023-09-30 23:18:53 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.16217419505119324
[2023-09-30 23:18:53 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3814627528190613
[2023-09-30 23:18:53 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.35461360216140747
[2023-09-30 23:18:53 iu_test] (trainer.py 161): INFO current best model in: 1
[2023-09-30 23:18:57 iu_test] (trainer.py 167): INFO EPOCH 1 training takes 0:01:35
[2023-09-30 23:20:06 iu_test] (main.py 99): INFO RRGModel(
  (visual_extractor): VisualExtractor(
    (model): SwinTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (layers): Sequential(
        (0): BasicLayer(
          dim=128, input_resolution=(56, 56), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): Identity()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(56, 56), dim=128
            (reduction): Linear(in_features=512, out_features=256, bias=False)
            (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          )
        )
        (1): BasicLayer(
          dim=256, input_resolution=(28, 28), depth=2
          (blocks): ModuleList(
            (0-1): 2 x SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(28, 28), dim=256
            (reduction): Linear(in_features=1024, out_features=512, bias=False)
            (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
        (2): BasicLayer(
          dim=512, input_resolution=(14, 14), depth=18
          (blocks): ModuleList(
            (0-17): 18 x SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(14, 14), dim=512
            (reduction): Linear(in_features=2048, out_features=1024, bias=False)
            (norm): LayerNorm((2048,), eps=1e-05, elementwise_affine=True)
          )
        )
        (3): BasicLayer(
          dim=1024, input_resolution=(7, 7), depth=2
          (blocks): ModuleList(
            (0-1): 2 x SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
        )
      )
      (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (avgpool): AdaptiveAvgPool1d(output_size=1)
    )
    (avgpool): AdaptiveAvgPool1d(output_size=1)
  )
  (encoder_decoder): EncoderDecoder(
    (model): Transformer(
      (vis_encoder): Encoder(
        (layers): ModuleList(
          (0-2): 3 x EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0-1): 2 x SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (text_encoder): TextEncoder(
        (embed): Sequential(
          (0): Embeddings(
            (lut): Embedding(761, 512)
          )
          (1): PositionalEncoding(
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (decoder): Decoder(
        (layers): ModuleList(
          (0-2): 3 x DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0-2): 3 x SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (logit): Linear(in_features=512, out_features=761, bias=True)
    (att_embed): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): ReLU()
      (2): Dropout(p=0.5, inplace=False)
    )
  )
)
Trainable parameters: 100672945
[2023-09-30 23:20:07 iu_test] (main.py 119): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'dsr': 1, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'att_cls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none', 'vocab_size': 761}
[2023-09-30 23:20:07 iu_test] (main.py 120): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-30 23:20:07 iu_test] (main.py 127): INFO number of params: 100672945
[2023-09-30 23:21:11 iu_test] (main.py 99): INFO RRGModel(
  (visual_extractor): VisualExtractor(
    (model): SwinTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (layers): Sequential(
        (0): BasicLayer(
          dim=128, input_resolution=(56, 56), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): Identity()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(56, 56), dim=128
            (reduction): Linear(in_features=512, out_features=256, bias=False)
            (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          )
        )
        (1): BasicLayer(
          dim=256, input_resolution=(28, 28), depth=2
          (blocks): ModuleList(
            (0-1): 2 x SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(28, 28), dim=256
            (reduction): Linear(in_features=1024, out_features=512, bias=False)
            (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
        (2): BasicLayer(
          dim=512, input_resolution=(14, 14), depth=18
          (blocks): ModuleList(
            (0-17): 18 x SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(14, 14), dim=512
            (reduction): Linear(in_features=2048, out_features=1024, bias=False)
            (norm): LayerNorm((2048,), eps=1e-05, elementwise_affine=True)
          )
        )
        (3): BasicLayer(
          dim=1024, input_resolution=(7, 7), depth=2
          (blocks): ModuleList(
            (0-1): 2 x SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
        )
      )
      (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (avgpool): AdaptiveAvgPool1d(output_size=1)
    )
    (avgpool): AdaptiveAvgPool1d(output_size=1)
  )
  (encoder_decoder): EncoderDecoder(
    (model): Transformer(
      (vis_encoder): Encoder(
        (layers): ModuleList(
          (0-2): 3 x EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0-1): 2 x SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (text_encoder): TextEncoder(
        (embed): Sequential(
          (0): Embeddings(
            (lut): Embedding(761, 512)
          )
          (1): PositionalEncoding(
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (decoder): Decoder(
        (layers): ModuleList(
          (0-2): 3 x DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0-2): 3 x SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (logit): Linear(in_features=512, out_features=761, bias=True)
    (att_embed): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): ReLU()
      (2): Dropout(p=0.5, inplace=False)
    )
  )
)
Trainable parameters: 100672945
[2023-09-30 23:21:12 iu_test] (main.py 119): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'dsr': 1, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'att_cls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none', 'vocab_size': 761}
[2023-09-30 23:21:12 iu_test] (main.py 120): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-30 23:21:12 iu_test] (main.py 127): INFO number of params: 100672945
[2023-10-01 00:34:16 iu_test] (trainer.py 133): INFO 	epoch          : 1
[2023-10-01 00:34:16 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.28817641735076904
[2023-10-01 00:34:16 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.18629620969295502
[2023-10-01 00:34:16 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.13135512173175812
[2023-10-01 00:34:16 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.09821736067533493
[2023-10-01 00:34:16 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.14791733026504517
[2023-10-01 00:34:16 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.36284682154655457
[2023-10-01 00:34:16 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3508435785770416
[2023-10-01 00:34:16 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.460589647293091
[2023-10-01 00:34:16 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.3389687240123749
[2023-10-01 00:34:16 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.22188298404216766
[2023-10-01 00:34:16 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.15819361805915833
[2023-10-01 00:34:16 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.11862488090991974
[2023-10-01 00:34:16 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.16469721496105194
[2023-10-01 00:34:16 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.38427937030792236
[2023-10-01 00:34:16 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.36501970887184143
[2023-10-01 00:34:16 iu_test] (trainer.py 161): INFO current best model in: 1
[2023-10-01 00:34:24 iu_test] (trainer.py 167): INFO EPOCH 1 training takes 1:13:11
[2023-10-01 00:35:45 iu_test] (trainer.py 133): INFO 	epoch          : 2
[2023-10-01 00:35:45 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.19886258244514465
[2023-10-01 00:35:45 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.11803539097309113
[2023-10-01 00:35:45 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.08355448395013809
[2023-10-01 00:35:45 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.06400886178016663
[2023-10-01 00:35:45 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.10347224026918411
[2023-10-01 00:35:45 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.29474008083343506
[2023-10-01 00:35:45 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.33345460891723633
[2023-10-01 00:35:45 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.9203652143478394
[2023-10-01 00:35:45 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.24148917198181152
[2023-10-01 00:35:45 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.14657507836818695
[2023-10-01 00:35:45 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.10545486211776733
[2023-10-01 00:35:45 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.08101704716682434
[2023-10-01 00:35:45 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.11945840716362
[2023-10-01 00:35:45 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3121804893016815
[2023-10-01 00:35:45 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.34414803981781006
[2023-10-01 00:35:45 iu_test] (trainer.py 161): INFO current best model in: 1
[2023-10-01 00:35:46 iu_test] (trainer.py 167): INFO EPOCH 2 training takes 0:01:22
[2023-10-01 00:37:08 iu_test] (trainer.py 133): INFO 	epoch          : 3
[2023-10-01 00:37:08 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.14539235830307007
[2023-10-01 00:37:08 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.0828370451927185
[2023-10-01 00:37:08 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.051244985312223434
[2023-10-01 00:37:08 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.03423761576414108
[2023-10-01 00:37:08 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.1136651337146759
[2023-10-01 00:37:08 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.30563056468963623
[2023-10-01 00:37:08 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.10010620951652527
[2023-10-01 00:37:08 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.777426838874817
[2023-10-01 00:37:08 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.18304871022701263
[2023-10-01 00:37:08 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.10754049569368362
[2023-10-01 00:37:08 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.06912615150213242
[2023-10-01 00:37:08 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.047678135335445404
[2023-10-01 00:37:08 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.12860415875911713
[2023-10-01 00:37:08 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.3273855447769165
[2023-10-01 00:37:08 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.163596972823143
[2023-10-01 00:37:08 iu_test] (trainer.py 161): INFO current best model in: 1
[2023-10-01 00:37:10 iu_test] (trainer.py 167): INFO EPOCH 3 training takes 0:01:23
[2023-10-01 00:39:04 iu_test] (main.py 99): INFO RRGModel(
  (visual_extractor): VisualExtractor(
    (model): SwinTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (layers): Sequential(
        (0): BasicLayer(
          dim=128, input_resolution=(56, 56), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): Identity()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(56, 56), dim=128
            (reduction): Linear(in_features=512, out_features=256, bias=False)
            (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          )
        )
        (1): BasicLayer(
          dim=256, input_resolution=(28, 28), depth=2
          (blocks): ModuleList(
            (0-1): 2 x SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(28, 28), dim=256
            (reduction): Linear(in_features=1024, out_features=512, bias=False)
            (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
        (2): BasicLayer(
          dim=512, input_resolution=(14, 14), depth=18
          (blocks): ModuleList(
            (0-17): 18 x SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(14, 14), dim=512
            (reduction): Linear(in_features=2048, out_features=1024, bias=False)
            (norm): LayerNorm((2048,), eps=1e-05, elementwise_affine=True)
          )
        )
        (3): BasicLayer(
          dim=1024, input_resolution=(7, 7), depth=2
          (blocks): ModuleList(
            (0-1): 2 x SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
        )
      )
      (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (avgpool): AdaptiveAvgPool1d(output_size=1)
    )
    (avgpool): AdaptiveAvgPool1d(output_size=1)
  )
  (encoder_decoder): EncoderDecoder(
    (model): Transformer(
      (vis_encoder): Encoder(
        (layers): ModuleList(
          (0-2): 3 x EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0-1): 2 x SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (text_encoder): TextEncoder(
        (embed): Sequential(
          (0): Embeddings(
            (lut): Embedding(761, 512)
          )
          (1): PositionalEncoding(
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (decoder): Decoder(
        (layers): ModuleList(
          (0-2): 3 x DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0-2): 3 x SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (logit): Linear(in_features=512, out_features=761, bias=True)
    (att_embed): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): ReLU()
      (2): Dropout(p=0.5, inplace=False)
    )
  )
)
Trainable parameters: 100672945
[2023-10-01 00:39:06 iu_test] (main.py 119): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'rotate_degree': 10, 'dsr': 1, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'att_cls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none', 'vocab_size': 761}
[2023-10-01 00:39:06 iu_test] (main.py 120): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-10-01 00:39:06 iu_test] (main.py 127): INFO number of params: 100672945
[2023-10-01 00:41:15 iu_test] (main.py 99): INFO RRGModel(
  (visual_extractor): VisualExtractor(
    (model): SwinTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (layers): Sequential(
        (0): BasicLayer(
          dim=128, input_resolution=(56, 56), depth=2
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): Identity()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(56, 56), dim=128
            (reduction): Linear(in_features=512, out_features=256, bias=False)
            (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          )
        )
        (1): BasicLayer(
          dim=256, input_resolution=(28, 28), depth=2
          (blocks): ModuleList(
            (0-1): 2 x SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(28, 28), dim=256
            (reduction): Linear(in_features=1024, out_features=512, bias=False)
            (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
        (2): BasicLayer(
          dim=512, input_resolution=(14, 14), depth=18
          (blocks): ModuleList(
            (0-17): 18 x SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            input_resolution=(14, 14), dim=512
            (reduction): Linear(in_features=2048, out_features=1024, bias=False)
            (norm): LayerNorm((2048,), eps=1e-05, elementwise_affine=True)
          )
        )
        (3): BasicLayer(
          dim=1024, input_resolution=(7, 7), depth=2
          (blocks): ModuleList(
            (0-1): 2 x SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath()
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
        )
      )
      (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (avgpool): AdaptiveAvgPool1d(output_size=1)
    )
    (avgpool): AdaptiveAvgPool1d(output_size=1)
  )
  (encoder_decoder): EncoderDecoder(
    (model): Transformer(
      (vis_encoder): Encoder(
        (layers): ModuleList(
          (0-2): 3 x EncoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0-1): 2 x SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (text_encoder): TextEncoder(
        (embed): Sequential(
          (0): Embeddings(
            (lut): Embedding(761, 512)
          )
          (1): PositionalEncoding(
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (decoder): Decoder(
        (layers): ModuleList(
          (0-2): 3 x DecoderLayer(
            (self_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (src_attn): MultiHeadedAttention(
              (linears): ModuleList(
                (0-3): 4 x Linear(in_features=512, out_features=512, bias=True)
              )
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): PositionwiseFeedForward(
              (w_1): Linear(in_features=512, out_features=512, bias=True)
              (w_2): Linear(in_features=512, out_features=512, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0-2): 3 x SublayerConnection(
                (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (logit): Linear(in_features=512, out_features=761, bias=True)
    (att_embed): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): ReLU()
      (2): Dropout(p=0.5, inplace=False)
    )
  )
)
Trainable parameters: 100672945
[2023-10-01 00:41:16 iu_test] (main.py 119): INFO {'exp_name': 'iu_test', 'seed': 9223, 'data_dir': 'datasets', 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 8, 'dataset_name': 'iu_xray', 'label_path': 'labels/labels.json', 'pretrained': '', 'model_path': '', 'output': '', 'eval': False, 'img_backbone': 'swin_base_patch4_window7_224_in22k', 'logs_folder': 'tensorboard_logs', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'swin_s', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 1024, 'num_heads': 8, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'pad_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'diversity_lambda': 0.5, 'length_penalty': '', 'suppress_UNK': 0, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.0005, 'lr_ed': 0.001, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'early_stop': 50, 'msw_w': 0.5, 'image_size': 224, 'rotate_degree': 10, 'dsr': 1, 'resolution_before': 224, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'load_path': '', 'monitor_metric': 'BLEU_4', 'cls': False, 'addcls': False, 'att_cls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'wmse': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none', 'vocab_size': 761}
[2023-10-01 00:41:16 iu_test] (main.py 120): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-10-01 00:41:16 iu_test] (main.py 127): INFO number of params: 100672945
[2023-10-01 00:42:48 iu_test] (trainer.py 133): INFO 	epoch          : 1
[2023-10-01 00:42:48 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.27055948972702026
[2023-10-01 00:42:48 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.17684416472911835
[2023-10-01 00:42:48 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.12617388367652893
[2023-10-01 00:42:48 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.09581319987773895
[2023-10-01 00:42:48 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.14583174884319305
[2023-10-01 00:42:48 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.36122989654541016
[2023-10-01 00:42:48 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.3235437870025635
[2023-10-01 00:42:48 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 2.4566400051116943
[2023-10-01 00:42:48 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.3207974433898926
[2023-10-01 00:42:48 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2088863104581833
[2023-10-01 00:42:48 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.14948146045207977
[2023-10-01 00:42:48 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.11372855305671692
[2023-10-01 00:42:48 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.16194479167461395
[2023-10-01 00:42:48 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.37899649143218994
[2023-10-01 00:42:48 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.3510761559009552
[2023-10-01 00:42:48 iu_test] (trainer.py 161): INFO current best model in: 1
[2023-10-01 00:42:52 iu_test] (trainer.py 167): INFO EPOCH 1 training takes 0:01:35
[2023-10-01 00:44:22 iu_test] (trainer.py 133): INFO 	epoch          : 2
[2023-10-01 00:44:22 iu_test] (trainer.py 133): INFO 	val_BLEU_1     : 0.4417775571346283
[2023-10-01 00:44:22 iu_test] (trainer.py 133): INFO 	val_BLEU_2     : 0.27372148633003235
[2023-10-01 00:44:22 iu_test] (trainer.py 133): INFO 	val_BLEU_3     : 0.18027165532112122
[2023-10-01 00:44:22 iu_test] (trainer.py 133): INFO 	val_BLEU_4     : 0.12613917887210846
[2023-10-01 00:44:22 iu_test] (trainer.py 133): INFO 	val_METEOR     : 0.18569667637348175
[2023-10-01 00:44:22 iu_test] (trainer.py 133): INFO 	val_ROUGE_L    : 0.3494917154312134
[2023-10-01 00:44:22 iu_test] (trainer.py 133): INFO 	val_Cider      : 0.31475821137428284
[2023-10-01 00:44:22 iu_test] (trainer.py 133): INFO 	val_ce_loss    : 1.93181574344635
[2023-10-01 00:44:22 iu_test] (trainer.py 133): INFO 	test_BLEU_1    : 0.4801122844219208
[2023-10-01 00:44:22 iu_test] (trainer.py 133): INFO 	test_BLEU_2    : 0.2992381155490875
[2023-10-01 00:44:22 iu_test] (trainer.py 133): INFO 	test_BLEU_3    : 0.20027416944503784
[2023-10-01 00:44:22 iu_test] (trainer.py 133): INFO 	test_BLEU_4    : 0.14270350337028503
[2023-10-01 00:44:22 iu_test] (trainer.py 133): INFO 	test_METEOR    : 0.20278766751289368
[2023-10-01 00:44:22 iu_test] (trainer.py 133): INFO 	test_ROUGE_L   : 0.36646702885627747
[2023-10-01 00:44:22 iu_test] (trainer.py 133): INFO 	test_Cider     : 0.41874808073043823
[2023-10-01 00:44:22 iu_test] (trainer.py 161): INFO current best model in: 2
[2023-10-01 00:44:26 iu_test] (trainer.py 167): INFO EPOCH 2 training takes 0:01:33
