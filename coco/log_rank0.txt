[2023-09-26 01:20:45 fiber] (main.py 64): INFO {'exp_name': 'fiber', 'seed': 9223, 'datasets': ['coco', 'vg', 'sbu', 'gcc'], 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 32, 'dataset_name': 'iu_xray', 'label_path': '', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'logs_folder': 'tensorboard_logs', 'data_dir': 'data', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'resnet101', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'mse_w': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 01:20:45 fiber] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 01:22:06 fiber] (main.py 64): INFO {'exp_name': 'fiber', 'seed': 9223, 'datasets': ['coco', 'vg', 'sbu', 'gcc'], 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 32, 'dataset_name': 'iu_xray', 'label_path': '', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'logs_folder': 'tensorboard_logs', 'data_dir': 'data', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'resnet101', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'mse_w': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 01:22:06 fiber] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 01:23:27 fiber] (main.py 64): INFO {'exp_name': 'fiber', 'seed': 9223, 'datasets': ['coco', 'vg', 'sbu', 'gcc'], 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 32, 'dataset_name': 'iu_xray', 'label_path': '', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'logs_folder': 'tensorboard_logs', 'data_dir': 'data', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'resnet101', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'mse_w': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 01:23:27 fiber] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 01:25:01 fiber] (main.py 64): INFO {'exp_name': 'fiber', 'seed': 9223, 'datasets': ['coco', 'vg', 'sbu', 'gcc'], 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 32, 'dataset_name': 'iu_xray', 'label_path': '', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'logs_folder': 'tensorboard_logs', 'data_dir': 'data', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'resnet101', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'mse_w': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 01:25:01 fiber] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 01:25:39 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'datasets': ['coco', 'vg', 'sbu', 'gcc'], 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 32, 'dataset_name': 'iu_xray', 'label_path': '', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'logs_folder': 'tensorboard_logs', 'data_dir': 'data', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'resnet101', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'mse_w': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 01:25:39 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 01:26:40 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'datasets': ['coco', 'vg', 'sbu', 'gcc'], 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 32, 'dataset_name': 'iu_xray', 'label_path': '', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'logs_folder': 'tensorboard_logs', 'data_dir': 'data', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'resnet101', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'mse_w': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 01:26:40 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 01:27:09 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'datasets': ['coco', 'vg', 'sbu', 'gcc'], 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 32, 'dataset_name': 'iu_xray', 'label_path': '', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'logs_folder': 'tensorboard_logs', 'data_dir': 'data', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'resnet101', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'mse_w': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 01:27:09 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
[2023-09-26 01:27:31 iu_test] (main.py 64): INFO {'exp_name': 'iu_test', 'seed': 9223, 'datasets': ['coco', 'vg', 'sbu', 'gcc'], 'loss_names': {'itm': 1, 'itc': 1, 'mlm': 1, 'vqa': 0, 'nlvr2': 0, 'caption_mle': 0, 'caption_gold': 0, 'caption_cider': 0}, 'batch_size': 32, 'dataset_name': 'iu_xray', 'label_path': '', 'pretrained': 'pretrained_models/swin_tiny_patch4_window7_224.pth', 'model_path': '', 'output': '', 'eval': False, 'logs_folder': 'tensorboard_logs', 'data_dir': 'data', 'max_seq_length': 60, 'threshold': 3, 'num_workers': 8, 've_name': 'resnet101', 'ed_name': 'st_trans', 'visual_extractor_pretrained': True, 'd_model': 512, 'd_ff': 512, 'd_vf': 2048, 'num_heads': 9, 'num_layers_en': 3, 'num_layers_de': 3, 'dropout': 0.1, 'logit_layers': 1, 'bos_idx': 0, 'eos_idx': 0, 'use_bn': 0, 'drop_prob_lm': 0.5, 'sample_method': 'beam_search', 'beam_size': 3, 'temperature': 1.0, 'sample_n': 1, 'group_size': 1, 'warmup_ratio': 100, 'warmup_epochs': 5, 'output_logsoftmax': 1, 'decoding_constraint': 0, 'block_trigrams': 1, 'optim': 'AdamW', 'lr_ve': 0.001, 'lr_ed': 0.002, 'weight_decay': 5e-05, 'decay_epochs': 10, 'amsgrad': False, 'lr_scheduler': 'step', 'step_size': 50, 'decay_rate': 0.8, 'clip_value': 0.1, 'clip_option': 'value', 'eps': 1e-08, 'n_gpu': 1, 'epochs': 40, 'use_amp': True, 'save_dir': 'results/iu_xray', 'record_dir': 'records/', 'save_period': 1, 'monitor_mode': 'max', 'early_stop': 10, 'fp16': True, 'balanced': False, 'vis': False, 'test': False, 'debug': False, 'num_patches': 98, 'block3': False, 'encode_text': False, 'num_layers_ten': 0, 'cvt_attn': False, 'stride_kv': 1, 'stride_q': 1, 'padding_q': 1, 'padding_kv': 1, 'kernel_size': 3, 'conv_embed': False, 'bwinit': False, 'cfg': 'configs/swin_tiny_patch4_window7_224.yaml', 'local_rank': 0, 'cls': False, 'addcls': False, 'randaug': False, 'resume': False, 'fbl': False, 'sub_back': False, 'attn_cam': False, 'drop_fbl': False, 'attn_method': False, 'early_exit': False, 'cls_w': 0.5, 'mse_w': 0.5, 'layer_id': 2, 'topk': 0.1, 'fore_t': 0.6, 'back_t': 0.3, 'pe': 'none'}
[2023-09-26 01:27:31 iu_test] (main.py 65): INFO RANK and WORLD_SIZE in environ: 0/1
